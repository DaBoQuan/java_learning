var mxClient = {
	VERSION : "0.14.0.1",
	IS_IE : navigator.appName.toUpperCase() == "MICROSOFT INTERNET EXPLORER",
	IS_IE7 : navigator.appName.toUpperCase() == "MICROSOFT INTERNET EXPLORER"
			&& navigator.userAgent.indexOf("MSIE 7") >= 0,
	IS_IE10 : navigator.appName.toUpperCase() == "MICROSOFT INTERNET EXPLORER"
			&& navigator.userAgent.indexOf("MSIE 10") >= 0,
	IS_NS : navigator.appName == "Netscape",
	IS_FF2 : navigator.userAgent.indexOf("Firefox/2") >= 0
			|| navigator.userAgent.indexOf("Iceweasel/2") >= 0,
	IS_FF3 : navigator.userAgent.indexOf("Firefox/3") >= 0
			|| navigator.userAgent.indexOf("Iceweasel/3") >= 0,
	IS_OP : navigator.appName == "Opera",
	IS_SF : navigator.userAgent.indexOf("AppleWebKit") >= 0
			&& navigator.userAgent.indexOf("Chrome") < 0,
	IS_GC : navigator.userAgent.indexOf("Chrome") >= 0,
	IS_SVG : navigator.userAgent.indexOf("Firefox/1.5") >= 0
			|| navigator.userAgent.indexOf("Firefox/2") >= 0
			|| navigator.userAgent.indexOf("Firefox/3") >= 0
			|| navigator.userAgent.indexOf("Iceweasel/1.5") >= 0
			|| navigator.userAgent.indexOf("Iceweasel/2") >= 0
			|| navigator.userAgent.indexOf("Iceweasel/3") >= 0
			|| navigator.userAgent.indexOf("Camino/1") >= 0
			|| navigator.userAgent.indexOf("Epiphany/2") >= 0
			|| navigator.userAgent.indexOf("Iceape/1") >= 0
			|| navigator.userAgent.indexOf("Galeon/2") >= 0
			|| navigator.userAgent.indexOf("Opera/9") >= 0
			|| navigator.userAgent.indexOf("Gecko/") >= 0
			|| navigator.userAgent.indexOf("AppleWebKit/5") >= 0
			|| navigator.userAgent.indexOf("MSIE 10") >= 0,	//在 Internet Explorer 10 (Quirks 和 IE10 文档模式)中，矢量标记语言 (VML) 已过时。所以推荐使用SVG。
	IS_VML : navigator.appName.toUpperCase() == "MICROSOFT INTERNET EXPLORER",
	IS_CANVAS : navigator.appName == "Netscape",
	IS_MAC : navigator.userAgent.toUpperCase().indexOf("MACINTOSH") > 0,
	IS_LOCAL : document.location.href.indexOf("http://") < 0
			&& document.location.href.indexOf("https://") < 0,
	FADE_RUBBERBAND : false,
	WINDOW_SHADOWS : true,
	TOOLTIP_SHADOWS : true,
	MENU_SHADOWS : true,
	isBrowserSupported : function() {
		return mxClient.IS_VML || mxClient.IS_SVG
	},
	link : function(a, b, f) {
		f = f || document;
		if (mxClient.IS_IE && !mxClient.IS_IE7) {
			f.write('<link rel="' + a + '" href="' + b
					+ '" charset="ISO-8859-1" type="text/css"/>')
		} else {
			var e = f.createElement("link");
			e.setAttribute("rel", a);
			e.setAttribute("href", b);
			e.setAttribute("charset", "ISO-8859-1");
			e.setAttribute("type", "text/css");
			var d = f.getElementsByTagName("head")[0];
			d.appendChild(e)
		}
	},
	addOnloadCallback : function(a) {
		if (mxClient.loading == null || mxClient.loading == 0) {
			a()
		} else {
			if (mxClient.onloadCallbacks == null) {
				mxClient.onloadCallbacks = new Array()
			}
			mxClient.onloadCallbacks.push(a)
		}
	},
	onload : function() {
		if (mxClient.onloadCallbacks != null) {
			var a = mxClient.onloadCallbacks;
			mxClient.onloadCallbacks = null;
			for ( var b = 0; b < a.length; b++) {
				a[b]()
			}
		}
		if (mxClient.IS_IE) {
			window.attachEvent("onunload", function() {
				mxClient.unload()
			})
		}
	},
	include : function(f) {
		if (mxClient.IS_SF || mxClient.IS_GC) {
			var d = new XMLHttpRequest();
			d.open("GET", f, false);
			d.send();
			window._mxDynamicCode = d.responseText;
			var a = document.createElement("script");
			a.type = "text/javascript";
			a.innerHTML = "eval(window._mxDynamicCode)";
			var b = document.getElementsByTagName("head")[0];
			b.appendChild(a);
			delete window._mxDynamicCode
		} else {
			var a = document.createElement("script");
			a.setAttribute("type", "text/javascript");
			a.setAttribute("src", f);
			var e = function(g) {
				if (g != null) {
					g.onload = null;
					g.onerror = null;
					g.onreadystatechange = null
				}
				mxClient.loading--;
				if (mxClient.loading == 0) {
					mxClient.onload()
				}
			};
			a.onload = e;
			a.onerror = e;
			a.onreadystatechange = function(g) {
				if (a.readyState == "loaded") {
					e(a)
				} else {
					if (a.readyState == "complete") {
						e(a)
					}
				}
			};
			var b = document.getElementsByTagName("head")[0];
			b.appendChild(a);
			if (mxClient.loading == null) {
				mxClient.loading = 1
			} else {
				mxClient.loading++
			}
		}
	},
	unload : function() {
		mxUtils.release(document.documentElement);
		mxUtils.release(window)
	}
};
mxClient.basePath = (typeof (mxBasePath) != "undefined") ? mxBasePath : "";
mxClient.imageBasePath = (typeof (mxImageBasePath) != "undefined") ? mxImageBasePath
		: mxClient.basePath + "images/";
if (typeof (mxLanguage) != "undefined") {
	mxClient.language = mxLanguage
} else {
	mxClient.language = (mxClient.IS_IE) ? navigator.userLanguage
			: navigator.language;
	var dash = mxClient.language.indexOf("-");
	if (dash > 0) {
		mxClient.language = mxClient.language.substring(0, dash)
	}
}
mxClient.link("stylesheet", mxClient.basePath + "css/common.css");
if (mxClient.IS_IE && !mxClient.IS_IE10) {	//IE10暂时不支持document.namespaces, 并且当浏览器是IE10将不使用VML
	document.namespaces.add("v", "urn:schemas-microsoft-com:vml");
	document.namespaces.add("o", "urn:schemas-microsoft-com:office:office");
	mxClient.link("stylesheet", mxClient.basePath + "css/explorer.css")
}
var mxLog = {
	consoleResource : (mxClient.language != "none") ? "console" : "",
	TRACE : false,
	DEBUG : true,
	WARN : true,
	buffer : "",
	init : function() {
		if (mxLog.window == null && document.body != null) {
			var j = (mxResources.get(mxLog.consoleResource) || mxLog.consoleResource)
					+ " - mxGraph " + mxClient.VERSION;
			var l = document.createElement("table");
			l.setAttribute("width", "100%");
			l.setAttribute("height", "100%");
			var e = document.createElement("tbody");
			var g = document.createElement("tr");
			var b = document.createElement("td");
			b.style.verticalAlign = "top";
			mxLog.textarea = document.createElement("textarea");
			mxLog.textarea.setAttribute("readOnly", "true");
			mxLog.textarea.style.width = "100%";
			mxLog.textarea.style.height = "100%";
			mxLog.textarea.value = mxLog.buffer;
			b.appendChild(mxLog.textarea);
			g.appendChild(b);
			e.appendChild(g);
			g = document.createElement("tr");
			mxLog.td = document.createElement("td");
			mxLog.td.style.verticalAlign = "top";
			mxLog.td.setAttribute("height", "30px");
			g.appendChild(mxLog.td);
			e.appendChild(g);
			l.appendChild(e);
			mxLog.addButton("Info", function(h) {
				mxLog.writeln(mxUtils.toString(navigator))
			});
			mxLog.addButton("DOM", function(h) {
				var m = mxUtils.getInnerHtml(document.body);
				mxLog.debug(m)
			});
			mxLog.addButton("Trace", function(h) {
				mxLog.TRACE = !mxLog.TRACE;
				if (mxLog.TRACE) {
					mxLog.debug("Tracing enabled")
				} else {
					mxLog.debug("Tracing disabled")
				}
			});
			mxLog.addButton("Copy", function(h) {
				try {
					mxUtils.copy(mxLog.textarea.value)
				} catch (m) {
					mxUtils.alert(m)
				}
			});
			mxLog.addButton("Show", function(h) {
				try {
					mxUtils.popup(mxLog.textarea.value)
				} catch (m) {
					mxUtils.alert(m)
				}
			});
			mxLog.addButton("Clear", function(h) {
				mxLog.textarea.value = ""
			});
			var k = document.body.clientWidth;
			var f = (document.body.clientHeight || document.documentElement.clientHeight);
			mxLog.window = new mxWindow(j, l, k - 320, f - 210, 300, 160);
			mxLog.window.setMaximizable(true);
			mxLog.window.setScrollable(true);
			mxLog.window.setSizable(true);
			mxLog.window.setClosable(true);
			mxLog.window.destroyOnClose = false;
			if (mxClient.IS_NS && document.compatMode != "BackCompat") {
				var a = function(n, h) {
					var m = mxLog.window.getElement();
					mxLog.textarea.style.height = (m.offsetHeight - 78) + "px"
				};
				mxLog.window.addListener("resize", a);
				mxLog.window.addListener("maximize", a);
				mxLog.window.addListener("normalize", a);
				var d = mxLog.window.getElement();
				mxLog.textarea.style.height = "96px"
			}
		}
	},
	addButton : function(d, a) {
		var b = document.createElement("button");
		mxUtils.write(b, d);
		mxEvent.addListener(b, "click", a);
		mxLog.td.appendChild(b)
	},
	isVisible : function() {
		if (mxLog.window != null) {
			return mxLog.window.isVisible()
		}
		return false
	},
	show : function() {
		mxLog.setVisible(true)
	},
	setVisible : function(a) {
		if (mxLog.window == null) {
			mxLog.init()
		}
		if (mxLog.window != null) {
			mxLog.window.setVisible(a)
		}
	},
	enter : function(a) {
		if (mxLog.TRACE) {
			mxLog.writeln("Entering " + a);
			return new Date().getTime()
		}
	},
	leave : function(a, d) {
		if (mxLog.TRACE) {
			var b = (d != 0) ? " (" + (new Date().getTime() - d) + " ms)" : "";
			mxLog.writeln("Leaving " + a + b)
		}
	},
	debug : function(a) {
		if (mxLog.DEBUG) {
			mxLog.writeln(a)
		}
	},
	warn : function(a) {
		if (mxLog.WARN) {
			mxLog.writeln(a)
		}
	},
	write : function(a) {
		if (mxLog.textarea != null) {
			mxLog.textarea.value = mxLog.textarea.value + a;
			mxLog.textarea.scrollTop = mxLog.textarea.scrollHeight
		} else {
			mxLog.buffer += a
		}
	},
	writeln : function(a) {
		mxLog.write(a + "\n")
	}
};
var mxObjectIdentity = {
	FIELD_NAME : "mxObjectId",
	counter : 0,
	get : function(b) {
		if (typeof (b) == "object" && b[mxObjectIdentity.FIELD_NAME] == null) {
			var a = mxUtils.getFunctionName(b.constructor);
			b[mxObjectIdentity.FIELD_NAME] = a + "#"
					+ mxObjectIdentity.counter++
		}
		return b[mxObjectIdentity.FIELD_NAME]
	},
	clear : function(a) {
		if (typeof (a) == "object") {
			delete a[mxObjectIdentity.FIELD_NAME]
		}
	}
};
function mxDictionary() {
	this.clear()
}
mxDictionary.prototype.values = null;
mxDictionary.prototype.clear = function() {
	this.values = new Array()
};
mxDictionary.prototype.get = function(a) {
	var b = mxObjectIdentity.get(a);
	return this.values[b]
};
mxDictionary.prototype.put = function(a, d) {
	var e = mxObjectIdentity.get(a);
	var b = this.values[e];
	this.values[e] = d;
	return b
};
mxDictionary.prototype.remove = function(a) {
	var d = mxObjectIdentity.get(a);
	var b = this.values[d];
	delete this.values[d];
	return b
};
var mxResources = {
	resources : new Array(),
	add : function(f, a) {
		a = (a != null) ? a : mxClient.language;
		if (a != "none") {
			try {
				var b = mxUtils.load(f + ".properties");
				if (b.isReady()) {
					mxResources.parse(b.getText())
				}
			} catch (d) {
			}
			try {
				var b = mxUtils.load(f + "_" + a + ".properties");
				if (b.isReady()) {
					mxResources.parse(b.getText())
				}
			} catch (d) {
			}
		}
	},
	parse : function(h) {
		var b = h.split("\n");
		for ( var f = 0; f < b.length; f++) {
			var d = b[f].indexOf("=");
			if (d > 0) {
				var e = b[f].substring(0, d);
				var a = b[f].length;
				if (b[f].charCodeAt(a - 1) == 13) {
					a--
				}
				var g = b[f].substring(d + 1, a);
				mxResources.resources[e] = unescape(g)
			}
		}
	},
	get : function(f, h, b) {
		var g = mxResources.resources[f];
		if (g == null) {
			g = b
		}
		if (g != null && h != null) {
			var a = new Array();
			var d = null;
			for ( var e = 0; e < g.length; e++) {
				var j = g.charAt(e);
				if (j == "{") {
					d = ""
				} else {
					if (d != null && j == "}") {
						d = parseInt(d) - 1;
						if (d >= 0 && d < h.length) {
							a.push(h[d])
						}
						d = null
					} else {
						if (d != null) {
							d += j
						} else {
							a.push(j)
						}
					}
				}
			}
			g = a.join("")
		}
		return g
	}
};
function mxPoint(a, b) {
	this.x = (a != null) ? a : 0;
	this.y = (b != null) ? b : 0
}
mxPoint.prototype.x = null;
mxPoint.prototype.y = null;
mxPoint.prototype.clone = function() {
	return mxUtils.clone(this)
};
function mxRectangle(b, e, d, a) {
	mxPoint.call(this, b, e);
	this.width = (d != null) ? d : 0;
	this.height = (a != null) ? a : 0
}
mxRectangle.prototype = new mxPoint();
mxRectangle.prototype.constructor = mxRectangle;
mxRectangle.prototype.width = null;
mxRectangle.prototype.height = null;
mxRectangle.prototype.add = function(b) {
	if (b != null) {
		var a = Math.min(this.x, b.x);
		var f = Math.min(this.y, b.y);
		var e = Math.max(this.x + this.width, b.x + b.width);
		var d = Math.max(this.y + this.height, b.y + b.height);
		this.x = a;
		this.y = f;
		this.width = e - a;
		this.height = d - f
	}
};
mxRectangle.prototype.grow = function(a) {
	this.x -= a;
	this.y -= a;
	this.width += 2 * a;
	this.height += 2 * a
};
mxRectangle.prototype.getPoint = function() {
	return new mxPoint(this.x, this.y)
};
var mxUtils = {
	errorResource : (mxClient.language != "none") ? "error" : "",
	closeResource : (mxClient.language != "none") ? "close" : "",
	errorImage : mxClient.imageBasePath + "error.gif",
	release : function(e) {
		if (e != null) {
			mxEvent.removeAllListeners(e);
			var d = e.childNodes;
			if (d != null) {
				var a = d.length;
				for ( var b = 0; b < a; b += 1) {
					mxUtils.release(d[b])
				}
			}
		}
	},
	removeCursors : function(e) {
		if (e.style != null) {
			e.style.cursor = null
		}
		var d = e.childNodes;
		if (d != null) {
			var a = d.length;
			for ( var b = 0; b < a; b += 1) {
				mxUtils.removeCursors(d[b])
			}
		}
	},
	getCurrentStyle : function() {
		if (mxClient.IS_IE) {
			return function(a) {
				return (a != null) ? a.currentStyle : null
			}
		} else {
			return function(a) {
				return (a != null) ? window.getComputedStyle(a, "") : null
			}
		}
	}(),
	hasScrollbars : function(b) {
		var a = mxUtils.getCurrentStyle(b);
		return a != null && (a.overflow == "scroll" || a.overflow == "auto")
	},
	eval : function(expr) {
		var result = null;
		if (expr.indexOf("function") >= 0
				&& (mxClient.IS_IE || mxClient.IS_SF || mxClient.IS_FF3 || mxClient.IS_OP)) {
			try {
				eval("var _mxJavaScriptExpression=" + expr);
				result = _mxJavaScriptExpression;
				delete _mxJavaScriptExpression
			} catch (e) {
				mxLog.warn(e.message + " while evaluating " + expr)
			}
		} else {
			result = eval(expr)
		}
		return result
	},
	selectSingleNode : function() {
		if (mxClient.IS_IE) {
			return function(b, a) {
				return b.selectSingleNode(a)
			}
		} else {
			return function(d, b) {
				var a = d.evaluate(b, d, null, XPathResult.ANY_TYPE, null);
				return a.iterateNext()
			}
		}
	}(),
	getFunctionName : function(e) {
		var g = null;
		if (e != null) {
			if (!mxClient.IS_SF && mxClient.IS_NS) {
				g = e.name
			} else {
				var d = e.toString();
				var b = 9;
				while (d.charAt(b) == " ") {
					b++
				}
				var a = d.indexOf("(", b);
				g = d.substring(b, a)
			}
		}
		return g
	},
	indexOf : function(d, b) {
		if (d != null && b != null) {
			for ( var a = 0; a < d.length; a++) {
				if (d[a] == b) {
					return a
				}
			}
		}
		return -1
	},
	remove : function(e, f) {
		var a = null;
		if (typeof (f) == "object") {
			var b = mxUtils.indexOf(f, e);
			while (b >= 0) {
				f.splice(b, 1);
				a = e;
				b = mxUtils.indexOf(f, e)
			}
		}
		for ( var d in f) {
			if (f[d] == e) {
				delete f[d];
				a = e
			}
		}
		return a
	},
	isNode : function(d, e, a, b) {
		if (d != null && !isNaN(d.nodeType)
				&& (e == null || d.nodeName.toLowerCase() == e.toLowerCase())) {
			return a == null || d.getAttribute(a) == b
		}
		return false
	},
	getChildNodes : function(e, a) {
		a = a || mxConstants.NODETYPE_ELEMENT;
		var d = new Array();
		var b = e.firstChild;
		while (b != null) {
			if (b.nodeType == a) {
				d.push(b)
			}
			b = b.nextSibling
		}
		return d
	},
	createXmlDocument : function() {
		var a = null;
		if (document.implementation && document.implementation.createDocument && !mxClient.IS_IE10) {
			a = document.implementation.createDocument("", "", null)
		} else {
			if (window.ActiveXObject) {
				a = new ActiveXObject("Microsoft.XMLDOM")
			}
		}
		return a
	},
	parseXml : function(a) {
		if (mxClient.IS_IE) {
			return function(d) {
				var b = mxUtils.createXmlDocument();
				b.async = "false";
				b.loadXML(d);
				return b
			}
		} else {
			return function(b) {
				var d = new DOMParser();
				return d.parseFromString(b, "text/xml")
			}
		}
	}(),
	createXmlElement : function(a) {
		return mxUtils.parseXml("<" + a + "/>").documentElement
	},
	getPrettyXml : function(h, g, b) {
		var a = new Array();
		if (h != null) {
			g = g || "  ";
			b = b || "";
			if (h.nodeType == mxConstants.NODETYPE_TEXT) {
				a.push(h.nodeValue)
			} else {
				a.push(b + "<" + h.nodeName);
				var d = h.attributes;
				if (d != null) {
					for ( var f = 0; f < d.length; f++) {
						var j = mxUtils.htmlEntities(d[f].nodeValue);
						a.push(" " + d[f].nodeName + '="' + j + '"')
					}
				}
				var e = h.firstChild;
				if (e != null) {
					a.push(">\n");
					while (e != null) {
						a.push(mxUtils.getPrettyXml(e, g, b + g));
						e = e.nextSibling
					}
					a.push(b + "</" + h.nodeName + ">\n")
				} else {
					a.push("/>\n")
				}
			}
		}
		return a.join("")
	},
	removeWhitespace : function(d, e) {
		var a = (e) ? d.previousSibling : d.nextSibling;
		while (a != null && a.nodeType == mxConstants.NODETYPE_TEXT) {
			var b = (e) ? a.previousSibling : a.nextSibling;
			var f = mxUtils.getTextContent(a).replace(/\t/g, "").replace(
					/\r\n/g, "").replace(/\n/g, "").replace(/^\s+/g, "")
					.replace(/\s+$/g, "");
			if (f.length == 0) {
				a.parentNode.removeChild(a)
			}
			a = b
		}
	},
	htmlEntities : function(b, a) {
		b = b || "";
		b = b.replace(/&/g, "&amp;");
		b = b.replace(/"/g, "&quot;");
		b = b.replace(/\'/g, "&#39;");
		b = b.replace(/</g, "&lt;");
		b = b.replace(/>/g, "&gt;");
		if (a == null || a) {
			b = b.replace(/\n/g, "&#xa;")
		}
		return b
	},
	isVml : function(a) {
		return a != null && a.tagUrn == "urn:schemas-microsoft-com:vml"
	},
	getXml : function(e, b) {
		var d = "";
		if (e != null) {
			d = e.xml;
			if (d == null) {
				if (mxClient.IS_IE) {
					d = e.innerHTML
				} else {
					var a = new XMLSerializer();
					d = a.serializeToString(e)
				}
			} else {
				d = d.replace(/\r\n\t[\t]*/g, "").replace(/>\r\n/g, ">")
						.replace(/\r\n/g, "\n")
			}
		}
		b = b || "&#xa;";
		d = d.replace(/\n/g, b);
		return d
	},
	getTextContent : function(b) {
		var a = "";
		if (b != null) {
			if (b.firstChild != null) {
				b = b.firstChild
			}
			a = b.nodeValue || ""
		}
		return a
	},
	getInnerHtml : function() {
		if (mxClient.IS_IE) {
			return function(a) {
				if (a != null) {
					return a.innerHTML
				}
				return ""
			}
		} else {
			return function(b) {
				if (b != null) {
					var a = new XMLSerializer();
					return a.serializeToString(b)
				}
				return ""
			}
		}
	}(),
	getOuterHtml : function() {
		if (mxClient.IS_IE) {
			return function(e) {
				if (e != null) {
					var d = new Array();
					d.push("<" + e.nodeName);
					var a = e.attributes;
					for ( var b = 0; b < a.length; b++) {
						var f = a[b].nodeValue;
						if (f != null && f.length > 0) {
							d.push(" ");
							d.push(a[b].nodeName);
							d.push('="');
							d.push(f);
							d.push('"')
						}
					}
					if (e.innerHTML.length == 0) {
						d.push("/>")
					} else {
						d.push(">");
						d.push(e.innerHTML);
						d.push("</" + e.nodeName + ">")
					}
					return d.join("")
				}
				return ""
			}
		} else {
			return function(b) {
				if (b != null) {
					var a = new XMLSerializer();
					return a.serializeToString(b)
				}
				return ""
			}
		}
	}(),
	write : function(a, d) {
		var b = document.createTextNode(d);
		if (a != null) {
			a.appendChild(b)
		}
		return b
	},
	writeln : function(a, d) {
		var b = document.createTextNode(d);
		if (a != null) {
			a.appendChild(b);
			a.appendChild(document.createElement("br"))
		}
		return b
	},
	br : function(d, e) {
		e = e || 1;
		var b;
		for ( var a = 0; a < e; a++) {
			b = document.createElement("br");
			if (d != null) {
				d.appendChild(b)
			}
		}
		return b
	},
	button : function(b, a) {
		var d = document.createElement("button");
		mxUtils.write(d, b);
		mxEvent.addListener(d, "click", function(e) {
			a(e)
		});
		return d
	},
	para : function(a, d) {
		var b = document.createElement("p");
		mxUtils.write(b, d);
		if (a != null) {
			a.appendChild(b)
		}
		return b
	},
	linkAction : function(e, h, d, f, g) {
		var b = mxUtils.link(e, h, function() {
			d.execute(f)
		}, g);
		return b
	},
	linkInvoke : function(g, j, f, e, b, h) {
		var d = mxUtils.link(g, j, function() {
			f[e](b)
		}, h);
		return d
	},
	link : function(e, g, d, f) {
		var b = document.createElement("span");
		b.style.color = "blue";
		b.style.textDecoration = "underline";
		b.style.cursor = "pointer";
		if (f != null) {
			b.style.paddingLeft = f + "px"
		}
		mxEvent.addListener(b, "click", d);
		mxUtils.write(b, g);
		if (e != null) {
			e.appendChild(b)
		}
		return b
	},
	fit : function(g) {
		var f = g.offsetLeft;
		var e = g.offsetWidth;
		var k = document.body;
		var h = document.documentElement;
		var l = (k.scrollLeft || h.scrollLeft)
				+ (k.clientWidth || h.clientWidth);
		if (f + e > l) {
			g.style.left = Math.max((k.scrollLeft || h.scrollLeft), l - e)
					+ "px"
		}
		var j = parseInt(g.offsetTop);
		var m = parseInt(g.offsetHeight);
		var a = (k.scrollTop || h.scrollTop)
				+ Math.max(k.clientHeight || 0, h.clientHeight);
		if (j + m > a) {
			g.style.top = Math.max((k.scrollTop || h.scrollTop), a - m) + "px"
		}
	},
	open : function(b) {
		if (mxClient.IS_NS) {
			try {
				netscape.security.PrivilegeManager
						.enablePrivilege("UniversalXPConnect")
			} catch (j) {
				mxUtils.alert("Permission to read file denied.");
				return ""
			}
			var f = Components.classes["@mozilla.org/file/local;1"]
					.createInstance(Components.interfaces.nsILocalFile);
			f.initWithPath(b);
			if (!f.exists()) {
				mxUtils.alert("File not found.");
				return ""
			}
			var h = Components.classes["@mozilla.org/network/file-input-stream;1"]
					.createInstance(Components.interfaces.nsIFileInputStream);
			h.init(f, 1, 4, null);
			var g = Components.classes["@mozilla.org/scriptableinputstream;1"]
					.createInstance(Components.interfaces.nsIScriptableInputStream);
			g.init(h);
			var d = g.read(g.available());
			return d
		} else {
			var k = new ActiveXObject("Scripting.FileSystemObject");
			var a = k.OpenTextFile(b, 1);
			var l = a.readAll();
			a.close();
			return l
		}
		return null
	},
	save : function(b, f) {
		if (mxClient.IS_NS) {
			try {
				netscape.security.PrivilegeManager
						.enablePrivilege("UniversalXPConnect")
			} catch (h) {
				mxUtils.alert("Permission to write file denied.");
				return
			}
			var d = Components.classes["@mozilla.org/file/local;1"]
					.createInstance(Components.interfaces.nsILocalFile);
			d.initWithPath(b);
			if (!d.exists()) {
				d.create(0, 420)
			}
			var a = Components.classes["@mozilla.org/network/file-output-stream;1"]
					.createInstance(Components.interfaces.nsIFileOutputStream);
			a.init(d, 32 | 2, 4, null);
			a.write(f, f.length);
			a.flush();
			a.close()
		} else {
			var g = new ActiveXObject("Scripting.FileSystemObject");
			var d = g.CreateTextFile(b, true);
			d.Write(f);
			d.Close()
		}
	},
	saveAs : function(b) {
		var a = document.createElement("iframe");
		a.setAttribute("src", "");
		a.style.visibility = "hidden";
		a.style.display = "none";
		document.body.appendChild(a);
		try {
			if (mxClient.IS_NS) {
				var f = a.contentDocument;
				f.open();
				f.write(b);
				f.close();
				try {
					netscape.security.PrivilegeManager
							.enablePrivilege("UniversalXPConnect");
					a.focus();
					saveDocument(f)
				} catch (d) {
					mxUtils.alert("Permission to save document denied.")
				}
			} else {
				var f = a.contentWindow.document;
				f.write(b);
				f.execCommand("SaveAs", false, document.location)
			}
		} finally {
			document.body.removeChild(a)
		}
	},
	copy : function(e) {
		if (window.clipboardData) {
			window.clipboardData.setData("Text", e)
		} else {
			netscape.security.PrivilegeManager
					.enablePrivilege("UniversalXPConnect");
			var d = Components.classes["@mozilla.org/widget/clipboard;1"]
					.createInstance(Components.interfaces.nsIClipboard);
			if (!d) {
				return
			}
			var b = Components.classes["@mozilla.org/widget/transferable;1"]
					.createInstance(Components.interfaces.nsITransferable);
			if (!b) {
				return
			}
			b.addDataFlavor("text/unicode");
			var g = new Object();
			var a = new Object();
			var g = Components.classes["@mozilla.org/supports-string;1"]
					.createInstance(Components.interfaces.nsISupportsString);
			var h = e;
			g.data = h;
			b.setTransferData("text/unicode", g, h.length * 2);
			var f = Components.interfaces.nsIClipboard;
			d.setData(b, null, f.kGlobalClipboard)
		}
	},
	load : function(a) {
		var b = new mxXmlRequest(a, null, "GET", false);
		b.send();
		return b
	},
	get : function(b, d, a) {
		return new mxXmlRequest(b, null, "GET").send(d, a)
	},
	post : function(b, e, d, a) {
		return new mxXmlRequest(b, e).send(d, a)
	},
	submit : function(a, d, b) {
		return new mxXmlRequest(a, d).simulate(b)
	},
	loadInto : function(a, d, b) {
		if (mxClient.IS_IE) {
			d.onreadystatechange = function() {
				if (d.readyState == 4) {
					b()
				}
			}
		} else {
			d.addEventListener("load", b, false)
		}
		d.load(a)
	},
	getValue : function(e, b, a) {
		var d = e[b];
		if (d == null) {
			d = a
		}
		return d
	},
	clone : function(e, b, d) {
		d = (d != null) ? d : false;
		var f = null;
		if (e != null && typeof (e.constructor) == "function") {
			f = new e.constructor();
			for ( var a in e) {
				if (a != mxObjectIdentity.FIELD_NAME
						&& (b == null || mxUtils.indexOf(b, a) < 0)) {
					if (!d && typeof (e[a]) == "object") {
						f[a] = mxUtils.clone(e[a])
					} else {
						f[a] = e[a]
					}
				}
			}
		}
		return f
	},
	equals : function(e, d) {
		return d != null
				&& ((e.x == null || e.x == d.x) && (e.y == null || e.y == d.y)
						&& (e.width == null || e.width == d.width) && (e.height == null || e.height == d.height))
	},
	toString : function(g) {
		var a = "";
		for ( var b in g) {
			try {
				if (g[b] == null) {
					a += b + " = [null]\n"
				} else {
					if (typeof (g[b]) == "function") {
						a += b + " => [Function]\n"
					} else {
						if (typeof (g[b]) == "object") {
							var d = mxUtils.getFunctionName(g[b].constructor);
							a += b + " => [" + d + "]\n"
						} else {
							a += b + " = " + g[b] + "\n"
						}
					}
				}
			} catch (f) {
				a += b + "=" + f.message
			}
		}
		return a
	},
	toRadians : function(a) {
		return Math.PI * a / 180
	},
	getBoundingBox : function(e, l) {
		var m = null;
		if (e != null && l != null && l != 0) {
			var d = mxUtils.toRadians(l);
			var k = Math.cos(d);
			var b = Math.sin(d);
			var a = new mxPoint(e.x + e.width / 2, e.y + e.height / 2);
			var j = new mxPoint(e.x, e.y);
			var h = new mxPoint(e.x + e.width, e.y);
			var g = new mxPoint(h.x, e.y + e.height);
			var f = new mxPoint(e.x, g.y);
			j = mxUtils.getRotatedPoint(j, k, b, a);
			h = mxUtils.getRotatedPoint(h, k, b, a);
			g = mxUtils.getRotatedPoint(g, k, b, a);
			f = mxUtils.getRotatedPoint(f, k, b, a);
			m = new mxRectangle(j.x, j.y, 0, 0);
			m.add(new mxRectangle(h.x, h.y, 0, 0));
			m.add(new mxRectangle(g.x, g.y, 0, 0));
			m.add(new mxRectangle(f.x, f.Y, 0, 0))
		}
		return m
	},
	getRotatedPoint : function(h, g, d, b) {
		b = (b != null) ? b : new mxPoint();
		var a = h.x - c.x;
		var j = h.y - c.y;
		var e = a * g - j * d;
		var f = j * g + a * d;
		return new mxPoint(e + c.x, f + c.y)
	},
	contains : function(b, a, d) {
		return (b.x <= a && b.x + b.width >= a && b.y <= d && b.y + b.height >= d)
	},
	intersects : function(e, d) {
		return mxUtils.contains(e, d.x, d.y)
				|| mxUtils.contains(e, d.x + d.width, d.y + d.height)
				|| mxUtils.contains(e, d.x + d.width, d.y)
				|| mxUtils.contains(e, d.x, d.y + d.height)
	},
	getOffset : function(a) {
		var d = 0;
		var b = 0;
		while (a.offsetParent) {
			d += a.offsetLeft;
			b += a.offsetTop;
			a = a.offsetParent
		}
		return new mxPoint(d, b)
	},
	getScrollOrigin : function(h) {
		var f = document.body;
		var j = document.documentElement;
		var e = (f.scrollLeft || j.scrollLeft);
		var g = (f.scrollTop || j.scrollTop);
		var a = new mxPoint(e, g);
		while (h != null && h != f && h != j) {
			a.x += h.scrollLeft;
			a.y += h.scrollTop;
			h = h.parentNode
		}
		return a
	},
	convertPoint : function(b, a, f) {
		var d = mxUtils.getScrollOrigin(b);
		var e = mxUtils.getOffset(b);
		e.x -= d.x;
		e.y -= d.y;
		return new mxPoint(a - e.x, f - e.y)
	},
	isNumeric : function(a) {
		return a != null
				&& (a.length == null || (a.length > 0 && a.indexOf("0x") < 0)
						&& a.indexOf("0X") < 0) && !isNaN(a)
	},
	intersection : function(g, q, f, o, e, m, b, l) {
		var k = ((l - m) * (f - g)) - ((b - e) * (o - q));
		var p = ((b - e) * (q - m)) - ((l - m) * (g - e));
		var n = ((f - g) * (q - m)) - ((o - q) * (g - e));
		var d = p / k;
		var a = n / k;
		if (d >= 0 && d <= 1 && a >= 0 && a <= 1) {
			var j = g + d * (f - g);
			var h = q + d * (o - q);
			return new mxPoint(j, h)
		}
		return null
	},
	ptSegDistSq : function(d, h, b, f, k, j) {
		b -= d;
		f -= h;
		k -= d;
		j -= h;
		var g = k * b + j * f;
		var a;
		if (g <= 0) {
			a = 0
		} else {
			k = b - k;
			j = f - j;
			g = k * b + j * f;
			if (g <= 0) {
				a = 0
			} else {
				a = g * g / (b * b + f * f)
			}
		}
		var e = k * k + j * j - a;
		if (e < 0) {
			e = 0
		}
		return e
	},
	relativeCcw : function(e, h, b, g, f, d) {
		b -= e;
		g -= h;
		f -= e;
		d -= h;
		var a = f * g - d * b;
		if (a == 0) {
			a = f * b + d * g;
			if (a > 0) {
				f -= b;
				d -= g;
				a = f * b + d * g;
				if (a < 0) {
					a = 0
				}
			}
		}
		return (a < 0) ? -1 : ((a > 0) ? 1 : 0)
	},
	animateChanges : function(h, f) {
		var d = h;
		var a = 10;
		var g = 0;
		var b = function() {
			var l = false;
			for ( var m = 0; m < f.length; m++) {
				var o = f[m];
				if (o.constructor == mxGeometryChange
						|| o.constructor == mxTerminalChange
						|| o.constructor == mxValueChange
						|| o.constructor == mxChildChange
						|| o.constructor == mxStyleChange) {
					var j = d.getView().getState(o.cell || o.child, false);
					if (j != null) {
						l = true;
						if (o.constructor != mxGeometryChange
								|| d.model.isEdge(o.cell)) {
							mxUtils.setOpacity(j.shape.node, 100 * g / a)
						} else {
							var k = h.getView().scale;
							var r = (o.geometry.x - o.previous.x) * k;
							var q = (o.geometry.y - o.previous.y) * k;
							var p = (o.geometry.width - o.previous.width) * k;
							var n = (o.geometry.height - o.previous.height) * k;
							if (g == 0) {
								j.x -= r;
								j.y -= q;
								j.width -= p;
								j.height -= n
							} else {
								j.x += r / a;
								j.y += q / a;
								j.width += p / a;
								j.height += n / a
							}
							d.cellRenderer.redraw(j);
							mxUtils.cascadeOpacity(h, o.cell, 100 * g / a)
						}
					}
				}
			}
			if (g < a && l) {
				g++;
				window.setTimeout(b, e)
			}
		};
		var e = 30;
		b()
	},
	cascadeOpacity : function(j, h, g) {
		var b = j.model.getChildCount(h);
		for ( var e = 0; e < b; e++) {
			var a = j.model.getChildAt(h, e);
			var k = j.getView().getState(a);
			if (k != null) {
				mxUtils.setOpacity(k.shape.node, g);
				mxUtils.cascadeOpacity(j, a, g)
			}
		}
		var d = j.model.getEdges(h);
		if (d != null) {
			for ( var e = 0; e < d.length; e++) {
				var f = j.getView().getState(d[e]);
				if (f != null) {
					mxUtils.setOpacity(f.shape.node, g)
				}
			}
		}
	},
	morph : function(j, e, b, a, g, d) {
		g = g || 30;
		d = d || 30;
		var k = 0;
		var h = function() {
			var f = j.getModel();
			k = Math.min(100, k + g);
			for ( var l = 0; l < e.length; l++) {
				if (!f.isEdge(!e[l])) {
					var m = j.getCellBounds(e[l]);
					m.x += g * b / 100;
					m.y += g * a / 100;
					j.cellRenderer.redraw(m)
				}
			}
			if (k < 100) {
				window.setTimeout(h, d)
			} else {
				j.move(e, b, a)
			}
		};
		window.setTimeout(h, d)
	},
	fadeIn : function(g, j, e, b, d) {
		j = (j != null) ? j : 100;
		e = e || 40;
		b = b || 30;
		var a = 0;
		mxUtils.setOpacity(g, a);
		g.style.visibility = "visible";
		if (d || d == null) {
			var h = function() {
				a = Math.min(a + e, j);
				mxUtils.setOpacity(g, a);
				if (a < j) {
					window.setTimeout(h, b)
				}
			};
			window.setTimeout(h, b)
		} else {
			mxUtils.setOpacity(g, j)
		}
	},
	fadeOut : function(h, k, a, g, d, e) {
		g = g || 40;
		d = d || 30;
		var b = k || 100;
		mxUtils.setOpacity(h, b);
		if (e || e == null) {
			var j = function() {
				b = Math.max(b - g, 0);
				mxUtils.setOpacity(h, b);
				if (b > 0) {
					window.setTimeout(j, d)
				} else {
					h.style.visibility = "hidden";
					if (a && h.parentNode) {
						h.parentNode.removeChild(h)
					}
				}
			};
			window.setTimeout(j, d)
		} else {
			h.style.visibility = "hidden";
			if (a && h.parentNode) {
				h.parentNode.removeChild(h)
			}
		}
	},
	setOpacity : function(a, b) {
		if (mxUtils.isVml(a)) {
			if (b >= 100) {
				a.style.filter = null
			} else {
				a.style.filter = "alpha(opacity=" + (b / 5) + ")"
			}
		} else {
			if (mxClient.IS_IE) {
				if (b >= 100) {
					a.style.filter = null
				} else {
					a.style.filter = "alpha(opacity=" + b + ")"
				}
			} else {
				a.style.opacity = (b / 100)
			}
		}
	},
	createImage : function(d) {
		var a = d.toUpperCase();
		var b = null;
		if (a.substring(a.length - 3, a.length).toUpperCase() == "PNG"
				&& mxClient.IS_IE && !mxClient.IS_IE7) {
			b = document.createElement("DIV");
			b.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"
					+ d + "', sizingMethod='scale')"
		} else {
			b = document.createElement("image");
			b.setAttribute("src", d)
		}
		return b
	},
	getStylename : function(a) {
		if (a != null) {
			var d = a.split(";");
			var b = d[0];
			if (b.indexOf("=") < 0) {
				return b
			}
		}
		return ""
	},
	getStylenames : function(d) {
		var a = new Array();
		if (d != null) {
			var e = d.split(";");
			for ( var b = 0; b < e.length; b++) {
				if (e[b].indexOf("=") < 0) {
					a.push(e[b])
				}
			}
		}
		return a
	},
	indexOfStylename : function(b, d) {
		if (b != null && d != null) {
			var e = b.split(";");
			var f = 0;
			for ( var a = 0; a < e.length; a++) {
				if (e[a] == d) {
					return f
				}
				f += e[a].length + 1
			}
		}
		return -1
	},
	addStylename : function(a, b) {
		if (mxUtils.indexOfStylename(a, b) < 0) {
			if (a == null) {
				a = ""
			} else {
				if (a.length > 0 && a.charAt(a.length - 1) != ";") {
					a += ";"
				}
			}
			a += b
		}
		return a
	},
	removeStylename : function(d, e) {
		var a = new Array();
		if (d != null) {
			var f = d.split(";");
			for ( var b = 0; b < f.length; b++) {
				if (f[b] != e) {
					a.push(f[b])
				}
			}
		}
		return a.join(";")
	},
	removeAllStylenames : function(d) {
		var a = new Array();
		if (d != null) {
			var e = d.split(";");
			for ( var b = 0; b < e.length; b++) {
				if (e[b].indexOf("=") >= 0) {
					a.push(e[b])
				}
			}
		}
		return a.join(";")
	},
	setCellStyles : function(b, a, e, g) {
		if (a != null && a.length > 0) {
			b.beginUpdate();
			try {
				for ( var d = 0; d < a.length; d++) {
					if (a[d] != null) {
						var f = mxUtils.setStyle(b.getStyle(a[d]), e, g);
						b.setStyle(a[d], f)
					}
				}
			} finally {
				b.endUpdate()
			}
		}
	},
	setStyle : function(g, f, h) {
		var j = h != null && (typeof (h.length) == "undefined" || h.length > 0);
		if (g == null || g.length == 0) {
			if (j) {
				g = f + "=" + h
			}
		} else {
			var d = g.indexOf(f + "=");
			if (d < 0) {
				if (j) {
					var b = (g.charAt(g.length - 1) == ";") ? "" : ";";
					g = g + b + f + "=" + h
				}
			} else {
				var e = (j) ? f + "=" + h : "";
				var a = g.indexOf(";", d);
				g = g.substring(0, d) + e + ((a >= 0) ? g.substring(a) : "")
			}
		}
		return g
	},
	setCellStyleFlags : function(d, b, f, a, h) {
		if (b != null && b.length > 0) {
			d.beginUpdate();
			try {
				for ( var e = 0; e < b.length; e++) {
					if (b[e] != null) {
						var g = mxUtils.setStyleFlag(d.getStyle(b[e]), f, a, h);
						d.setStyle(b[e], g)
					}
				}
			} finally {
				d.endUpdate()
			}
		}
	},
	setStyleFlag : function(h, g, b, j) {
		if (h == null || h.length == 0) {
			if (j || j == null) {
				h = g + "=" + b
			} else {
				h = g + "=0"
			}
		} else {
			var e = h.indexOf(g + "=");
			if (e < 0) {
				var d = (h.charAt(h.length - 1) == ";") ? "" : ";";
				if (j || j == null) {
					h = h + d + g + "=" + b
				} else {
					h = h + d + g + "=0"
				}
			} else {
				var a = h.indexOf(";", e);
				var f = "";
				if (a < 0) {
					f = h.substring(e + g.length + 1)
				} else {
					f = h.substring(e + g.length + 1, a)
				}
				if (j == null) {
					f = parseInt(f) ^ b
				} else {
					if (j) {
						f = parseInt(f) | b
					} else {
						f = parseInt(f) & ~b
					}
				}
				h = h.substring(0, e) + g + "=" + f
						+ ((a >= 0) ? h.substring(a) : "")
			}
		}
		return h
	},
	show : function(l, k) {
		if (k == null) {
			var e = window.open();
			k = e.document
		} else {
			k.open()
		}
		k.write('<html xmlns:v="urn:schemas-microsoft-com:vml">');
		k.write("<head>");
		var b = document.getElementsByTagName("base");
		for ( var g = 0; g < b.length; g++) {
			k.write(mxUtils.getOuterHtml(b[g]))
		}
		var m = document.getElementsByTagName("link");
		for ( var g = 0; g < m.length; g++) {
			k.write(mxUtils.getOuterHtml(m[g]))
		}
		var o = document.getElementsByTagName("style");
		for ( var g = 0; g < o.length; g++) {
			k.write(mxUtils.getOuterHtml(o[g]))
		}
		k.write("</head>");
		var a = l.getBounds();
		var p = Math.min(a.x, 0);
		var n = Math.min(a.y, 0);
		if (mxClient.IS_IE) {
			k.write("<body>");
			var f = mxUtils.getInnerHtml(l.container);
			k.write(f);
			var d = k.body.getElementsByTagName("DIV")[0];
			if (d != null) {
				d.style.position = "absolute";
				d.style.left = -p + "px";
				d.style.top = -n + "px"
			}
			k.write("</body>");
			k.write("</html>");
			k.close()
		} else {
			k.write("</html>");
			k.close();
			k.documentElement.appendChild(k.createElement("body"));
			var a = l.getBounds();
			var d = l.container.firstChild;
			while (d != null) {
				var h = d.cloneNode(true);
				k.body.appendChild(h);
				d = d.nextSibling
			}
		}
		mxUtils.removeCursors(k.documentElement);
		if (!mxClient.IS_IE) {
			var a = l.getBounds();
			var d = k.getElementsByTagName("g")[0];
			if (d != null) {
				d.setAttribute("transform", "translate(" + (-p) + "," + (-n)
						+ ")");
				var j = d.ownerSVGElement;
				j.setAttribute("width", a.width + Math.max(a.x, 0) + 3);
				j.setAttribute("height", a.height + Math.max(a.y, 0) + 3);
				j.style.position = "absolute";
				j.style.left = p + "px";
				j.style.top = n + "0px"
			}
		}
		return k
	},
	print : function(b) {
		var a = window.open();
		mxUtils.show(b, a.document);
		a.print();
		a.close()
	},
	popup : function(e, j) {
		if (j) {
			var g = document.createElement("div");
			g.style.overflow = "scroll";
			g.style.width = "636px";
			g.style.height = "460px";
			var f = document.createElement("pre");
			f.innerHTML = mxUtils.htmlEntities(e, false).replace(/\n/g, "<br>")
					.replace(/ /g, "&nbsp;");
			g.appendChild(f);
			var a = document.body.clientWidth;
			var b = (document.body.clientHeight || document.documentElement.clientHeight);
			var d = new mxWindow("Popup Window", g, a / 2 - 320, b / 2 - 240,
					640, 480, false, true);
			d.setClosable(true);
			d.setVisible(true)
		} else {
			if (mxClient.IS_NS) {
				var d = window.open();
				d.document.write("<pre>" + mxUtils.htmlEntities(e) + "</pre");
				d.document.close()
			} else {
				var d = window.open();
				var f = d.document.createElement("pre");
				f.innerHTML = mxUtils.htmlEntities(e, false).replace(/\n/g,
						"<br>").replace(/ /g, "&nbsp;");
				d.document.body.appendChild(f)
			}
		}
	},
	alert : function(a) {
		alert(a)
	},
	prompt : function(b, a) {
		return prompt(b, a)
	},
	confirm : function(a) {
		return confirm(a)
	},
	error : function(n, b, m, k) {
		var a = document.createElement("div");
		a.style.padding = "20px";
		var e = document.createElement("img");
		e.setAttribute("src", k || mxUtils.errorImage);
		e.setAttribute("valign", "bottom");
		e.style.verticalAlign = "middle";
		a.appendChild(e);
		a.appendChild(document.createTextNode("\u00a0"));
		a.appendChild(document.createTextNode("\u00a0"));
		a.appendChild(document.createTextNode("\u00a0"));
		mxUtils.write(a, n);
		var l = document.body.clientWidth;
		var g = (document.body.clientHeight || document.documentElement.clientHeight);
		var j = new mxWindow(mxResources.get(mxUtils.errorResource)
				|| mxUtils.errorResource, a, (l - b) / 2, g / 4, b, null,
				false, true);
		if (m) {
			mxUtils.br(a);
			var d = document.createElement("p");
			var f = document.createElement("button");
			if (mxClient.IS_IE) {
				f.style.cssText = "float:right"
			} else {
				f.setAttribute("style", "float:right")
			}
			mxEvent.addListener(f, "click", function(h) {
				j.destroy()
			});
			mxUtils.write(f, mxResources.get(mxUtils.closeResource)
					|| mxUtils.closeResource);
			d.appendChild(f);
			a.appendChild(d);
			mxUtils.br(a);
			j.setClosable(true)
		}
		j.setVisible(true);
		return j
	},
	makeDraggable : function(f, g, b, e, d, a) {
		d = (d != null) ? d : 0;
		a = (a != null) ? a : mxConstants.TOOLTIP_VERTICAL_OFFSET;
		mxEvent.addListener(f, "mousedown", function(k) {
			if (!mxEvent.isConsumed(k)) {
				var n = (e != null) ? e.cloneNode(true) : f.cloneNode(true);
				n.style.zIndex = 3;
				n.style.position = "absolute";
				mxUtils.setOpacity(n, 70);
				var o = false;
				var j = k.clientX;
				var h = k.clientY;
				var m = function(p) {
					var q = mxUtils.getScrollOrigin();
	n.style.left = (p.clientX + q.x + d)+"px";n.style.top=(p.clientY+q.y+a)+"px";if(!o){o=true;document.body.appendChild(n)}mxEvent.consume(p)};var l=function(q){mxEvent.removeListener(document,"mousemove",m);mxEvent.removeListener(document,"mouseup",l);if(n.parentNode!=null){n.parentNode.removeChild(n)}try{var s=mxUtils.convertPoint(g.container,q.clientX,q.clientY);var p=2*g.tolerance;if(s.x>=g.container.scrollLeft&&s.y>=g.container.scrollTop&&s.x<=g.container.scrollLeft+g.container.clientWidth&&s.y<=g.container.scrollTop+g.container.clientHeight&&(Math.abs(q.clientX-j)>p||Math.abs(q.clientY-h)>p)){var r=g.getCellAt(s.x,s.y);b(g,q,r)}}finally{mxEvent.consume(q)}};mxEvent.addListener(document,"mousemove",m);mxEvent.addListener(document,"mouseup",l);mxEvent.consume(k)}})}};var mxConstants={DEFAULT_HOTSPOT:0.5,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SVG_SHADOWCOLOR:"gray",SVG_CRISP_EDGES:false,SVG_SHADOWTRANSFORM:"translate(2 3)",NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",HIGHLIGHT_STROKEWIDTH:3,HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",SELECTION_COLOR:"#00FF00",SELECTION_STROKEWIDTH:1,SELECTION_DASHED:true,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:(mxClient.IS_IE)?2:3,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",LOCKED_HANDLE_FILLCOLOR:"#0000FF",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_OPACITY:"opacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_GRADIENTCOLOR:"gradientColor",STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_SHADOW:"shadow",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_DASHED:"dashed",STYLE_ROUNDED:"rounded",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_LOOP:"loopStyle",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_BLOCK:"block",ARROW_OPEN:"open",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal"};function mxEventSource(){}mxEventSource.prototype.eventListeners=null;mxEventSource.prototype.eventsEnabled=true;mxEventSource.prototype.addListener=function(b,a){if(this.eventListeners==null){this.eventListeners=new Array()}this.eventListeners.push(b);this.eventListeners.push(a)};mxEventSource.prototype.removeListener=function(a){if(this.eventListeners!=null){var b=0;while(b<this.eventListeners.length){if(this.eventListeners[b+1]==a){this.eventListeners.splice(b,2)}else{b+=2}}}};mxEventSource.prototype.dispatchEvent=function(d){if(this.eventListeners!=null&&this.eventsEnabled){var b=null;for(var f=0;f<this.eventListeners.length;f+=2){var e=this.eventListeners[f];if(e==null||e==d){if(b==null){b=new Array();var g=arguments.length;for(var a=1;a<g;a++){b.push(arguments[a])}}this.eventListeners[f+1].apply(this,b)}}}};var mxEvent={addListener:function(){var a=function(e,d,b){if(e.mxListenerList==null){e.mxListenerList=new Array()}var f={name:d,f:b};e.mxListenerList.push(f)};if(mxClient.IS_IE){return function(e,d,b){if(e.attachEvent){e.attachEvent("on"+d,b);}else if(e.addEventListener){e.addEventListener(d,b,false);}a(e,d,b)}}else{return function(e,d,b){e.addEventListener(d,b,false);a(e,d,b)}}}(),redirectMouseEvents:function(d,f,a,b,g){var e=function(h){if(g&&mxClient.IS_IE){var k=mxUtils.convertPoint(f.container,h.clientX,h.clientY);var j=f.getCellAt(k.x,k.y);if(a!=j&&(!f.isSwimlane(a)||!f.hitsSwimlaneContent(a,k.x,k.y))){return j}}return a};mxEvent.addListener(d,"mousedown",function(h){f.dispatchGraphEvent("mousedown",h,e(h),b)});mxEvent.addListener(d,"mousemove",function(h){f.dispatchGraphEvent("mousemove",h,e(h),b)});mxEvent.addListener(d,"mouseup",function(h){f.dispatchGraphEvent("mouseup",h,e(h),b)})},removeListener:function(){var a=function(f,d,b){if(f.mxListenerList!=null){var h=f.mxListenerList.length;for(var e=0;e<h;e++){var g=f.mxListenerList[e];if(g.f==b){f.mxListenerList.splice(e,1);break}}if(f.mxListenerList.length==0){f.mxListenerList=null}}};if(mxClient.IS_IE){return function(e,d,b){if(e.detachEvent){e.detachEvent("on"+d,b);}else if(e.removeEventListener){e.removeEventListener(d,b,false);}a(e,d,b)}}else{return function(e,d,b){e.removeEventListener(d,b,false);a(e,d,b)}}}(),removeAllListeners:function(a){var d=a.mxListenerList;if(d!=null){while(d.length>0){var b=d[0];mxEvent.removeListener(a,b.name,b.f)}}},
	disableContextMenu:function(){if(mxClient.IS_IE){return function(a){mxEvent.addListener(a,"contextmenu",function(){return false})}}else{return function(a){a.setAttribute("oncontextmenu","return false;")}}}(),getSource:function(a){return(a.srcElement!=null)?a.srcElement:a.target},isConsumed:function(a){return a.isConsumed!=null&&a.isConsumed},isLeftMouseButton:function(a){return a.button==((mxClient.IS_IE)?1:0)},isPopupTrigger:function(a){return a.button==2},isCloneEvent:function(a){return(a!=null)?a.ctrlKey:false},isGridEnabledEvent:function(a){return(a!=null)?!a.altKey:false},isToggleEvent:function(a){return a.ctrlKey},isForceMarqueeEvent:function(a){return a.altKey||a.metaKey},consume:function(a,b){if(b==null||b){if(a.preventDefault){a.stopPropagation();a.preventDefault()}else{a.cancelBubble=true}}a.isConsumed=true;a.returnValue=false}};var mxDatatransfer={sourceFunction:null,setSourceFunction:function(a){mxDatatransfer.sourceFunction=a},consumeSourceFunction:function(e,d,a){if(mxDatatransfer.sourceFunction!=null&&e.isEnabled()){var b=mxDatatransfer.sourceFunction;mxDatatransfer.sourceFunction=null;b(e,d,a)}}};function mxXmlRequest(b,e,g,d,f,a){this.url=b;this.params=e;this.method=g||"POST";this.async=(d!=null)?d:true;this.username=f;this.password=a}mxXmlRequest.prototype.url=null;mxXmlRequest.prototype.params=null;mxXmlRequest.prototype.method=null;mxXmlRequest.prototype.async=null;mxXmlRequest.prototype.username=null;mxXmlRequest.prototype.password=null;mxXmlRequest.prototype.request=null;mxXmlRequest.prototype.isReady=function(){return this.request.readyState==4};mxXmlRequest.prototype.getDocumentElement=function(){var a=this.getXml();if(a!=null){return a.documentElement}return null};mxXmlRequest.prototype.getXml=function(){var a=this.request.responseXML;if(a==null||a.documentElement==null){a=mxUtils.parseXml(this.request.responseText)}return a};mxXmlRequest.prototype.getText=function(){return this.request.responseText};mxXmlRequest.prototype.getStatus=function(){return this.request.status};mxXmlRequest.prototype.create=function(){if(window.XMLHttpRequest){return function(){return new XMLHttpRequest()}}else{if(typeof(ActiveXObject)!="undefined"){return function(){return new ActiveXObject("Microsoft.XMLHTTP")}}}}();mxXmlRequest.prototype.send=function(d,a){this.request=this.create();if(this.request!=null){var b=this;this.request.onreadystatechange=function(){if(b.isReady()){if(d!=null){d(b)}}};this.request.open(this.method,this.url,this.async,this.username,this.password);this.setRequestHeaders(this.request,this.params);this.request.send(this.params)}};mxXmlRequest.prototype.setRequestHeaders=function(a,b){if(b!=null){a.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}};mxXmlRequest.prototype.simulate=function(m,h){m=m||document;var e=null;if(m==document){e=window.onbeforeunload;window.onbeforeunload=null}var b=m.createElement("form");b.setAttribute("method",this.method);b.setAttribute("action",this.url);if(h!=null){b.setAttribute("target",h)}b.style.display="none";b.style.visibility="hidden";var d=(this.params.indexOf("&")>0)?this.params.split("&"):this.params.split();for(var f=0;f<d.length;f++){var j=d[f].indexOf("=");if(j>0){var a=d[f].substring(0,j);var l=d[f].substring(j+1);var k=m.createElement("textarea");k.setAttribute("name",a);l=l.replace(/\n/g,"&#xa;");var g=m.createTextNode(l);k.appendChild(g);b.appendChild(k)}}m.body.appendChild(b);b.submit();m.body.removeChild(b);if(e!=null){window.onbeforeunload=e}};var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return mxClipboard.cells==null},cut:function(b,a){a=mxClipboard.copy(b,a);mxClipboard.insertCount=0;b.dispatchEvent("beforeCut",b,a);b.remove(a);b.dispatchEvent("afterCut",b,a);return a},copy:function(f,d){d=d||f.getSelectionCells();var b=new Array();f.dispatchEvent("beforeCopy",f,d);for(var e=0;e<d.length;e++){var a=d[e];if(d[e]!=null&&f.canExport(d[e])){b.push(a)}}mxClipboard.insertCount=1;mxClipboard.cells=f.cloneCells(b);f.dispatchEvent("afterCopy",f,mxClipboard.cells,b);return b},paste:function(d){if(mxClipboard.cells!=null){d.dispatchEvent("beforePaste",d,mxClipboard.cells);var a=new Array();for(var b=0;b<mxClipboard.cells.length;b++){if(d.canImport(mxClipboard.cells[b])){a.push(mxClipboard.cells[b])}}a=d.move(a,mxClipboard.insertCount*mxClipboard.STEPSIZE,mxClipboard.insertCount*mxClipboard.STEPSIZE,true);d.dispatchEvent("paste",d,a);mxClipboard.insertCount++;d.setSelectionCells(a);d.dispatchEvent("afterPaste",d,a)}}};function mxWindow(h,f,j,g,b,k,d,l,e,a){if(f!=null){d=(d!=null)?d:true;this.content=f;this.init(j,g,b,k,a);this.installMaximizeHandler();this.installMinimizeHandler();this.installCloseHandler();this.setMinimizable(d);mxUtils.write(this.title,h||"");if(l==null||l){this.installMoveHandler()}if(e!=null&&e.parentNode!=null){e.parentNode.replaceChild(this.div,e)}else{document.body.appendChild(this.div)}}}mxWindow.prototype=new mxEventSource();mxWindow.prototype.constructor=mxWindow;mxWindow.prototype.closeImage=mxClient.imageBasePath+"close.gif";mxWindow.prototype.minimizeImage=mxClient.imageBasePath+"minimize.gif";mxWindow.prototype.normalizeImage=mxClient.imageBasePath+"normalize.gif";mxWindow.prototype.maximizeImage=mxClient.imageBasePath+"maximize.gif";mxWindow.prototype.resizeImage=mxClient.imageBasePath+"resize.gif";mxWindow.prototype.visible=false;mxWindow.prototype.content=false;mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40);mxWindow.prototype.content=false;mxWindow.prototype.destroyOnClose=true;mxWindow.prototype.init=function(h,g,b,j,a){a=(a!=null)?a:"mxWindow";this.div=document.createElement("div");this.div.className=a;this.div.style.left=h+"px";this.div.style.top=g+"px";if(!mxClient.IS_IE&&mxClient.WINDOW_SHADOWS){this.shadow=document.createElement("div");this.shadow.style.background=mxConstants.SVG_SHADOWCOLOR;mxUtils.setOpacity(this.shadow,70);this.shadow.style.position="absolute";this.shadow.style.display="inline"}else{if(mxClient.IS_IE&&!mxClient.WINDOW_SHADOWS){this.div.style.filter=""}}this.table=document.createElement("table");this.table.className=a;if(b!=null){if(!mxClient.IS_IE){this.div.style.width=b+"px"}this.table.style.width=b+"px"}if(j!=null){if(!mxClient.IS_IE){this.div.style.height=j+"px"}this.table.style.height=j+"px"}var d=document.createElement("tbody");var f=document.createElement("tr");this.title=document.createElement("td");this.title.className=a+"Title";f.appendChild(this.title);d.appendChild(f);f=document.createElement("tr");this.td=document.createElement("td");this.td.className=a+"Pane";this.contentWrapper=document.createElement("div");this.contentWrapper.className=a+"Pane";this.contentWrapper.style.width="100%";this.contentWrapper.appendChild(this.content);if(mxClient.IS_IE||this.content.nodeName.toUpperCase()!="DIV"){this.contentWrapper.style.height="100%"}this.td.appendChild(this.contentWrapper);f.appendChild(this.td);d.appendChild(f);this.table.appendChild(d);this.div.appendChild(this.table);var k=this;var e=function(l){k.activate()};mxEvent.addListener(this.title,"mousedown",e);mxEvent.addListener(this.table,"mousedown",e);if(this.shadow!=null){mxEvent.addListener(this.div,"DOMNodeInserted",function(l){var m=mxEvent.getSource(l);var n=function(o){mxEvent.removeListener(m,"load",n);k.updateShadow()};mxEvent.addListener(m,"load",n);k.updateShadow()})}this.hide()};mxWindow.prototype.setScrollable=function(a){if(a){this.contentWrapper.style.overflow="auto"}else{this.contentWrapper.style.overflow="hidden"}};mxWindow.prototype.updateShadow=function(){if(this.shadow!=null){this.shadow.style.display=this.div.style.display;this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";if(this.shadow.parentNode!=this.div.parentNode){this.div.parentNode.appendChild(this.shadow)}}};mxWindow.prototype.activate=function(){if(mxWindow.activeWindow!=this){var e=mxUtils.getCurrentStyle(this.getElement());var b=(e!=null)?e.zIndex:3;if(mxWindow.activeWindow){var a=mxWindow.activeWindow.getElement();if(a!=null&&a.style!=null){a.style.zIndex=b}}var d=mxWindow.activeWindow;this.getElement().style.zIndex=b+1;mxWindow.activeWindow=this;this.dispatchEvent("activate",this,d)}};mxWindow.prototype.getElement=function(){return this.div};mxWindow.prototype.fit=function(){mxUtils.fit(this.div)};mxWindow.prototype.isSizable=function(a){if(this.resize!=null){return this.resize.style.display!="none"}return false};mxWindow.prototype.setSizable=function(b){if(b){if(this.resize==null){this.resize=document.createElement("img");this.resize.style.position="absolute";this.resize.style.bottom="2px";this.resize.style.right="2px";this.resize.setAttribute("src",mxClient.imageBasePath+"resize.gif");this.resize.style.cursor="nw-resize";var a=this;mxEvent.addListener(this.resize,"mousedown",function(g){a.activate();var f=g.clientX;var e=g.clientY;var k=a.div.offsetWidth;var d=a.div.offsetHeight;var j=function(m){var n=m.clientX-f;var l=m.clientY-e;a.setSize(k+n,d+l);a.updateShadow();a.dispatchEvent("resize",a,m);mxEvent.consume(m)};var h=function(l){mxEvent.removeListener(document,"mousemove",j);mxEvent.removeListener(document,"mouseup",h);a.dispatchEvent("resizeend",a,l);mxEvent.consume(l)};mxEvent.addListener(document,"mousemove",j);mxEvent.addListener(document,"mouseup",h);a.dispatchEvent("resizestart",a,g);mxEvent.consume(g)});this.div.appendChild(this.resize)}else{this.resize.style.display="inline"}}else{if(this.resize!=null){this.resize.style.display="none"}}};mxWindow.prototype.setSize=function(b,a){b=Math.max(this.minimumSize.width,b);a=Math.max(this.minimumSize.height,a);if(!mxClient.IS_IE){this.div.style.width=b+"px";this.div.style.height=a+"px"}this.table.style.width=b+"px";this.table.style.height=a+"px";if(!mxClient.IS_IE){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px"}};mxWindow.prototype.setMinimizable=function(a){this.minimize.style.display=(a)?"":"none"};mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement("img");this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("align","right");this.minimize.setAttribute("title","Minimize");this.minimize.style.cursor="pointer";this.minimize.style.marginRight="1px";this.minimize.style.display="none";this.title.appendChild(this.minimize);var e=false;var f=null;var a=null;var d=this;var b=function(g){d.activate();if(!e){e=true;d.minimize.setAttribute("src",d.normalizeImage);d.minimize.setAttribute("title","Normalize");d.contentWrapper.style.display="none";f=d.maximize.style.display;d.maximize.style.display="none";a=d.table.style.height;if(!mxClient.IS_IE){d.div.style.height=d.title.offsetHeight+"px"}d.table.style.height=d.title.offsetHeight+"px";if(d.resize!=null){d.resize.style.visibility="hidden"}d.updateShadow();d.dispatchEvent("minimize",d,g)}else{e=false;d.minimize.setAttribute("src",d.minimizeImage);d.minimize.setAttribute("title","Minimize");d.contentWrapper.style.display="";d.maximize.style.display=f;if(!mxClient.IS_IE){d.div.style.height=a}d.table.style.height=a;if(d.resize!=null){d.resize.style.visibility="visible"}d.updateShadow();d.dispatchEvent("normalize",d,g)}mxEvent.consume(g)};mxEvent.addListener(d.minimize,"mousedown",b)};mxWindow.prototype.setMaximizable=function(a){this.maximize.style.display=(a)?"":"none"};mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement("img");this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("align","right");this.maximize.setAttribute("title","Maximize");this.maximize.style.cursor="default";this.maximize.style.marginLeft="1px";this.maximize.style.cursor="pointer";this.maximize.style.display="none";this.title.appendChild(this.maximize);var e=false;var b=null;var h=null;var a=null;var g=null;var f=this;var d=function(j){f.activate();if(f.maximize.style.display!="none"){if(!e){e=true;f.maximize.setAttribute("src",f.normalizeImage);f.maximize.setAttribute("title","Normalize");f.contentWrapper.style.display="";f.minimize.style.visibility="hidden";b=parseInt(f.div.style.left);h=parseInt(f.div.style.top);a=f.table.style.height;g=f.table.style.width;f.div.style.left="0px";f.div.style.top="0px";if(!mxClient.IS_IE){f.div.style.height=(document.body.clientHeight-2)+"px";f.div.style.width=(document.body.clientWidth-2)+"px"}f.table.style.width=(document.body.clientWidth-2)+"px";f.table.style.height=(document.body.clientHeight-2)+"px";if(f.resize!=null){f.resize.style.visibility="hidden"}if(f.shadow!=null){f.shadow.style.display="none"}if(!mxClient.IS_IE){var k=mxUtils.getCurrentStyle(f.contentWrapper);if(k.overflow=="auto"||f.resize!=null){f.contentWrapper.style.height=(f.div.offsetHeight-f.title.offsetHeight-2)+"px"}}f.dispatchEvent("maximize",f,j)}else{e=false;f.maximize.setAttribute("src",f.maximizeImage);f.maximize.setAttribute("title","Maximize");f.contentWrapper.style.display="";f.minimize.style.visibility="";f.div.style.left=b+"px";f.div.style.top=h+"px";if(!mxClient.IS_IE){f.div.style.height=a;f.div.style.width=g;var k=mxUtils.getCurrentStyle(f.contentWrapper);if(k.overflow=="auto"||f.resize!=null){f.contentWrapper.style.height=(f.div.offsetHeight-f.title.offsetHeight-2)+"px"}}f.table.style.height=a;f.table.style.width=g;if(f.resize!=null){f.resize.style.visibility="visible"}f.updateShadow();f.dispatchEvent("normalize",f,j)}mxEvent.consume(j)}};mxEvent.addListener(this.maximize,"mousedown",d);mxEvent.addListener(this.title,"dblclick",d)};mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor="move";var a=this;mxEvent.addListener(this.title,"mousedown",function(f){var e=f.clientX;var d=f.clientY;var b=a.getX();var j=a.getY();var h=function(l){var m=l.clientX-e;var k=l.clientY-d;a.setLocation(b+m,j+k);a.dispatchEvent("move",a,l);mxEvent.consume(l)};var g=function(k){mxEvent.removeListener(document,"mousemove",h);mxEvent.removeListener(document,"mouseup",g);a.dispatchEvent("moveend",a,k);mxEvent.consume(k)};mxEvent.addListener(document,"mousemove",h);mxEvent.addListener(document,"mouseup",g);a.dispatchEvent("movestart",a,f);mxEvent.consume(f)})};mxWindow.prototype.setLocation=function(a,b){this.div.style.left=a+"px";this.div.style.top=b+"px";this.updateShadow()};mxWindow.prototype.getX=function(){return parseInt(this.div.style.left)};mxWindow.prototype.getY=function(){return parseInt(this.div.style.top)};mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement("img");this.closeImg.setAttribute("src",this.closeImage);this.closeImg.setAttribute("align","right");this.closeImg.setAttribute("title","Close");this.closeImg.style.marginLeft="2px";this.closeImg.style.cursor="pointer";this.closeImg.style.display="none";this.title.insertBefore(this.closeImg,this.title.firstChild);var a=this;mxEvent.addListener(this.closeImg,"mousedown",function(b){a.dispatchEvent("close",a,b);if(a.destroyOnClose){a.destroy()}else{a.setVisible(false)}mxEvent.consume(b)})};mxWindow.prototype.setImage=function(a){this.image=document.createElement("img");this.image.setAttribute("src",a);this.image.setAttribute("align","left");this.image.style.marginRight="4px";this.image.style.marginLeft="0px";this.image.style.marginTop="-2px";this.title.insertBefore(this.image,this.title.firstChild)};mxWindow.prototype.setClosable=function(a){this.closeImg.style.display=(a)?"":"none"};mxWindow.prototype.isVisible=function(){if(this.div!=null){return this.div.style.display!="none"}return false};mxWindow.prototype.setVisible=function(a){if(this.div!=null&&this.isVisible()!=a){if(a){this.show()}else{this.hide()}}this.updateShadow()};mxWindow.prototype.show=function(){this.div.style.display="";this.activate();var a=mxUtils.getCurrentStyle(this.contentWrapper);if(!mxClient.IS_IE&&(a.overflow=="auto"||this.resize!=null)){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px"}this.dispatchEvent("show",this)};mxWindow.prototype.hide=function(){this.div.style.display="none";this.dispatchEvent("hide",this)};mxWindow.prototype.destroy=function(){this.dispatchEvent("destroy",this);if(this.div!=null){mxUtils.release(this.div);this.div.parentNode.removeChild(this.div);this.div=null}if(this.shadow!=null){this.shadow.parentNode.removeChild(this.shadow);this.shadow=null}this.title=null;this.content=null;this.contentWrapper=null};function mxForm(a){this.table=document.createElement("table");this.table.className=a;this.body=document.createElement("tbody");this.table.appendChild(this.body)}mxForm.prototype.table=null;mxForm.prototype.body=false;mxForm.prototype.addButtons=function(e,g){var d=document.createElement("tr");var f=document.createElement("td");d.appendChild(f);f=document.createElement("td");var b=document.createElement("button");mxUtils.write(b,mxResources.get("ok")||"OK");f.appendChild(b);var a=this;mxEvent.addListener(b,"click",function(){e()});b=document.createElement("button");mxUtils.write(b,mxResources.get("cancel")||"Cancel");f.appendChild(b);mxEvent.addListener(b,"click",function(){g()});d.appendChild(f);this.body.appendChild(d)};mxForm.prototype.addText=function(b,d){var a=document.createElement("input");a.setAttribute("type","text");a.value=d;return this.addField(b,a)};mxForm.prototype.addCheckbox=function(b,d){var a=document.createElement("input");a.setAttribute("type","checkbox");this.addField(b,a);if(d){a.checked=true}return a};mxForm.prototype.addTextarea=function(b,e,d){var a=document.createElement("textarea");if(mxClient.IS_NS){d--}a.setAttribute("rows",d||2);a.value=e;return this.addField(b,a)};mxForm.prototype.addCombo=function(b,e,d){var a=document.createElement("select");if(d!=null){a.setAttribute("size",d)}if(e){a.setAttribute("multiple","true")}return this.addField(b,a)};mxForm.prototype.addOption=function(f,b,e,a){var d=document.createElement("option");mxUtils.writeln(d,b);d.setAttribute("value",e);if(a){d.setAttribute("selected",a)}f.appendChild(d)};mxForm.prototype.addField=function(b,a){var d=document.createElement("tr");var e=document.createElement("td");mxUtils.write(e,b);d.appendChild(e);e=document.createElement("td");e.appendChild(a);d.appendChild(e);this.body.appendChild(d);return a};function mxImage(d,b,a){this.src=d;this.width=b;this.height=a}mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;function mxDivResizer(d){if(d.nodeName.toLowerCase()=="div"){this.div=d;var b=mxUtils.getCurrentStyle(d);if(b!=null){this.resizeWidth=b.width=="auto";this.resizeHeight=b.height=="auto"}var a=this;mxEvent.addListener(window,"resize",function(e){a.resize()});this.resize()}}mxDivResizer.prototype.resizeWidth=true;mxDivResizer.prototype.resizeHeight=true;mxDivResizer.prototype.resize=function(){var e=this.getDocumentWidth();var g=this.getDocumentHeight();var d=parseInt(this.div.style.left);var j=parseInt(this.div.style.right);var f=parseInt(this.div.style.top);var a=parseInt(this.div.style.bottom);if(this.resizeWidth&&d>=0&&j>=0){this.div.style.width=(e-j-d)+"px"}if(this.resizeHeight&&f>=0&&a>=0){this.div.style.height=(g-f-a)+"px"}};mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth};mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight};function mxToolbar(a){this.container=a}mxToolbar.prototype=new mxEventSource();mxToolbar.prototype.constructor=mxToolbar;mxToolbar.prototype.container=null;mxToolbar.prototype.enabled=true;mxToolbar.prototype.noReset=false;mxToolbar.prototype.updateDefaultMode=true;mxToolbar.prototype.addItem=function(k,j,a,f,b,d){var g=document.createElement((j!=null)?"img":"button");var e=b||((d!=null)?"mxToolbarMode":"mxToolbarItem");g.className=e;g.setAttribute("src",j);if(k!=null){if(j!=null){g.setAttribute("title",k)}else{mxUtils.write(g,k)}}this.container.appendChild(g);if(a!=null){mxEvent.addListener(g,"click",a)}var l=this;mxEvent.addListener(g,"mousedown",function(n){if(f!=null){g.setAttribute("src",f)}else{g.style.backgroundColor="gray"}if(d!=null){if(l.menu==null){l.menu=new mxPopupMenu();l.menu.init()}var o=l.currentImg;if(l.menu.isMenuShowing()){l.menu.hideMenu()}if(o!=g){l.currentImg=g;l.menu.factoryMethod=d;var m=new mxPoint(g.offsetLeft,g.offsetTop+g.offsetHeight);l.menu.popup(m.x,m.y,null,n);if(l.menu.isMenuShowing()){g.className=e+"Selected";l.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);g.className=e;l.currentImg=null}}}}});var h=function(m){if(f!=null){g.setAttribute("src",j)}else{g.style.backgroundColor=""}};mxEvent.addListener(g,"mouseup",h);mxEvent.addListener(g,"mouseout",h);return g};mxToolbar.prototype.addCombo=function(b){var d=document.createElement("div");d.style.display="inline";d.className="mxToolbarComboContainer";var a=document.createElement("select");a.className=b||"mxToolbarCombo";d.appendChild(a);this.container.appendChild(d);return a};mxToolbar.prototype.addActionCombo=function(d,b){var a=document.createElement("select");a.className=b||"mxToolbarCombo";this.addOption(a,d,null);mxEvent.addListener(a,"change",function(e){var f=a.options[a.selectedIndex];a.selectedIndex=0;if(f.funct!=null){f.funct(e)}});this.container.appendChild(a);return a};mxToolbar.prototype.addOption=function(d,e,b){var a=document.createElement("option");mxUtils.writeln(a,e);if(typeof(b)=="function"){a.funct=b}else{a.setAttribute("value",b)}d.appendChild(a);return a};mxToolbar.prototype.addSwitchMode=function(j,h,a,g,f){var d=document.createElement("img");d.initialClassName=f||"mxToolbarMode";d.className=d.initialClassName;d.setAttribute("src",h);d.altIcon=g;if(j!=null){d.setAttribute("title",j)}var b=this;mxEvent.addListener(d,"click",function(k){var l=b.selectedMode.altIcon;if(l!=null){b.selectedMode.altIcon=b.selectedMode.getAttribute("src");b.selectedMode.setAttribute("src",l)}else{b.selectedMode.className=b.selectedMode.initialClassName}if(b.updateDefaultMode){b.defaultMode=d}b.selectedMode=d;var l=d.altIcon;if(l!=null){d.altIcon=d.getAttribute("src");d.setAttribute("src",l)}else{d.className=d.initialClassName+"Selected"}b.dispatchEvent("select",this,null);a()});this.container.appendChild(d);if(this.defaultMode==null){this.defaultMode=d;this.selectedMode=d;var e=d.altIcon;if(e!=null){d.altIcon=d.getAttribute("src");d.setAttribute("src",e)}else{d.className=d.initialClassName+"Selected"}a()}return d};mxToolbar.prototype.addMode=function(j,h,a,g,f){var d=document.createElement("img");d.initialClassName=f||"mxToolbarMode";d.className=d.initialClassName;d.setAttribute("src",h);d.altIcon=g;if(j!=null){d.setAttribute("title",j)}if(this.enabled){var b=this;mxEvent.addListener(d,"click",function(k){b.selectMode(d,a);b.noReset=false});mxEvent.addListener(d,"dblclick",function(k){b.selectMode(d,a);b.noReset=true});if(this.defaultMode==null){this.defaultMode=d;this.selectedMode=d;var e=d.altIcon;if(e!=null){d.altIcon=d.getAttribute("src");d.setAttribute("src",e)}else{d.className=d.initialClassName+"Selected"}}}this.container.appendChild(d);return d};mxToolbar.prototype.selectMode=function(d,a){if(this.selectedMode!=d){var b=this.selectedMode.altIcon;if(b!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",b)}else{this.selectedMode.className=this.selectedMode.initialClassName}this.selectedMode=d;var b=this.selectedMode.altIcon;if(b!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",b)}else{this.selectedMode.className=this.selectedMode.initialClassName+"Selected"}this.dispatchEvent("select",this,a)}};mxToolbar.prototype.resetMode=function(a){if((a||!this.noReset)&&this.selectedMode!=this.defaultMode){this.selectMode(this.defaultMode,null)}};mxToolbar.prototype.addSeparator=function(a){return this.addItem(null,a,null)};mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container)};mxToolbar.prototype.addLine=function(){var a=document.createElement("hr");a.style.marginRight="6px";a.setAttribute("size","1");this.container.appendChild(a)};mxToolbar.prototype.destroy=function(){mxUtils.release(this.container);this.container=null;this.defaultMode=null;this.selectedMode=null;if(this.menu!=null){this.menu.destroy()}};function mxSession(e,d,b,f){this.model=e;this.urlInit=d;this.urlPoll=b;this.urlNotify=f;if(e!=null){this.codec=new mxCodec();this.codec.lookup=function(g){return e.getCell(g)}}var a=this;e.addListener("notify",function(g,h){if(h!=null&&a.debug||(a.connected&&!a.suspended)){a.notify(a.encodeChanges(h))}})}mxSession.prototype=new mxEventSource();mxSession.prototype.constructor=mxSession;mxSession.prototype.model=null;mxSession.prototype.urlInit=null;mxSession.prototype.urlPoll=null;mxSession.prototype.urlNotify=null;mxSession.prototype.codec=null;mxSession.prototype.linefeed="\n";mxSession.prototype.significantRemoteChanges=true;mxSession.prototype.sent=0;mxSession.prototype.received=0;mxSession.prototype.debug=false;mxSession.prototype.connected=false;mxSession.prototype.suspended=false;mxSession.prototype.polling=false;mxSession.prototype.start=function(){if(this.debug){this.connected=true;this.dispatchEvent("connect",this)}else{if(!this.connected){var a=this;this.get(this.urlInit,function(b){a.connected=true;a.dispatchEvent("connect",a);a.poll()})}}};mxSession.prototype.suspend=function(){if(this.connected&&!this.suspended){this.suspended=true;this.dispatchEvent("suspend",this)}};mxSession.prototype.resume=function(b,a,d){if(this.connected&&this.suspended){this.suspended=false;this.dispatchEvent("resume",this);if(!this.polling){this.poll()}}};mxSession.prototype.stop=function(a){if(this.connected){this.connected=false}this.dispatchEvent("disconnect",this,a)};mxSession.prototype.poll=function(){if(this.connected&&!this.suspended&&this.urlPoll!=null){this.polling=true;var a=this;this.get(this.urlPoll,function(){a.poll()})}else{this.polling=false}};mxSession.prototype.notify=function(a,b,d){if(a!=null&&a.length>0){if(this.urlNotify!=null){if(this.debug){mxLog.show();mxLog.debug("mxSession.notify: "+this.urlNotify+" xml="+a)}else{mxUtils.post(this.urlNotify,"xml="+a,b,d)}}this.sent+=a.length;this.dispatchEvent("notify",this,this.urlNotify,a)}};mxSession.prototype.get=function(d,e,g){if(typeof(mxUtils)!="undefined"){var b=this;var a=function(h){if(g!=null){g(h)}else{b.stop(h)}};var f=mxUtils.get(d,function(k){if(typeof(mxUtils)!="undefined"){try{if(k.isReady()&&k.getStatus()!=404){b.received+=k.getText().length;b.dispatchEvent("get",b,d,k);if(b.isValidResponse(k)){if(k.getText().length>0){var j=k.getDocumentElement();if(j==null){a("Invalid response: "+k.getText())}else{b.receive(j)}}if(e!=null){e(k)}}}else{a("Response not ready")}}catch(h){a(h);throw h}}},function(h){a("Transmission error")})}};mxSession.prototype.isValidResponse=function(a){return a.getText().indexOf("<?php")<0};mxSession.prototype.encodeChanges=function(d){var a="";for(var b=0;b<d.length;b++){var e=this.codec.encode(d[b]);a+=mxUtils.getXml(e,this.linefeed)}return a};mxSession.prototype.receive=function(g){if(g!=null&&g.nodeType==mxConstants.NODETYPE_ELEMENT){var b=g.nodeName.toLowerCase();if(b=="state"){var d=g.firstChild;while(d!=null){this.receive(d);d=d.nextSibling}var a=g.getAttribute("namespace");this.model.prefix=a+"-"}else{if(b=="delta"){var e=this.decodeChanges(g);if(e.length>0){var f=this.createUndoableEdit(e);this.model.dispatchEvent("undo",this.model,f);this.model.dispatchEvent("change",this.model,e);this.dispatchEvent("dispatched",this,e)}}}this.dispatchEvent("receive",this,g)}};mxSession.prototype.createUndoableEdit=function(a){var b=new mxUndoableEdit(this.model,this.significantRemoteChanges);b.changes=a;b.notify=function(){b.source.dispatchEvent("change",b.source,b.changes);b.source.dispatchEvent("notify",b.source,b.changes)};return b};mxSession.prototype.decodeChanges=function(b){this.codec.document=b.ownerDocument;var a=new Array();b=b.firstChild;while(b!=null){if(b.nodeType==mxConstants.NODETYPE_ELEMENT){var e=null;if(b.nodeName=="mxRootChange"){var d=new mxCodec(b.ownerDocument);e=d.decode(b)}else{e=this.codec.decode(b)}if(e!=null){e.model=this.model;e.execute();a.push(e)}}b=b.nextSibling}return a};function mxUndoableEdit(b,a){this.source=b;this.changes=new Array();this.significant=(a!=null)?a:true}mxUndoableEdit.prototype.source=null;mxUndoableEdit.prototype.changes=null;mxUndoableEdit.prototype.significant=null;mxUndoableEdit.prototype.undone=false;mxUndoableEdit.prototype.redone=false;mxUndoableEdit.prototype.isEmpty=function(){return this.changes.length==0};mxUndoableEdit.prototype.isSignificant=function(){return this.significant};mxUndoableEdit.prototype.add=function(a){this.changes.push(a)};mxUndoableEdit.prototype.notify=function(){};mxUndoableEdit.prototype.die=function(){};mxUndoableEdit.prototype.undo=function(){if(!this.undone){var b=this.changes.length;for(var a=b-1;a>=0;a--){var d=this.changes[a];if(d.execute!=null){d.execute()}else{if(d.undo!=null){d.undo()}}}this.undone=true;this.redone=false}this.notify()};mxUndoableEdit.prototype.redo=function(){if(!this.redone){var b=this.changes.length;for(var a=0;a<b;a++){var d=this.changes[a];if(d.execute!=null){d.execute()}else{if(d.redo!=null){d.redo()}}}this.undone=false;this.redone=true}this.notify()};function mxUndoManager(a){this.size=a||100;this.reset()}mxUndoManager.prototype=new mxEventSource();mxUndoManager.prototype.constructor=mxUndoManager;mxUndoManager.prototype.size=null;mxUndoManager.prototype.history=null;mxUndoManager.prototype.indexOfNextAdd=0;mxUndoManager.prototype.reset=function(){this.history=new Array();this.indexOfNextAdd=0};mxUndoManager.prototype.canUndo=function(){return this.indexOfNextAdd>0};mxUndoManager.prototype.undo=function(){while(this.indexOfNextAdd>0){var a=this.history[--this.indexOfNextAdd];a.undo();if(a.isSignificant()){this.dispatchEvent("undo",this,a);break}}};mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length};mxUndoManager.prototype.redo=function(){var b=this.history.length;while(this.indexOfNextAdd<b){var a=this.history[this.indexOfNextAdd++];a.redo();if(a.isSignificant()){this.dispatchEvent("redo",this,a);break}}};mxUndoManager.prototype.undoableEditHappened=function(a){this.trim();if(this.size==this.history.length){this.history.shift()}this.history.push(a);this.indexOfNextAdd=this.history.length;this.dispatchEvent("add",this,a)};mxUndoManager.prototype.trim=function(){if(this.history.length>this.indexOfNextAdd){var a=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd);for(var b=0;b<a.length;b++){a[b].die()}}};function mxPath(a){this.format=a;this.path=new Array();this.translate=new mxPoint(0,0)}mxPath.prototype.format=null;mxPath.prototype.translate=null;mxPath.prototype.path=null;mxPath.prototype.isVml=function(){return this.format=="vml"};mxPath.prototype.getPath=function(){return this.path.join("")};mxPath.prototype.setTranslate=function(a,b){this.translate=new mxPoint(a,b)};mxPath.prototype.moveTo=function(a,b){if(this.isVml()){this.path.push("m ",Math.floor(this.translate.x+a)," ",Math.floor(this.translate.y+b)," ")}else{this.path.push("M ",Math.floor(this.translate.x+a)," ",Math.floor(this.translate.y+b)," ")}};mxPath.prototype.lineTo=function(a,b){if(this.isVml()){this.path.push("l ",Math.floor(this.translate.x+a)," ",Math.floor(this.translate.y+b)," ")}else{this.path.push("L ",Math.floor(this.translate.x+a)," ",Math.floor(this.translate.y+b)," ")}};mxPath.prototype.curveTo=function(d,f,b,e,a,g){if(this.isVml()){this.path.push("c ",Math.floor(this.translate.x+d)," ",Math.floor(this.translate.y+f)," ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+e)," ",Math.floor(this.translate.x+a)," ",Math.floor(this.translate.y+g)," ")}else{this.path.push("C ",(this.translate.x+d)," ",(this.translate.y+f)," ",(this.translate.x+b)," ",(this.translate.y+e)," ",(this.translate.x+a)," ",(this.translate.y+g)," ")}};mxPath.prototype.write=function(a){this.path.push(a," ")};mxPath.prototype.end=function(){if(this.format=="vml"){this.path.push("e")}};mxPath.prototype.close=function(){if(this.format=="vml"){this.path.push("x e")}else{this.path.push("Z")}};function mxPopupMenu(a){this.factoryMethod=a}mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"submenu.gif";mxPopupMenu.prototype.factoryMethod=true;mxPopupMenu.prototype.useShiftKey=true;mxPopupMenu.prototype.useLeftButtonForPopup=false;mxPopupMenu.prototype.enabled=true;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.appendChild(this.table);if(!mxClient.IS_IE&&mxClient.MENU_SHADOWS){this.shadow=document.createElement("div");this.shadow.style.background=mxConstants.SVG_SHADOWCOLOR;mxUtils.setOpacity(this.shadow,70);this.shadow.style.position="absolute";this.shadow.style.display="inline"}else{if(mxClient.IS_IE&&!mxClient.MENU_SHADOWS){this.div.style.filter=""}}mxEvent.disableContextMenu(this.div)};mxPopupMenu.prototype.isEnabled=function(){return this.enabled};mxPopupMenu.prototype.setEnabled=function(a){this.enabled=a};mxPopupMenu.prototype.isPopupTrigger=function(b,a){return mxEvent.isPopupTrigger(b)||(this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(b))||(this.useShiftKey&&b.shiftKey)};mxPopupMenu.prototype.addItem=function(j,b,a,l){l=l||this;this.itemCount++;var h=document.createElement("tr");h.className="mxPopupMenuItem";var g=document.createElement("td");g.className="mxPopupMenuIcon";if(b!=null){var d=document.createElement("img");if(!mxClient.IS_IE){if(this.loading==null){this.loading=0}this.loading++;var m=this;var k=function(){mxEvent.removeListener(d,"load",k);m.loading--;if(m.loading==0){m.showShadow()}};mxEvent.addListener(d,"load",k)}d.src=b;g.appendChild(d)}h.appendChild(g);var f=document.createElement("td");f.className="mxPopupMenuItem";mxUtils.write(f,j);f.align="left";h.appendChild(f);var e=document.createElement("td");e.style.width="10px";e.style.paddingRight="6px";h.appendChild(e);if(l.div==null){this.createSubmenu(l)}l.tbody.appendChild(h);var m=this;mxEvent.addListener(h,"mousedown",function(n){m.eventReceiver=h;if(l.activeRow!=h&&l.activeRow!=l){if(l.activeRow!=null&&l.activeRow.div.parentNode!=null){m.hideSubmenu(l)}if(h.div!=null){m.showSubmenu(l,h);l.activeRow=h}}mxEvent.consume(n)});mxEvent.addListener(h,"mouseup",function(n){if(m.eventReceiver==h){if(l.activeRow!=h){m.hideMenu()}if(a!=null){a(n)}}m.eventReceiver=null;mxEvent.consume(n)});mxEvent.addListener(h,"mousemove",function(n){if(l.activeRow!=h&&l.activeRow!=l){if(l.activeRow!=null&&l.activeRow.div.parentNode!=null){m.hideSubmenu(l)}}if(mxClient.IS_IE){h.style.backgroundColor="#000066";h.style.color="white"}});if(mxClient.IS_IE){mxEvent.addListener(h,"mouseout",function(n){h.style.backgroundColor="";h.style.color=""})}return h};mxPopupMenu.prototype.createSubmenu=function(b){b.table=document.createElement("table");b.table.className="mxPopupMenu";b.tbody=document.createElement("tbody");b.table.appendChild(b.tbody);b.div=document.createElement("div");b.div.className="mxPopupMenu";b.div.style.position="absolute";b.div.style.display="inline";b.div.appendChild(b.table);var a=document.createElement("img");a.setAttribute("src",this.submenuImage);td=b.firstChild.nextSibling.nextSibling;td.appendChild(a)};mxPopupMenu.prototype.showSubmenu=function(g,k){if(k.div!=null){k.div.style.left=(g.div.offsetLeft+k.offsetLeft+k.offsetWidth-1)+"px";k.div.style.top=(g.div.offsetTop+k.offsetTop)+"px";document.body.appendChild(k.div);var h=parseInt(k.div.offsetLeft);var f=parseInt(k.div.offsetWidth);var a=document.body;var j=document.documentElement;var e=(a.scrollLeft||j.scrollLeft)+(a.clientWidth||j.clientWidth);if(h+f>e){k.div.style.left=(g.div.offsetLeft-f+((mxClient.IS_IE)?6:-6))+"px"}mxUtils.fit(k.div)}};mxPopupMenu.prototype.addSeparator=function(b){b=b||this;var e=document.createElement("tr");var f=document.createElement("td");f.className="mxPopupMenuIcon";f.style.padding="0 0 0 0px";e.appendChild(f);var d=document.createElement("td");d.style.padding="0 0 0 0px";d.setAttribute("colSpan","2");var a=document.createElement("hr");a.setAttribute("size","1");d.appendChild(a);e.appendChild(d);b.tbody.appendChild(e)};mxPopupMenu.prototype.popup=function(b,e,a,d){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){this.div.style.left=b+"px";this.div.style.top=e+"px";while(this.tbody.firstChild!=null){mxUtils.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild)}this.itemCount=0;this.factoryMethod(this,a,d);if(this.itemCount>0){this.showMenu()}}};mxPopupMenu.prototype.isMenuShowing=function(){return this.div.parentNode==document.body};mxPopupMenu.prototype.showMenu=function(){document.body.appendChild(this.div);mxUtils.fit(this.div);if(this.shadow!=null){if(!this.loading){this.showShadow()}}};mxPopupMenu.prototype.showShadow=function(){if(this.shadow!=null&&this.div.parentNode==document.body){this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";document.body.appendChild(this.shadow)}};mxPopupMenu.prototype.hideMenu=function(){if(this.div!=null){if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}if(this.shadow!=null){if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow)}}this.hideSubmenu(this)}};mxPopupMenu.prototype.hideSubmenu=function(a){if(a.activeRow!=null){this.hideSubmenu(a.activeRow);if(a.activeRow.div.parentNode!=null){a.activeRow.div.parentNode.removeChild(a.activeRow.div)}a.activeRow=null}};mxPopupMenu.prototype.destroy=function(){if(this.div!=null){mxUtils.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}this.div=null}if(this.shadow!=null){mxUtils.release(this.shadow);if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow)}this.shadow=null}};function mxShape(){}mxShape.prototype.SVG_STROKE_TOLERANCE=8;mxShape.prototype.scale=1;mxShape.prototype.dialect=null;mxShape.prototype.mixedModeHtml=true;mxShape.prototype.preferModeHtml=true;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.label=null;mxShape.prototype.innerNode=null;mxShape.prototype.style=null;mxShape.prototype.startOffset=null;mxShape.prototype.endOffset=null;mxShape.prototype.init=function(a){if(this.node==null){this.node=this.create(a);if(a!=null){a.appendChild(this.node)}}this.redraw()};mxShape.prototype.isMixedModeHtml=function(){return this.mixedModeHtml&&!this.isRounded&&!this.isShadow&&this.gradient==null};mxShape.prototype.create=function(a){var b=null;if(this.dialect==mxConstants.DIALECT_SVG){b=this.createSvg()}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.preferModeHtml&&this.dialect==mxConstants.DIALECT_PREFERHTML)||(this.isMixedModeHtml()&&this.dialect==mxConstants.DIALECT_MIXEDHTML)){b=this.createHtml()}else{b=this.createVml()}}return b};mxShape.prototype.createHtml=function(){var a=document.createElement("DIV");this.configureHtmlShape(a);return a};mxShape.prototype.destroy=function(){if(this.node!=null){mxUtils.release(this.node);if(this.node.parentNode!=null){this.node.parentNode.removeChild(this.node)}this.node=null}};mxShape.prototype.apply=function(b){var a=b.style;this.style=a;if(a!=null){this.fill=mxUtils.getValue(a,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(a,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(a,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(a,mxConstants.STYLE_OPACITY,this.opacity);this.stroke=mxUtils.getValue(a,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getValue(a,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.isShadow=mxUtils.getValue(a,mxConstants.STYLE_SHADOW,this.isShadow);this.isDashed=mxUtils.getValue(a,mxConstants.STYLE_DASHED,this.isDashed);this.spacing=mxUtils.getValue(a,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getValue(a,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getValue(a,mxConstants.STYLE_ENDSIZE,this.endSize);this.isRounded=mxUtils.getValue(a,mxConstants.STYLE_ROUNDED,this.isRounded);this.startArrow=mxUtils.getValue(a,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(a,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(a,mxConstants.STYLE_ROTATION,this.rotation)}};mxShape.prototype.createSvgGroup=function(a){var b=document.createElementNS(mxConstants.NS_SVG,"g");this.innerNode=document.createElementNS(mxConstants.NS_SVG,a);this.configureSvgShape(this.innerNode);this.shadowNode=this.createSvgShadow(this.innerNode);if(this.shadowNode!=null){b.appendChild(this.shadowNode)}b.appendChild(this.innerNode);return b};mxShape.prototype.createSvgShadow=function(a){if(this.isShadow&&this.fill!=null){var b=a.cloneNode(true);b.setAttribute("stroke",mxConstants.SVG_SHADOWCOLOR);b.setAttribute("fill",mxConstants.SVG_SHADOWCOLOR);b.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM);return b}return null};mxShape.prototype.configureHtmlShape=function(b){if(mxUtils.isVml(b)){this.configureVmlShape(b)}else{b.style.position="absolute";b.style.overflow="hidden";var a=this.stroke;if(a!=null){b.style.borderColor=a;if(this.isDashed){b.style.borderStyle="dashed"}else{if(this.strokewidth>0){b.style.borderStyle="solid"}}b.style.borderWidth=this.strokewidth+"px"}a=this.fill;if(a!=null){b.style.backgroundColor=a}else{b.style.background="url('"+mxClient.imageBasePath+"transparent.gif')"}if(this.opacity!=null){mxUtils.setOpacity(b,this.opacity)}}};mxShape.prototype.configureVmlShape=function(b){b.style.position="absolute";var a=this.stroke;if(a!=null){b.setAttribute("strokecolor",a)}else{b.setAttribute("stroked","false")}a=this.fill;if(a!=null){b.setAttribute("fillcolor",a);if(b.fillNode==null){b.fillNode=document.createElement("v:fill");b.appendChild(b.fillNode)}b.fillNode.setAttribute("color",a);if(this.gradient!=null){b.fillNode.setAttribute("type","gradient");b.fillNode.setAttribute("color2",this.gradient);var d="180";if(this.gradientDirection==mxConstants.DIRECTION_EAST){d="270"}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){d="90"}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){d="0"}}}b.fillNode.setAttribute("angle",d)}if(this.opacity!=null){b.fillNode.setAttribute("opacity",this.opacity+"%");if(this.gradient!=null){b.fillNode.setAttribute("o:opacity2",this.opacity+"%")}}}else{b.setAttribute("filled","false");if(b.fillNode!=null){mxUtils.release(b.fillNode);b.removeChild(b.fillNode);b.fillNode=null}}if((this.isDashed||this.opacity!=null)&&this.strokeNode==null){this.strokeNode=document.createElement("v:stroke");b.appendChild(this.strokeNode)}if(this.strokeNode!=null){if(this.isDashed){this.strokeNode.setAttribute("dashstyle","2 2")}else{this.strokeNode.setAttribute("dashstyle","solid")}if(this.opacity!=null){this.strokeNode.setAttribute("opacity",this.opacity+"%")}}if(this.isShadow&&this.fill!=null){if(this.shadowNode==null){this.shadowNode=document.createElement("v:shadow");this.shadowNode.setAttribute("on","true");b.appendChild(this.shadowNode)}}if(b.nodeName=="v:rect"&&this.isRounded){b.setAttribute("arcsize","15%")}};mxShape.prototype.configureSvgShape=function(b){var a=this.stroke;if(a!=null){b.setAttribute("stroke",a)}else{b.setAttribute("stroke","none")}a=this.fill;if(a!=null){if(this.gradient!=null){var d=this.getGradientId(a,this.gradient,this.opacity);if(this.gradientNode!=null&&this.gradientNode.getAttribute("id")!=d){this.gradientNode=null;b.setAttribute("fill","")}if(this.gradientNode==null){this.gradientNode=this.createSvgGradient(d,a,this.gradient,this.opacity);b.setAttribute("fill","url(#"+d+")")}}else{this.gradientNode=null;b.setAttribute("fill",a)}}else{b.setAttribute("fill","none")}if(this.isDashed){b.setAttribute("stroke-dasharray","3, 3")}if(this.opacity!=null){b.setAttribute("fill-opacity",this.opacity/100);b.setAttribute("stroke-opacity",this.opacity/100)}};mxShape.prototype.getGradientId=function(f,a,d){var e=(d!=null)?d:100;var b=null;if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){b="south"}else{if(this.gradientDirection==mxConstants.DIRECTION_EAST){b="east"}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){b="north"}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){b="west"}}}}return"mxGradient-"+f+"-"+a+"-"+e+"-"+b};mxShape.prototype.createSvgGradient=function(j,h,a,d){var g=(d!=null)?d:100;var f=document.getElementById(j);if(f==null){var f=document.createElementNS(mxConstants.NS_SVG,"linearGradient");f.setAttribute("id",j);f.setAttribute("x1","0%");f.setAttribute("y1","0%");f.setAttribute("x2","0%");f.setAttribute("y2","0%");if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){f.setAttribute("y2","100%")}else{if(this.gradientDirection==mxConstants.DIRECTION_EAST){f.setAttribute("x2","100%")}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){f.setAttribute("y1","100%")}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){f.setAttribute("x1","100%")}}}}var e=document.createElementNS(mxConstants.NS_SVG,"stop");e.setAttribute("offset","0%");e.setAttribute("style","stop-color:"+h+";stop-opacity:"+(g/100));f.appendChild(e);e=document.createElementNS(mxConstants.NS_SVG,"stop");e.setAttribute("offset","100%");e.setAttribute("style","stop-color:"+a+";stop-opacity:"+(g/100));f.appendChild(e);var b=document.getElementsByTagName("svg")[0];b.appendChild(f)}return f};mxShape.prototype.createPoints=function(s,b,n,j){var q=(j)?this.bounds.x:0;var p=(j)?this.bounds.y:0;var f=20*this.scale;var m=s+" "+Math.floor(this.points[0].x-q)+" "+Math.floor(this.points[0].y-p)+" ";for(var o=1;o<this.points.length;o++){var h=this.points[o];var a=this.points[o-1];if(o==1&&this.startOffset!=null){a=a.clone();a.x+=this.startOffset.x;a.y+=this.startOffset.y}else{if(o==this.points.length-1&&this.endOffset!=null){h=h.clone();h.x+=this.endOffset.x;h.y+=this.endOffset.y}}var e=a.x-h.x;var d=a.y-h.y;if((this.isRounded&&o<this.points.length-1)&&(e!=0||d!=0)&&this.scale>0.3){var k=Math.sqrt(e*e+d*d);var l=e*Math.min(f,k/2)/k;var u=d*Math.min(f,k/2)/k;m+=b+" "+Math.floor(h.x+l-q)+" "+Math.floor(h.y+u-p)+" ";var t=this.points[o+1];e=t.x-h.x;d=t.y-h.y;k=Math.max(1,Math.sqrt(e*e+d*d));var g=e*Math.min(f,k/2)/k;var r=d*Math.min(f,k/2)/k;m+=n+" "+Math.floor(h.x-q)+" "+Math.floor(h.y-p)+" "+Math.floor(h.x-q)+","+Math.floor(h.y-p)+" "+Math.floor(h.x+g-q)+" "+Math.floor(h.y+r-p)+" "}else{m+=b+" "+Math.floor(h.x-q)+" "+Math.floor(h.y-p)+" "}}return m};mxShape.prototype.updateHtmlShape=function(r){if(r!=null){if(mxUtils.isVml(r)){this.updateVmlShape(r)}else{r.style.borderWidth=Math.max(1,Math.floor(this.strokewidth*this.scale))+"px";if(this.bounds!=null){try{r.style.left=Math.floor(this.bounds.x)+"px";r.style.top=Math.floor(this.bounds.y)+"px";r.style.width=Math.floor(this.bounds.width)+"px";r.style.height=Math.floor(this.bounds.height)+"px";}catch(e){}}}if(this.points!=null&&this.bounds!=null&&!mxUtils.isVml(r)){if(this.divContainer==null){this.divContainer=document.createElement("div");r.appendChild(this.divContainer)}r.style.borderStyle="none";while(this.divContainer.firstChild!=null){mxUtils.release(this.divContainer.firstChild);this.divContainer.removeChild(this.divContainer.firstChild)}if(this.points.length==2){var a=this.points[0];var D=this.points[1];var m=D.x-a.x;var k=D.y-a.y;if(m==0||k==0){r.style.borderStyle="solid"}else{r.style.width=Math.floor(this.bounds.width+1)+"px";r.style.height=Math.floor(this.bounds.height+1)+"px";var d=Math.sqrt(m*m+k*k);var b=1+(d/(20*this.scale));var A=m/b;var z=k/b;var j=a.x-this.bounds.x;var g=a.y-this.bounds.y;for(var t=0;t<b;t++){var B=document.createElement("DIV");B.style.position="absolute";B.style.overflow="hidden";B.style.left=Math.floor(j)+"px";B.style.top=Math.floor(g)+"px";B.style.width=Math.max(1,2*this.scale)+"px";B.style.height=Math.max(1,2*this.scale)+"px";B.style.backgroundColor=this.stroke;this.divContainer.appendChild(B);j+=A;g+=z}}}else{if(this.points.length==3){var C=this.points[1];var q="0";var o="1";var l="0";var v="1";if(C.x==this.bounds.x){v="0";l="1"}if(C.y==this.bounds.y){q="1";o="0"}r.style.borderStyle="solid";r.style.borderWidth=q+" "+v+" "+o+" "+l+"px"}else{r.style.width=Math.floor(this.bounds.width+1)+"px";r.style.height=Math.floor(this.bounds.height+1)+"px";var f=this.points[0];for(var t=1;t<this.points.length;t++){var p=this.points[t];var B=document.createElement("DIV");B.style.position="absolute";B.style.overflow="hidden";B.style.borderColor=this.stroke;B.style.borderStyle="solid";B.style.borderWidth="1 0 0 1px";var j=Math.min(p.x,f.x)-this.bounds.x;var g=Math.min(p.y,f.y)-this.bounds.y;var l=Math.max(1,Math.abs(p.x-f.x));var u=Math.max(1,Math.abs(p.y-f.y));B.style.left=j+"px";B.style.top=g+"px";B.style.width=l+"px";B.style.height=u+"px";this.divContainer.appendChild(B);f=p}}}}}};mxShape.prototype.updateVmlShape=function(d){d.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.bounds!=null){d.style.left=Math.floor(this.bounds.x)+"px";d.style.top=Math.floor(this.bounds.y)+"px";d.style.width=Math.floor(this.bounds.width)+"px";d.style.height=Math.floor(this.bounds.height)+"px";if(this.points==null){if(this.rotation!=null&&this.rotation!=0){d.style.rotation=this.rotation}else{d.style.rotation=null}}}if(this.points!=null){if(d.nodeName=="polyline"&&d.points!=null){var b="";for(var a=0;a<this.points.length;a++){b+=this.points[a].x+","+this.points[a].y+" "}d.points.value=b;d.style.left=null;d.style.top=null;d.style.width=null;d.style.height=null}else{if(this.bounds!=null){this.node.setAttribute("coordsize",Math.floor(this.bounds.width)+","+Math.floor(this.bounds.height));var b=this.createPoints("m","l","c",true);d.setAttribute("path",b+" e")}}}};mxShape.prototype.updateSvgShape=function(e){var f=Math.max(1,this.strokewidth*this.scale);e.setAttribute("stroke-width",f);if(this.points!=null&&this.points[0]!=null){e.setAttribute("d",this.createPoints("M","L","C",false));e.removeAttribute("x");e.removeAttribute("y");e.removeAttribute("width");e.removeAttribute("height")}else{if(this.bounds!=null){e.setAttribute("x",this.bounds.x);e.setAttribute("y",this.bounds.y);var a=this.bounds.width;var b=this.bounds.height;e.setAttribute("width",a);e.setAttribute("height",b);if(this.isRounded){var d=Math.min(a/5,b/5);e.setAttribute("rx",d);e.setAttribute("ry",d)}this.updateSvgTransform(e,e==this.shadowNode)}}};mxShape.prototype.updateSvgTransform=function(b,e){if(this.rotation!=null&&this.rotation!=0){var a=this.bounds.x+this.bounds.width/2;var d=this.bounds.y+this.bounds.height/2;if(e){b.setAttribute("transform","rotate("+this.rotation+","+a+","+d+") "+mxConstants.SVG_SHADOWTRANSFORM)}else{b.setAttribute("transform","rotate("+this.rotation+","+a+","+d+")")}}else{if(e){b.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM)}else{b.removeAttribute("transform")}}};mxShape.prototype.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){if(this.innerNode!=null){this.configureSvgShape(this.innerNode)}else{this.configureSvgShape(this.node)}}else{if(mxUtils.isVml(this.node)){this.configureVmlShape(this.node)}else{this.configureHtmlShape(this.node)}}};mxShape.prototype.redraw=function(){if(this.dialect==mxConstants.DIALECT_SVG){this.redrawSvg()}else{if(mxUtils.isVml(this.node)){this.redrawVml()}else{this.redrawHtml()}}};mxShape.prototype.redrawSvg=function(){if(this.innerNode!=null){this.updateSvgShape(this.innerNode);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode)}}else{this.updateSvgShape(this.node)}};mxShape.prototype.redrawVml=function(){this.updateVmlShape(this.node)};mxShape.prototype.redrawHtml=function(){this.updateHtmlShape(this.node)};mxShape.prototype.createPath=function(b){var a=this.bounds.x;var g=this.bounds.y;var d=this.bounds.width;var e=this.bounds.height;var f=null;if(this.dialect==mxConstants.DIALECT_SVG){f=new mxPath("svg");f.setTranslate(a,g)}else{f=new mxPath("vml")}this.redrawPath(f,a,g,d,e,b);return f.getPath()};mxShape.prototype.redrawPath=function(e,a,f,b,d){};function mxActor(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxActor.prototype=new mxShape();mxActor.prototype.constructor=mxActor;mxActor.prototype.mixedModeHtml=false;mxActor.prototype.preferModeHtml=false;mxActor.prototype.createVml=function(){var a=document.createElement("v:shape");this.configureVmlShape(a);return a};mxActor.prototype.redrawVml=function(){this.updateVmlShape(this.node);var a=Math.floor(this.bounds.width);var e=Math.floor(this.bounds.height);var b=this.strokewidth*this.scale;this.node.setAttribute("coordsize",a+","+e);this.node.setAttribute("strokeweight",b);var f=this.createPath();this.node.setAttribute("path",f)};mxActor.prototype.createSvg=function(){return this.createSvgGroup("path")};mxActor.prototype.redrawSvg=function(){var b=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",b);var a=this.createPath();this.innerNode.setAttribute("d",a);this.updateSvgTransform(this.innerNode,false);if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",b);this.shadowNode.setAttribute("d",a);this.updateSvgTransform(this.shadowNode,true)}};mxActor.prototype.redrawPath=function(f,a,g,b,e){var d=b/3;f.moveTo(0,e);f.curveTo(0,3*e/5,0,2*e/5,b/2,2*e/5);f.curveTo(b/2-d,2*e/5,b/2-d,0,b/2,0);f.curveTo(b/2+d,0,b/2+d,2*e/5,b/2,2*e/5);f.curveTo(b,2*e/5,b,3*e/5,b,e);f.close()};function mxCloud(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxCloud.prototype=new mxActor();mxCloud.prototype.constructor=mxActor;mxCloud.prototype.redrawPath=function(e,a,f,b,d){e.moveTo(0.25*b,0.25*d);e.curveTo(0.05*b,0.25*d,0,0.5*d,0.16*b,0.55*d);e.curveTo(0,0.66*d,0.18*b,0.9*d,0.31*b,0.8*d);e.curveTo(0.4*b,d,0.7*b,d,0.8*b,0.8*d);e.curveTo(b,0.8*d,b,0.6*d,0.875*b,0.5*d);e.curveTo(b,0.3*d,0.8*b,0.1*d,0.625*b,0.2*d);e.curveTo(0.5*b,0.05*d,0.3*b,0.05*d,0.25*b,0.25*d);e.close()};function mxRectangleShape(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxRectangleShape.prototype=new mxShape();mxRectangleShape.prototype.constructor=mxRectangleShape;mxRectangleShape.prototype.createHtml=function(){var a=document.createElement("DIV");this.configureHtmlShape(a);return a};mxRectangleShape.prototype.createVml=function(){var a=(this.isRounded)?"v:roundrect":"v:rect";var b=document.createElement(a);this.configureVmlShape(b);return b};mxRectangleShape.prototype.createSvg=function(){var a=this.createSvgGroup("rect");if(this.strokewidth*this.scale>=1&&!this.isRounded){this.innerNode.setAttribute("shape-rendering","optimizeSpeed")}return a};function mxEllipse(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxEllipse.prototype=new mxShape();mxEllipse.prototype.constructor=mxEllipse;mxEllipse.prototype.mixedModeHtml=false;mxEllipse.prototype.preferModeHtml=false;mxEllipse.prototype.createVml=function(){var a=document.createElement("v:arc");a.setAttribute("startangle","0");a.setAttribute("endangle","360");this.configureVmlShape(a);return a};mxEllipse.prototype.createSvg=function(){return this.createSvgGroup("ellipse")};mxEllipse.prototype.redrawSvg=function(){this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode)};mxEllipse.prototype.updateSvgNode=function(a){if(a!=null){var b=Math.max(1,this.strokewidth*this.scale);a.setAttribute("stroke-width",b);a.setAttribute("cx",this.bounds.x+this.bounds.width/2);a.setAttribute("cy",this.bounds.y+this.bounds.height/2);a.setAttribute("rx",this.bounds.width/2);a.setAttribute("ry",this.bounds.height/2)}};function mxDoubleEllipse(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxDoubleEllipse.prototype=new mxShape();mxDoubleEllipse.prototype.constructor=mxDoubleEllipse;mxDoubleEllipse.prototype.mixedModeHtml=false;mxDoubleEllipse.prototype.preferModeHtml=false;mxDoubleEllipse.prototype.createVml=function(){var a=document.createElement("v:group");this.background=document.createElement("v:arc");this.background.setAttribute("startangle","0");this.background.setAttribute("endangle","360");this.configureVmlShape(this.background);a.appendChild(this.background);this.label=this.background;this.isShadow=false;this.fill=null;this.foreground=document.createElement("v:oval");this.configureVmlShape(this.foreground);a.appendChild(this.foreground);this.stroke=null;this.configureVmlShape(a);return a};mxDoubleEllipse.prototype.redrawVml=function(){var a=Math.floor(this.bounds.x);var g=Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width);var f=Math.floor(this.bounds.height);var e=this.strokewidth*this.scale;this.updateVmlShape(this.node);this.node.setAttribute("coordsize",b+","+f);this.updateVmlShape(this.background);this.background.setAttribute("strokeweight",e);this.background.style.top="0px";this.background.style.left="0px";this.updateVmlShape(this.foreground);this.foreground.setAttribute("strokeweight",e);var d=3+e;this.foreground.style.top=d+"px";this.foreground.style.left=d+"px";this.foreground.style.width=Math.max(0,b-2*d)+"px";this.foreground.style.height=Math.max(0,f-2*d)+"px"};mxDoubleEllipse.prototype.createSvg=function(){var a=this.createSvgGroup("ellipse");this.foreground=document.createElementNS(mxConstants.NS_SVG,"ellipse");if(this.stroke!=null){this.foreground.setAttribute("stroke",this.stroke)}else{this.foreground.setAttribute("stroke","none")}this.foreground.setAttribute("fill","none");a.appendChild(this.foreground);return a};mxDoubleEllipse.prototype.redrawSvg=function(){var a=this.strokewidth*this.scale;this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);this.updateSvgNode(this.foreground,3*this.scale+a)};mxDoubleEllipse.prototype.updateSvgNode=function(b,a){a=(a!=null)?a:0;if(b!=null){var d=Math.max(1,this.strokewidth*this.scale);b.setAttribute("stroke-width",d);b.setAttribute("cx",this.bounds.x+this.bounds.width/2);b.setAttribute("cy",this.bounds.y+this.bounds.height/2);b.setAttribute("rx",this.bounds.width/2-a);b.setAttribute("ry",this.bounds.height/2-a)}};function mxRhombus(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxRhombus.prototype=new mxShape();mxRhombus.prototype.constructor=mxRhombus;mxRhombus.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;mxRhombus.prototype.createHtml=function(){var a=null;if(mxClient.IS_CANVAS){a=document.createElement("CANVAS");this.configureHtmlShape(a);a.style.borderStyle="none"}else{a=document.createElement("DIV");this.configureHtmlShape(a)}return a};mxRhombus.prototype.createVml=function(){var a=document.createElement("v:shape");this.configureVmlShape(a);return a};mxRhombus.prototype.createSvg=function(){return this.createSvgGroup("path")};mxRhombus.prototype.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);this.updateVmlShape(this.node);var a=0;var f=0;var b=Math.floor(this.bounds.width);var e=Math.floor(this.bounds.height);this.node.setAttribute("coordsize",b+","+e);var d="m "+Math.floor(a+b/2)+" "+f+" l "+(a+b)+" "+Math.floor(f+e/2)+" l "+Math.floor(a+b/2)+" "+(f+e)+" l "+a+" "+Math.floor(f+e/2);this.node.setAttribute("path",d+" x e")};mxRhombus.prototype.redrawHtml=function(){if(this.node.nodeName=="CANVAS"){this.redrawCanvas()}else{this.updateHtmlShape(this.node)}};mxRhombus.prototype.redrawCanvas=function(){this.updateHtmlShape(this.node);var a=0;var f=0;var d=this.bounds.width;var e=this.bounds.height;this.node.setAttribute("width",d);this.node.setAttribute("height",e);if(!this.isRepaintNeeded){var b=this.node.getContext("2d");b.clearRect(0,0,d,e);b.beginPath();b.moveTo(a+d/2,f);b.lineTo(a+d,f+e/2);b.lineTo(a+d/2,f+e);b.lineTo(a,f+e/2);b.lineTo(a+d/2,f);if(this.node.style.backgroundColor!="transparent"){b.fillStyle=this.node.style.backgroundColor;b.fill()}if(this.node.style.borderColor!=null){b.strokeStyle=this.node.style.borderColor;b.stroke()}this.isRepaintNeeded=false}};mxRhombus.prototype.redrawSvg=function(){this.updateSvgNode(this.innerNode);if(this.shadowNode!=null){this.updateSvgNode(this.shadowNode)}};mxRhombus.prototype.updateSvgNode=function(f){var k=Math.max(1,this.strokewidth*this.scale);f.setAttribute("stroke-width",k);var a=this.bounds.x;var j=this.bounds.y;var b=this.bounds.width;var e=this.bounds.height;var g="M "+(a+b/2)+" "+j+" L "+(a+b)+" "+(j+e/2)+" L "+(a+b/2)+" "+(j+e)+" L "+a+" "+(j+e/2)+" Z ";f.setAttribute("d",g);this.updateSvgTransform(f,f==this.shadowNode)};function mxPolyline(b,d,a){this.points=b;this.stroke=d||"black";this.strokewidth=a||1}mxPolyline.prototype=new mxShape();mxPolyline.prototype.constructor=mxPolyline;mxPolyline.prototype.create=function(){var a=null;if(this.dialect==mxConstants.DIALECT_SVG){a=this.createSvg()}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.dialect==mxConstants.DIALECT_PREFERHTML&&this.points!=null&&this.points.length>0)){a=document.createElement("DIV");this.configureHtmlShape(a);a.style.borderStyle="none";a.style.background=""}else{a=document.createElement("v:polyline");this.configureVmlShape(a);var b=document.createElement("v:stroke");if(this.opacity!=null){b.setAttribute("opacity",this.opacity+"%")}a.appendChild(b)}}return a};mxPolyline.prototype.createSvg=function(){var b=this.createSvgGroup("path");var a=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",a);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};mxPolyline.prototype.redrawSvg=function(){this.updateSvgShape(this.innerNode);this.pipe.setAttribute("d",this.innerNode.getAttribute("d"));var a=this.strokewidth*this.scale;if(mxConstants.SVG_CRISP_EDGES&&a==Math.floor(a)&&!this.isRounded){this.innerNode.setAttribute("shape-rendering","optimizeSpeed")}else{this.innerNode.setAttribute("shape-rendering","default")}this.pipe.setAttribute("stroke-width",a+mxShape.prototype.SVG_STROKE_TOLERANCE)};function mxArrow(d,f,e,b,a,h,g){this.points=d;this.fill=f;this.stroke=e;this.strokewidth=b||1;this.arrowWidth=a||mxConstants.ARROW_WIDTH;this.spacing=h||mxConstants.ARROW_SPACING;this.endSize=g||mxConstants.ARROW_SIZE}mxArrow.prototype=new mxShape();mxArrow.prototype.constructor=mxArrow;mxArrow.prototype.mixedModeHtml=false;mxArrow.prototype.preferModeHtml=false;mxArrow.prototype.DEG_PER_RAD=57.2957795;mxArrow.prototype.createVml=function(){var a=document.createElement("v:polyline");this.configureVmlShape(a);return a};mxArrow.prototype.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.points!=null){var g=this.spacing*this.scale;var t=this.arrowWidth*this.scale;var e=this.endSize*this.scale;var d=this.points[0];var A=this.points[this.points.length-1];var r=A.x-d.x;var q=A.y-d.y;var s=Math.sqrt(r*r+q*q);var f=s-2*g-e;var z=r/s;var y=q/s;var l=f*z;var k=f*y;var j=t*y/3;var h=-t*z/3;var w=d.x-j/2+g*z;var u=d.y-h/2+g*y;var b=w+j;var a=u+h;var o=b+l;var m=a+k;var x=o+j;var v=m+h;var p=x-3*j;var n=v-3*h;this.node.points.value=w+","+u+","+b+","+a+","+o+","+m+","+x+","+v+","+(A.x-g*z)+","+(A.y-g*y)+","+p+","+n+","+(p+j)+","+(n+h)+","+w+","+u}};mxArrow.prototype.createSvg=function(){var a=document.createElementNS(mxConstants.NS_SVG,"polygon");this.configureSvgShape(a);return a};mxArrow.prototype.redrawSvg=function(){if(this.points!=null){var n=Math.max(1,this.strokewidth*this.scale);this.node.setAttribute("stroke-width",n);var s=this.points[0];var j=this.points[this.points.length-1];var e=j.x-s.x;var d=j.y-s.y;var k=Math.sqrt(e*e+d*d);var f=this.spacing*this.scale;var g=Math.min(25,Math.max(20,k/5))*this.scale;var o=k-2*f;var m=s.x+f;var l=s.y-g/2;var t=g;var r=g*0.3;var q=m+o;var a=l+g;var p=m+","+(l+r)+" "+(q-t)+","+(l+r)+" "+(q-t)+","+l+" "+q+","+(l+g/2)+" "+(q-t)+","+a+" "+(q-t)+","+(a-r)+" "+m+","+(a-r);this.node.setAttribute("points",p);var t=j.x-s.x;var r=j.y-s.y;var b=Math.atan(r/t)*this.DEG_PER_RAD;if(t<0){b-=180}this.node.setAttribute("transform","rotate("+b+","+s.x+","+s.y+")")}};function mxText(n,j,q,h,p,t,l,d,g,v,a,k,b,f,r,o,u,m,s,e){this.value=n;this.bounds=j;this.color=p||"black";this.align=q||0;this.valign=h||0;this.family=t||mxConstants.DEFAULT_FONTFAMILY;this.size=l||mxConstants.DEFAULT_FONTSIZE;this.fontStyle=d||0;this.spacing=parseInt(g||2);this.spacingTop=this.spacing+parseInt(v||0);this.spacingRight=this.spacing+parseInt(a||0);this.spacingBottom=this.spacing+parseInt(k||0);this.spacingLeft=this.spacing+parseInt(b||0);this.isRotate=f||false;this.background=r;this.border=o;this.useTableBounds=(u!=null)?u:true;this.isAbsolute=(m!=null)?m:false;this.isWrapping=(s!=null)?s:false;this.isClipping=(e!=null)?e:false}mxText.prototype=new mxShape();mxText.prototype.constructor=mxText;mxText.prototype.ENABLE_FOREIGNOBJECT=false;mxText.prototype.isStyleSet=function(a){return(this.fontStyle&a)==a};mxText.prototype.create=function(a){var b=null;if(this.dialect==mxConstants.DIALECT_SVG&&(!mxClient.IS_FF3||!this.ENABLE_FOREIGNOBJECT)){b=this.createSvg()}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML||!mxUtils.isVml(a)){if(this.dialect==mxConstants.DIALECT_SVG){b=this.createForeignObject()}else{a.style.overflow="visible";b=this.createHtml()}}else{b=this.createVml()}}return b};mxText.prototype.createForeignObject=function(){var a=document.createElementNS(mxConstants.NS_SVG,"foreignObject");a.style.cursor="default";return a};mxText.prototype.createHtml=function(){var a=document.createElement("DIV");a.style.cursor="default";return a};mxText.prototype.createVml=function(){var a=document.createElement("v:textbox");a.inset="0px,0px,0px,0px";return a};mxText.prototype.redrawHtml=function(){this.redrawVml()};mxText.prototype.redrawVml=function(){if(this.value!=null){var D=(mxClient.IS_IE)?1:this.scale;var B=document.createElement("table");B.style.borderCollapse="collapse";var a=document.createElement("tbody");var j=document.createElement("tr");var l=document.createElement("td");this.node.style.overflow=(this.isClipping)?"hidden":"visible";if(!mxUtils.isVml(this.node)){this.node.style.marginLeft="0px";this.node.style.marginTop="0px"}else{this.node.inset="0px,0px,0px,0px"}if(this.isAbsolute||(this.bounds.width==0&&this.bounds.height==0)){if(mxUtils.isVml(this.node)){var A=parseInt(this.node.parentNode.style.left);var d=parseInt(this.node.parentNode.style.top);this.node.inset=(this.bounds.x-A)+"px,"+(this.bounds.y-d)+"px,0px,0px"}else{this.node.style.position="absolute";this.node.style.left=this.bounds.x+"px";this.node.style.top=this.bounds.y+"px";if(mxUtils.isVml(this.node.parentNode)||mxClient.IS_IE){this.node.style.left=(this.bounds.x-parseInt(this.node.parentNode.style.left)||0)+"px";this.node.style.top=(this.bounds.y-parseInt(this.node.parentNode.style.top)||0)+"px"}if(this.bounds.width>0||this.bounds.height>0){this.node.style.width=this.bounds.width+"px";this.node.style.height=this.bounds.height+"px";B.setAttribute("height","100%");B.setAttribute("width","100%")}}}else{if(!mxUtils.isVml(this.node)){this.node.style.width=this.bounds.width+"px";this.node.style.height=this.bounds.height+"px"}B.setAttribute("height","100%");B.setAttribute("width","100%")}l.style.textAlign=(this.align==mxConstants.ALIGN_RIGHT)?"right":((this.align==mxConstants.ALIGN_CENTER)?"center":"left");l.style.verticalAlign=(this.valign==mxConstants.ALIGN_BOTTOM)?"bottom":((this.valign==mxConstants.ALIGN_MIDDLE)?"middle":"top");var r=l;if(!this.useTableBounds&&(this.background!=null||this.border!=null)){var f=document.createElement("table");f.style.borderCollapse="collapse";var m=document.createElement("tbody");var b=document.createElement("tr");r=document.createElement("td");r.style.textAlign=l.style.textAlign;r.style.verticalAlign=l.style.verticalAlign;b.appendChild(r);m.appendChild(b);f.appendChild(m);l.appendChild(f);if(mxClient.IS_MAC){f.setAttribute("align",l.style.textAlign)}}r.style.zoom=this.scale;r.style.color=this.color;r.style.fontSize=(this.size*D)+"px";r.style.fontFamily=this.family;if(this.isRotate){if(r!=l){l.style.verticalAlign=(this.align==mxConstants.ALIGN_RIGHT)?"top":((this.align==mxConstants.ALIGN_CENTER)?"middle":"bottom");l.style.textAlign=(this.valign==mxConstants.ALIGN_BOTTOM)?"right":((this.valign==mxConstants.ALIGN_MIDDLE)?"center":"left")}r.style.writingMode="tb-rl";r.style.filter="flipv fliph";l.style.paddingTop=(this.spacingRight*this.scale)+"px";l.style.paddingRight=(this.spacingBottom*this.scale)+"px";l.style.paddingBottom=(this.spacingLeft*this.scale)+"px";l.style.paddingLeft=(this.spacingTop*this.scale)+"px"}else{l.style.paddingTop=(this.spacingTop*this.scale)+"px";l.style.paddingRight=(this.spacingRight*this.scale)+"px";l.style.paddingBottom=(this.spacingBottom*this.scale)+"px";l.style.paddingLeft=(this.spacingLeft*this.scale)+"px"}if(this.isStyleSet(mxConstants.FONT_BOLD)){r.style.fontWeight="bold"}else{r.style.fontWeight="normal"}if(this.isStyleSet(mxConstants.FONT_ITALIC)){r.style.fontStyle="italic"}if(this.isStyleSet(mxConstants.FONT_UNDERLINE)){r.style.textDecoration="underline"}if(!this.isWrapping){r.style.whiteSpace="nowrap"}if(this.background!=null){r.style.background=this.background}if(this.border!=null){r.style.borderColor=this.border;r.style.borderWidth="1px";r.style.borderStyle="solid"}if(!mxUtils.isNode(this.value)){var v=this.value.replace(/\n/g,"<br/>");if(mxClient.IS_IE&&this.isStyleSet(mxConstants.FONT_SHADOW)){v='<p style="height:1em;filter:Shadow(Color=#666666,Direction=135,Strength=%);">'+v+"</p>"}r.innerHTML=v}else{r.appendChild(this.value)}j.appendChild(l);a.appendChild(j);B.appendChild(a);if(this.node.nodeName=="foreignObject"){if(this.node.firstChild!=null){B=this.node.firstChild.firstChild;var k=B.firstChild.firstChild.firstChild;k.style.cssText=l.getAttribute("style")}else{var q=document.createElementNS(mxConstants.NS_XHTML,"body");q.style.overflow=this.node.style.overflow;B.setAttribute("width","100%");B.setAttribute("height","100%");q.appendChild(B);this.node.appendChild(q)}}else{this.node.innerHTML="";this.node.appendChild(B)}var s=0;var e=0;var C=(this.isRotate)?this.valign:this.align;var g=(this.isRotate)?this.align:this.valign;if(this.node.style.overflow!="hidden"){if(this.bounds.width>0||this.useTableBounds){s=Math.floor(Math.max(0,B.offsetWidth-this.bounds.width));if(C==mxConstants.ALIGN_CENTER||C==mxConstants.ALIGN_MIDDLE){s=Math.floor(s/2)}else{if(C!=mxConstants.ALIGN_RIGHT&&C!=mxConstants.ALIGN_BOTTOM){s=0}}}if(this.bounds.height>0||this.useTableBounds){e=Math.floor(Math.max(0,B.offsetHeight-this.bounds.height));if(g==mxConstants.ALIGN_MIDDLE||g==mxConstants.ALIGN_CENTER){e=Math.floor(e/2)}else{if((!this.isRotate&&g!=mxConstants.ALIGN_BOTTOM)||(this.isRotate&&g!=mxConstants.ALIGN_LEFT)){e=0}}}if(s>0||e>0){if(!mxUtils.isVml(this.node)){this.node.style.marginLeft=-s+"px";this.node.style.marginTop=-e+"px"}else{var A=parseInt(this.node.parentNode.style.left)||0;var d=parseInt(this.node.parentNode.style.top)||0;s-=this.bounds.x-A;e-=this.bounds.y-d;this.node.inset=(-s)+"px,"+(-e)+"px,0px,0px"}}else{if(mxUtils.isVml(this.node)){var A=parseInt(this.node.parentNode.style.left);var d=parseInt(this.node.parentNode.style.top);this.node.inset=(this.bounds.x-A)+"px,"+(this.bounds.y-d)+"px,"+(d-this.bounds.y)+"px,"+(A-this.bounds.x)+"px"}}}if(this.opacity!=null){mxUtils.setOpacity(this.node,this.opacity)}var o=this.bounds.x-s;var n=this.bounds.y-e;var u=Math.max(this.bounds.width,B.offsetWidth||0);var t=Math.max(this.bounds.height,B.offsetHeight||0);this.boundingBox=new mxRectangle(o,n,u,t)}else{this.node.innerHTML="<div style='width:100%;height:100%;'></div>";this.boundingBox=this.bounds.clone();if(!mxUtils.isVml(this.node)){this.node.style.position="absolute";this.node.style.left=this.bounds.x+"px";this.node.style.top=this.bounds.y+"px";this.node.style.width=this.bounds.width+"px";this.node.style.height=this.bounds.height+"px"}}if(this.node.nodeName=="foreignObject"){this.node.setAttribute("x",parseInt(this.node.style.left)+parseInt(this.node.style.marginLeft));this.node.setAttribute("y",parseInt(this.node.style.top)+parseInt(this.node.style.marginTop));var p=parseInt(this.node.style.width);if(!isNaN(p)){this.node.setAttribute("width",p)}var z=parseInt(this.node.style.height);if(!isNaN(z)){this.node.setAttribute("height",z)}}};mxText.prototype.createSvg=function(){var b=document.createElementNS(mxConstants.NS_SVG,"g");var f=this.isStyleSet(mxConstants.FONT_UNDERLINE)?"underline":"none";var d=this.isStyleSet(mxConstants.FONT_BOLD)?"bold":"normal";var a=this.isStyleSet(mxConstants.FONT_ITALIC)?"italic":null;var e=(this.align==mxConstants.ALIGN_RIGHT)?"end":(this.align==mxConstants.ALIGN_CENTER)?"middle":"start";b.setAttribute("text-decoration",f);b.setAttribute("text-anchor",e);b.setAttribute("font-family",this.family);b.setAttribute("font-weight",d);b.setAttribute("font-size",Math.floor(this.size*this.scale)+"px");b.setAttribute("fill",this.color);if(a!=null){b.setAttribute("font-style",a)}if(this.background!=null||this.border!=null){this.backgroundNode=document.createElementNS(mxConstants.NS_SVG,"rect");this.backgroundNode.setAttribute("shape-rendering","optimizeSpeed");if(this.background!=null){this.backgroundNode.setAttribute("fill",this.background)}else{this.backgroundNode.setAttribute("fill","none")}if(this.border!=null){this.backgroundNode.setAttribute("stroke",this.border)}else{this.backgroundNode.setAttribute("stroke","none")}}this.updateSvgValue(b);return b};mxText.prototype.updateSvgValue=function(d){if(this.currentValue!=this.value){while(d.firstChild!=null){d.removeChild(d.firstChild)}if(this.value!=null){var a=this.value.split("\n");for(var b=0;b<a.length;b++){var e=this.createSvgSpan(a[b]);d.appendChild(e)}}this.currentValue=this.value}};mxText.prototype.redrawSvg=function(){if(this.node.nodeName=="foreignObject"){this.redrawHtml();return}this.updateSvgValue(this.node);this.node.setAttribute("font-size",Math.floor(this.size*this.scale)+"px");if(this.opacity!=null){this.node.setAttribute("fill-opacity",this.opacity/100);this.node.setAttribute("stroke-opacity",this.opacity/100)}var p=this.size*1.3*this.scale;var e=this.node.childNodes.length;if(this.backgroundNode!=null){e--}var n=this.bounds.x;var l=this.bounds.y;n+=(this.align==mxConstants.ALIGN_RIGHT)?((this.isRotate)?this.bounds.height:this.bounds.width)-this.spacingRight*this.scale:(this.align==mxConstants.ALIGN_CENTER)?this.spacingLeft+(((this.isRotate)?this.bounds.height:this.bounds.width)-this.spacingLeft-this.spacingRight)/2:this.spacingLeft*this.scale;var o=(this.valign==mxConstants.ALIGN_BOTTOM)?((this.isRotate)?this.bounds.width:this.bounds.height)-(e-1)*p-this.spacingBottom*this.scale-3:(this.valign==mxConstants.ALIGN_MIDDLE)?(this.spacingTop*this.scale+((this.isRotate)?this.bounds.width:this.bounds.height)-this.spacingBottom*this.scale-(e-1.5)*p)/2+1:this.spacingTop*this.scale+p-2;l+=o;this.node.setAttribute("x",n);this.node.setAttribute("y",l);if(this.isRotate){var d=this.bounds.x+this.bounds.width/2;var b=this.bounds.y+this.bounds.height/2;var j=(this.bounds.width-this.bounds.height)/2;var g=(this.bounds.height-this.bounds.width)/2;this.node.setAttribute("transform","rotate(-90 "+d+" "+b+") translate("+-g+" "+(-j)+")")}if(this.backgroundNode!=null&&this.backgroundNode.parentNode==this.node){this.node.removeChild(this.backgroundNode)}for(var f=0;f<e;f++){var a=this.node.childNodes[f];a.setAttribute("x",n);a.setAttribute("y",l);l+=p;a.setAttribute("style","pointer-events: all")}this.boundingBox=this.bounds.clone();if(this.value!=null&&this.value.length>0){try{var h=this.node.getBBox();this.boundingBox=new mxRectangle(Math.min(this.bounds.x,h.x-4*this.scale||0),Math.min(this.bounds.y,h.y-4*this.scale||0),Math.max(this.bounds.width,h.width+8*this.scale||0),Math.max(this.bounds.height,h.height+10*this.scale||0));if(this.backgroundNode!=null&&this.node.firstChild!=null){this.node.insertBefore(this.backgroundNode,this.node.firstChild);this.backgroundNode.setAttribute("x",h.x-4*this.scale||0);this.backgroundNode.setAttribute("y",h.y-4*this.scale||0);this.backgroundNode.setAttribute("width",h.width+8*this.scale||0);this.backgroundNode.setAttribute("height",h.height+8*this.scale||0);var m=Math.floor(Math.max(1,this.scale));this.backgroundNode.setAttribute("stroke-width",m)}}catch(k){}}};mxText.prototype.createSvgSpan=function(b){var a=document.createElementNS(mxConstants.NS_SVG,"text");mxUtils.write(a,b);return a};function mxTriangle(){}mxTriangle.prototype=new mxActor();mxTriangle.prototype.constructor=mxTriangle;mxTriangle.prototype.redrawPath=function(f,a,g,b,e){var d=this.style[mxConstants.STYLE_DIRECTION];if(d==mxConstants.DIRECTION_NORTH){f.moveTo(0,e);f.lineTo(0.5*b,0);f.lineTo(b,e)}else{if(d==mxConstants.DIRECTION_SOUTH){f.moveTo(0,0);f.lineTo(0.5*b,e);f.lineTo(b,0)}else{if(d==mxConstants.DIRECTION_WEST){f.moveTo(b,0);f.lineTo(0,0.5*e);f.lineTo(b,e)}else{f.moveTo(0,0);f.lineTo(b,0.5*e);f.lineTo(0,e)}}}f.close()};function mxHexagon(){}mxHexagon.prototype=new mxActor();mxHexagon.prototype.constructor=mxHexagon;mxHexagon.prototype.redrawPath=function(f,a,g,b,e){var d=this.style[mxConstants.STYLE_DIRECTION];if(d==mxConstants.DIRECTION_NORTH||d==mxConstants.DIRECTION_SOUTH){f.moveTo(0.5*b,0);f.lineTo(b,0.25*e);f.lineTo(b,0.75*e);f.lineTo(0.5*b,e);f.lineTo(0,0.75*e);f.lineTo(0,0.25*e)}else{f.moveTo(0.25*b,0);f.lineTo(0.75*b,0);f.lineTo(b,0.5*e);f.lineTo(0.75*b,e);f.lineTo(0.25*b,e);f.lineTo(0,0.5*e)}f.close()};function mxLine(b,d,a){this.bounds=b;this.stroke=d||"black";this.strokewidth=a||"1"}mxLine.prototype=new mxShape();mxLine.prototype.constructor=mxLine;mxLine.prototype.mixedModeHtml=false;mxLine.prototype.preferModeHtml=false;mxLine.prototype.clone=function(){var a=new mxLine(this.bounds,this.stroke,this.strokewidth);a.isDashed=this.isDashed;return a};mxLine.prototype.createVml=function(){var a=document.createElement("v:group");a.setAttribute("coordorigin","0,0");a.style.position="absolute";a.style.overflow="visible";this.label=document.createElement("v:rect");this.configureVmlShape(this.label);this.label.setAttribute("stroked","false");this.label.setAttribute("filled","false");a.appendChild(this.label);this.innerNode=document.createElement("v:polyline");this.configureVmlShape(this.innerNode);a.appendChild(this.innerNode);return a};mxLine.prototype.redrawVml=function(){var a=Math.floor(this.bounds.x);var f=Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width);var d=Math.floor(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",b+","+d);this.updateVmlShape(this.label);this.label.style.left="0px";this.label.style.top="0px";this.innerNode.setAttribute("strokeweight",this.strokewidth*this.scale);var e=this.style[mxConstants.STYLE_DIRECTION];if(e==mxConstants.DIRECTION_NORTH||e==mxConstants.DIRECTION_SOUTH){this.innerNode.points.value=(b/2)+",0 "+(b/2)+","+(d)}else{this.innerNode.points.value="0,"+(d/2)+" "+(b)+","+(d/2)}};mxLine.prototype.createSvg=function(){var b=this.createSvgGroup("path");var a=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",a);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};mxLine.prototype.redrawSvg=function(){var k=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",k);if(this.bounds!=null){var a=this.bounds.x;var j=this.bounds.y;var b=this.bounds.width;var e=this.bounds.height;var g=null;var f=this.style[mxConstants.STYLE_DIRECTION];if(f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH){g="M "+(a+b/2)+" "+j+" L "+(a+b/2)+" "+(j+e)}else{g="M "+a+" "+(j+e/2)+" L "+(a+b)+" "+(j+e/2)}this.innerNode.setAttribute("d",g);this.pipe.setAttribute("d",g);this.pipe.setAttribute("stroke-width",this.strokewidth*this.scale+mxShape.prototype.SVG_STROKE_TOLERANCE);this.updateSvgTransform(this.innerNode,false);this.updateSvgTransform(this.pipe,false)}};function mxImageShape(b,f,e,d,a){this.bounds=b;this.image=f;this.fill=e;this.stroke=d;this.strokewidth=a||0;this.isShadow=false}mxImageShape.prototype=new mxShape();mxImageShape.prototype.constructor=mxImageShape;mxImageShape.prototype.create=function(){var d=null;if(this.dialect==mxConstants.DIALECT_SVG){d=this.createSvgGroup("rect");this.innerNode.setAttribute("fill",this.fill);this.innerNode.setAttribute("visibility","hidden");this.innerNode.setAttribute("pointer-events","fill");this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.imageNode.setAttribute("style","pointer-events:none");this.configureSvgShape(this.imageNode);d.insertBefore(this.imageNode,this.innerNode)}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML){d=document.createElement("DIV");this.configureHtmlShape(d);var b=this.image.toUpperCase();if(b.substring(b.length-3,b.length)=="PNG"&&mxClient.IS_IE&&!mxClient.IS_IE7){d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+this.image+"', sizingMethod='scale')"}else{var a=document.createElement("img");a.setAttribute("src",this.image);a.style.width="100%";a.style.height="100%";a.setAttribute("border","0");d.appendChild(a)}}else{d=document.createElement("v:image");d.setAttribute("src",this.image);this.configureVmlShape(d)}}return d};mxImageShape.prototype.redrawSvg=function(){this.updateSvgShape(this.innerNode);this.updateSvgShape(this.imageNode)};function mxLabel(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxLabel.prototype=new mxShape();mxLabel.prototype.constructor=mxLabel;mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE;mxLabel.prototype.spacing=2;mxLabel.prototype.indicatorSize=10;mxLabel.prototype.indicatorSpacing=2;mxLabel.prototype.createHtml=function(){var a="DIV";var b=document.createElement(a);this.configureHtmlShape(b);if(this.indicatorColor!=null&&this.indicatorShape!=null){this.indicator=new this.indicatorShape(this.bounds);this.indicator.dialect=this.dialect;this.indicator.fill=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.init(b)}else{if(this.indicatorImage!=null){this.indicatorImageNode=mxUtils.createImage(this.indicatorImage);this.indicatorImageNode.style.position="absolute";b.appendChild(this.indicatorImageNode)}}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.stroke=null;this.configureHtmlShape(this.imageNode);b.appendChild(this.imageNode)}return b};mxLabel.prototype.createVml=function(){var b=document.createElement("v:group");var a=(this.isRounded)?"v:roundrect":"v:rect";this.rectNode=document.createElement(a);this.configureVmlShape(this.rectNode);this.isShadow=false;this.configureVmlShape(b);b.setAttribute("coordorigin","0,0");b.appendChild(this.rectNode);if(this.indicatorColor!=null&&this.indicatorShape!=null){this.indicator=new this.indicatorShape(this.bounds);this.indicator.dialect=this.dialect;this.indicator.fill=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.init(b)}else{if(this.indicatorImage!=null){this.indicatorImageNode=document.createElement("v:image");this.indicatorImageNode.setAttribute("src",this.indicatorImage);b.appendChild(this.indicatorImageNode)}}if(this.image!=null){this.imageNode=document.createElement("v:image");this.imageNode.setAttribute("src",this.image);this.configureVmlShape(this.imageNode);b.appendChild(this.imageNode)}this.label=document.createElement("v:rect");this.label.style.top="0px";this.label.style.left="0px";this.label.setAttribute("filled","false");this.label.setAttribute("stroked","false");b.appendChild(this.label);return b};mxLabel.prototype.createSvg=function(){var a=this.createSvgGroup("rect");if(this.strokewidth*this.scale>=1&&!this.isRounded){this.innerNode.setAttribute("shape-rendering","optimizeSpeed")}if(this.indicatorColor!=null&&this.indicatorShape!=null){this.indicator=new this.indicatorShape(this.bounds);this.indicator.dialect=this.dialect;this.indicator.fill=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.init(a)}else{if(this.indicatorImage!=null){this.indicatorImageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.indicatorImageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.indicatorImage);a.appendChild(this.indicatorImageNode)}}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.imageNode.setAttribute("style","pointer-events:none");this.configureSvgShape(this.imageNode);a.appendChild(this.imageNode)}return a};mxLabel.prototype.redraw=function(){var d=(this.dialect==mxConstants.DIALECT_SVG);var o=mxUtils.isVml(this.node);if(d){this.updateSvgShape(this.innerNode);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode)}}else{if(o){this.updateVmlShape(this.node);this.node.setAttribute("coordsize",this.bounds.width+","+this.bounds.height);this.updateVmlShape(this.rectNode);this.rectNode.style.top="0px";this.rectNode.style.left="0px";this.label.style.width=this.bounds.width+"px";this.label.style.height=this.bounds.height+"px"}else{this.updateHtmlShape(this.node)}}var h=0;var f=0;if(this.imageNode!=null){h=(this.style[mxConstants.STYLE_IMAGE_WIDTH]||this.imageSize)*this.scale;f=(this.style[mxConstants.STYLE_IMAGE_HEIGHT]||this.imageSize)*this.scale}var k=0;var e=0;var b=0;if(this.indicator!=null||this.indicatorImageNode!=null){k=(this.style[mxConstants.STYLE_INDICATOR_SPACING]||this.indicatorSpacing)*this.scale;e=(this.style[mxConstants.STYLE_INDICATOR_WIDTH]||this.indicatorSize)*this.scale;b=(this.style[mxConstants.STYLE_INDICATOR_HEIGHT]||this.indicatorSize)*this.scale}var g=this.style[mxConstants.STYLE_IMAGE_ALIGN];var m=this.style[mxConstants.STYLE_IMAGE_VERTICAL_ALIGN];var p=this.spacing*this.scale;var a=Math.max(h,e);var n=f+k+b;var l=(d)?this.bounds.x:0;if(g==mxConstants.ALIGN_RIGHT){l+=this.bounds.width-a-p}else{if(g==mxConstants.ALIGN_CENTER){l+=(this.bounds.width-a)/2}else{l+=p}}var j=(d)?this.bounds.y:0;if(m==mxConstants.ALIGN_BOTTOM){j+=this.bounds.height-n-p}else{if(m==mxConstants.ALIGN_TOP){j+=p}else{j+=(this.bounds.height-n)/2}}if(this.imageNode!=null){if(d){this.imageNode.setAttribute("x",(l+(a-h)/2)+"px");this.imageNode.setAttribute("y",j+"px");this.imageNode.setAttribute("width",h+"px");this.imageNode.setAttribute("height",f+"px")}else{this.imageNode.style.left=(l+a-h)+"px";this.imageNode.style.top=j+"px";this.imageNode.style.width=h+"px";this.imageNode.style.height=f+"px"}}if(this.indicator!=null){this.indicator.bounds=new mxRectangle(l+(a-e)/2,j+f+k,e,b);this.indicator.redraw()}else{if(this.indicatorImageNode!=null){if(d){this.indicatorImageNode.setAttribute("x",(l+(a-e)/2)+"px");this.indicatorImageNode.setAttribute("y",(j+f+k)+"px");this.indicatorImageNode.setAttribute("width",e+"px");this.indicatorImageNode.setAttribute("height",b+"px")}else{this.indicatorImageNode.style.left=(l+(a-e)/2)+"px";this.indicatorImageNode.style.top=(j+f+k)+"px";this.indicatorImageNode.style.width=e+"px";this.indicatorImageNode.style.height=b+"px"}}}};function mxCylinder(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxCylinder.prototype=new mxShape();mxCylinder.prototype.constructor=mxCylinder;mxCylinder.prototype.mixedModeHtml=false;mxCylinder.prototype.preferModeHtml=false;mxCylinder.prototype.maxHeight=40;mxCylinder.prototype.create=function(a){if(this.stroke==null){this.stroke=this.fill}return mxShape.prototype.create.apply(this,arguments)};mxCylinder.prototype.createVml=function(){var a=document.createElement("v:group");this.background=document.createElement("v:shape");this.label=this.background;this.configureVmlShape(this.background);a.appendChild(this.background);this.fill=null;this.isShadow=false;this.configureVmlShape(a);this.foreground=document.createElement("v:shape");this.configureVmlShape(this.foreground);a.appendChild(this.foreground);return a};mxCylinder.prototype.redrawVml=function(){var a=Math.floor(this.bounds.x);var j=Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width);var f=Math.floor(this.bounds.height);var e=this.strokewidth*this.scale;this.node.setAttribute("coordsize",b+","+f);this.background.setAttribute("coordsize",b+","+f);this.foreground.setAttribute("coordsize",b+","+f);this.updateVmlShape(this.node);this.updateVmlShape(this.background);this.background.style.top="0px";this.background.style.left="0px";this.background.style.rotation=null;this.updateVmlShape(this.foreground);this.foreground.style.top="0px";this.foreground.style.left="0px";this.foreground.style.rotation=null;this.background.setAttribute("strokeweight",e);this.foreground.setAttribute("strokeweight",e);var g=this.createPath(false);this.background.setAttribute("path",g);var g=this.createPath(true);this.foreground.setAttribute("path",g)};mxCylinder.prototype.createSvg=function(){var a=this.createSvgGroup("path");this.foreground=document.createElementNS(mxConstants.NS_SVG,"path");if(this.stroke!=null){this.foreground.setAttribute("stroke",this.stroke)}else{this.foreground.setAttribute("stroke","none")}this.foreground.setAttribute("fill","none");a.appendChild(this.foreground);return a};mxCylinder.prototype.redrawSvg=function(){var b=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",b);var a=this.createPath(false);this.innerNode.setAttribute("d",a);this.updateSvgTransform(this.innerNode,false);if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",b);this.shadowNode.setAttribute("d",a);this.updateSvgTransform(this.shadowNode,true)}a=this.createPath(true);this.foreground.setAttribute("stroke-width",b);this.foreground.setAttribute("d",a);this.updateSvgTransform(this.foreground,false)};mxCylinder.prototype.redrawPath=function(g,a,j,d,f,e){var b=Math.min(this.maxHeight,Math.floor(f/5));if(e){g.moveTo(0,b);g.curveTo(0,2*b,d,2*b,d,b)}else{g.moveTo(0,b);g.curveTo(0,-b/3,d,-b/3,d,b);g.lineTo(d,f-b);g.curveTo(d,f+b/3,0,f+b/3,0,(f-b));g.close()}};function mxConnector(b,d,a){this.points=b;this.stroke=d||"black";this.strokewidth=a||1}mxConnector.prototype=new mxShape();mxConnector.prototype.constructor=mxConnector;mxConnector.prototype.mixedModeHtml=false;mxConnector.prototype.preferModeHtml=false;mxConnector.prototype.createHtml=function(){var a=document.createElement("DIV");this.configureHtmlShape(a);a.style.borderStyle="none";a.style.background="";return a};mxConnector.prototype.createVml=function(){var a=document.createElement("v:shape");this.strokeNode=document.createElement("v:stroke");this.configureVmlShape(a);this.strokeNode.setAttribute("endarrow",this.endArrow);this.strokeNode.setAttribute("startarrow",this.startArrow);if(this.opacity!=null){this.strokeNode.setAttribute("opacity",this.opacity+"%")}a.appendChild(this.strokeNode);return a};mxConnector.prototype.redrawVml=function(){if(this.node!=null&&this.strokeNode!=null){var d=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale;var g=mxUtils.getValue(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale;var b="medium";var e="medium";var f="medium";var a="medium";if(d<6){b="narrow";e="short"}else{if(d>10){b="wide";e="long"}}if(g<6){f="narrow";a="short"}else{if(g>10){f="wide";a="long"}}this.strokeNode.setAttribute("startarrowwidth",b);this.strokeNode.setAttribute("startarrowlength",e);this.strokeNode.setAttribute("endarrowwidth",f);this.strokeNode.setAttribute("endarrowlength",a);this.updateVmlShape(this.node)}};mxConnector.prototype.createSvg=function(){var b=this.createSvgGroup("path");var a=this.innerNode.getAttribute("stroke");if(this.startArrow!=null){this.start=document.createElementNS(mxConstants.NS_SVG,"path");b.appendChild(this.start)}if(this.endArrow!=null){this.end=document.createElementNS(mxConstants.NS_SVG,"path");b.appendChild(this.end)}this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",a);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};mxConnector.prototype.redrawSvg=function(){mxShape.prototype.redrawSvg.apply(this,arguments);var g=this.strokewidth*this.scale;var b=this.innerNode.getAttribute("stroke");if(mxConstants.SVG_CRISP_EDGES&&g==Math.floor(g)&&!this.isRounded){this.node.setAttribute("shape-rendering","optimizeSpeed")}else{this.node.setAttribute("shape-rendering","default")}if(this.points!=null&&this.points[0]!=null){if(this.start!=null){var f=this.points[1];var a=this.points[0];var d=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE);this.startOffset=this.redrawSvgMarker(this.start,this.startArrow,f,a,b,d)}if(this.end!=null){var e=this.points.length;var f=this.points[e-2];var a=this.points[e-1];var d=mxUtils.getValue(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);this.endOffset=this.redrawSvgMarker(this.end,this.endArrow,f,a,b,d)}}this.updateSvgShape(this.innerNode);this.pipe.setAttribute("d",this.innerNode.getAttribute("d"));this.pipe.setAttribute("stroke-width",g+mxShape.prototype.SVG_STROKE_TOLERANCE);this.innerNode.setAttribute("fill","none")};mxConnector.prototype.redrawSvgMarker=function(b,m,o,k,e,p){var f=null;var q=k.x-o.x;var n=k.y-o.y;var l=Math.max(1,Math.sqrt(q*q+n*n));var a=p*this.scale;var h=q*a/l;var g=n*a/l;k=k.clone();k.x-=h*this.strokewidth/(2*p);k.y-=g*this.strokewidth/(2*p);h*=0.5+this.strokewidth/2;g*=0.5+this.strokewidth/2;if(m=="classic"||m=="block"){var j="M "+k.x+" "+k.y+" L "+(k.x-h-g/2)+" "+(k.y-g+h/2)+((m!="classic")?"":" L "+(k.x-h*3/4)+" "+(k.y-g*3/4))+" L "+(k.x+g/2-h)+" "+(k.y-g-h/2)+" z";b.setAttribute("d",j);f=new mxPoint(-h*3/4,-g*3/4)}else{if(m=="open"){h*=1.2;g*=1.2;var j="M "+(k.x-h-g/2)+" "+(k.y-g+h/2)+" L "+(k.x-h/6)+" "+(k.y-g/6)+" L "+(k.x+g/2-h)+" "+(k.y-g-h/2)+" M "+k.x+" "+k.y;b.setAttribute("d",j);b.setAttribute("fill","none");b.setAttribute("stroke-width",this.scale*this.strokewidth);f=new mxPoint(-h/4,-g/4)}else{if(m=="oval"){h*=1.2;g*=1.2;a*=1.2;var j="M "+(k.x-g/2)+" "+(k.y+h/2)+" a "+(a/2)+" "+(a/2)+" 0  1,1 "+(h/8)+" "+(g/8)+" z";b.setAttribute("d",j)}else{if(m=="diamond"){var j="M "+(k.x+h/2)+" "+(k.y+g/2)+" L "+(k.x-g/2)+" "+(k.y+h/2)+" L "+(k.x-h/2)+" "+(k.y-g/2)+" L "+(k.x+g/2)+" "+(k.y-h/2)+" z";b.setAttribute("d",j)}}}}b.setAttribute("stroke",e);if(m!="open"){b.setAttribute("fill",e)}else{b.setAttribute("stroke-linecap","round")}if(this.opacity!=null){b.setAttribute("fill-opacity",this.opacity/100);b.setAttribute("stroke-opacity",this.opacity/100)}return f};function mxSwimlane(b,e,d,a){this.bounds=b;this.fill=e;this.stroke=d;this.strokewidth=a||1}mxSwimlane.prototype=new mxShape();mxSwimlane.prototype.constructor=mxSwimlane;mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.defaultStartSize=40;mxSwimlane.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;mxSwimlane.prototype.createHtml=function(){var d=document.createElement("DIV");this.configureHtmlShape(d);d.style.background="";d.style.backgroundColor="";d.style.borderStyle="none";this.label=document.createElement("DIV");this.configureHtmlShape(this.label);d.appendChild(this.label);this.content=document.createElement("DIV");var b=this.fill;this.configureHtmlShape(this.content);this.content.style.background="";this.content.style.backgroundColor="";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.content.style.borderTopStyle="none"}else{this.content.style.borderLeftStyle="none"}this.content.style.cursor="default";d.appendChild(this.content);var a=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(a!=null){this.separator=document.createElement("DIV");this.separator.style.borderColor=a;this.separator.style.borderLeftStyle="dashed";d.appendChild(this.separator)}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.configureHtmlShape(this.imageNode);this.imageNode.style.borderStyle="none";d.appendChild(this.imageNode)}return d};mxSwimlane.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);this.startSize=parseInt(this.style[mxConstants.STYLE_STARTSIZE])||this.defaultStartSize;this.updateHtmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.startSize=Math.min(this.startSize,this.bounds.height);this.label.style.height=(this.startSize*this.scale)+"px";this.updateHtmlShape(this.content);var b=this.startSize*this.scale;this.content.style.top=b+"px";this.content.style.left="0px";this.content.style.height=Math.max(1,this.bounds.height-b)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.bounds.width)+"px";this.separator.style.top=Math.floor(this.startSize*this.scale)+"px";this.separator.style.width="1px";this.separator.style.height=Math.floor(this.bounds.height)+"px";this.separator.style.borderWidth=Math.floor(this.scale)+"px"}if(this.imageNode!=null){this.imageNode.style.left=(this.bounds.width-this.imageSize-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=Math.floor(this.imageSize*this.scale)+"px";this.imageNode.style.height=Math.floor(this.imageSize*this.scale)+"px"}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.label.style.width=(this.startSize*this.scale)+"px";this.updateHtmlShape(this.content);var a=this.startSize*this.scale;this.content.style.top="0px";this.content.style.left=a+"px";this.content.style.width=Math.max(0,this.bounds.width-a)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.startSize*this.scale)+"px";this.separator.style.top=Math.floor(this.bounds.height)+"px";this.separator.style.width=Math.floor(this.bounds.width)+"px";this.separator.style.height="1px"}if(this.imageNode!=null){this.imageNode.style.left=(this.bounds.width-this.imageSize-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=this.imageSize*this.scale+"px";this.imageNode.style.height=this.imageSize*this.scale+"px"}}};mxSwimlane.prototype.createVml=function(){var e=document.createElement("v:group");var b=(this.isRounded)?"v:roundrect":"v:rect";this.label=document.createElement(b);this.configureVmlShape(this.label);if(this.isRounded){this.label.setAttribute("arcsize","20%")}this.isShadow=false;this.configureVmlShape(e);e.setAttribute("coordorigin","0,0");e.appendChild(this.label);this.content=document.createElement(b);var d=this.fill;this.fill=null;this.configureVmlShape(this.content);if(this.isRounded){this.content.setAttribute("arcsize","4%")}this.fill=d;this.content.style.borderBottom="0px";e.appendChild(this.content);var a=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(a!=null){this.separator=document.createElement("v:polyline");this.separator.setAttribute("strokecolor",a);var f=document.createElement("v:stroke");f.setAttribute("dashstyle","2 2");this.separator.appendChild(f);e.appendChild(this.separator)}if(this.image!=null){this.imageNode=document.createElement("v:image");this.imageNode.setAttribute("src",this.image);this.configureVmlShape(this.imageNode);e.appendChild(this.imageNode)}return e};mxSwimlane.prototype.redrawVml=function(){var a=Math.floor(this.bounds.x);var g=Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width);var e=Math.floor(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",b+","+e);this.updateVmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";this.label.style.rotation=null;this.startSize=parseInt(this.style[mxConstants.STYLE_STARTSIZE])||this.defaultStartSize;var f=Math.floor(this.startSize*this.scale);if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){f=Math.min(f,this.bounds.height);this.label.style.height=f+"px";this.updateVmlShape(this.content);this.content.style.top=f+"px";this.content.style.left="0px";this.content.style.height=Math.max(0,e-f)+"px";if(this.separator!=null){this.separator.points.value=b+","+f+" "+b+","+e}if(this.imageNode!=null){var d=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=(b-d-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=d+"px";this.imageNode.style.height=d+"px"}}else{f=Math.min(f,this.bounds.width);this.label.style.width=f+"px";this.updateVmlShape(this.content);this.content.style.top="0px";this.content.style.left=f+"px";this.content.style.width=Math.max(0,b-f)+"px";if(this.separator!=null){this.separator.points.value="0,"+e+" "+(b+f)+","+e}if(this.imageNode!=null){var d=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=(b-d-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=d+"px";this.imageNode.style.height=d+"px"}}this.content.style.rotation=null};mxSwimlane.prototype.createSvg=function(){var b=this.createSvgGroup("rect");if(this.strokewidth*this.scale>=1&&!this.isRounded){this.innerNode.setAttribute("shape-rendering","optimizeSpeed")}if(this.isRounded){this.innerNode.setAttribute("rx",10);this.innerNode.setAttribute("ry",10)}this.content=document.createElementNS(mxConstants.NS_SVG,"path");this.configureSvgShape(this.content);this.content.setAttribute("fill","none");if(this.strokewidth*this.scale>=1&&!this.isRounded){this.content.setAttribute("shape-rendering","optimizeSpeed")}if(this.isRounded){this.content.setAttribute("rx",10);this.content.setAttribute("ry",10)}b.appendChild(this.content);var a=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(a!=null){this.separator=document.createElementNS(mxConstants.NS_SVG,"line");this.separator.setAttribute("stroke",a);this.separator.setAttribute("fill","none");this.separator.setAttribute("stroke-dasharray","2, 2");this.separator.setAttribute("shape-rendering","optimizeSpeed");b.appendChild(this.separator)}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.configureSvgShape(this.imageNode);b.appendChild(this.imageNode)}return b};mxSwimlane.prototype.redrawSvg=function(){var b=this.isRounded;this.isRounded=false;this.updateSvgShape(this.innerNode);this.updateSvgShape(this.content);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);if(this.style[mxConstants.STYLE_HORIZONTAL]){this.shadowNode.setAttribute("width",this.startSize*this.scale)}else{this.shadowNode.setAttribute("height",this.startSize*this.scale)}}this.isRounded=b;this.startSize=parseInt(this.style[mxConstants.STYLE_STARTSIZE])||this.defaultStartSize;if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.startSize=Math.min(this.startSize,this.bounds.height);this.innerNode.setAttribute("height",this.startSize*this.scale);var e=this.startSize*this.scale;var d="M "+this.bounds.x+" "+(this.bounds.y+e)+" l 0 "+(this.bounds.height-e)+" l "+this.bounds.width+" 0 l 0 "+(-this.bounds.height+e);this.content.setAttribute("d",d);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=null){this.separator.setAttribute("x1",this.bounds.x+this.bounds.width);this.separator.setAttribute("y1",this.bounds.y+this.startSize*this.scale);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",this.bounds.y+this.bounds.height)}if(this.imageNode!=null){this.imageNode.setAttribute("x",this.bounds.x+this.bounds.width-this.imageSize-4);this.imageNode.setAttribute("y",this.bounds.y);this.imageNode.setAttribute("width",this.imageSize*this.scale+"px");this.imageNode.setAttribute("height",this.imageSize*this.scale+"px")}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.innerNode.setAttribute("width",this.startSize*this.scale);var a=this.startSize*this.scale;var d="M "+(this.bounds.x+a)+" "+this.bounds.y+" l "+(this.bounds.width-a)+" 0 l 0 "+this.bounds.height+" l "+(-this.bounds.width+a)+" 0";this.content.setAttribute("d",d);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=null){this.separator.setAttribute("x1",this.bounds.x+this.startSize*this.scale);this.separator.setAttribute("y1",this.bounds.y+this.bounds.height);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",this.bounds.y+this.bounds.height)}if(this.imageNode!=null){this.imageNode.setAttribute("x",this.bounds.x+this.bounds.width-this.imageSize-4);this.imageNode.setAttribute("y",this.bounds.y);this.imageNode.setAttribute("width",this.imageSize*this.scale+"px");this.imageNode.setAttribute("height",this.imageSize*this.scale+"px")}}};function mxGraphLayout(a){this.graph=a}mxGraphLayout.prototype.graph=null;mxGraphLayout.prototype.useBoundingBox=true;mxGraphLayout.prototype.move=function(b,a,d){};mxGraphLayout.prototype.execute=function(a){};mxGraphLayout.prototype.getGraph=function(){return this.graph};mxGraphLayout.prototype.isVertexMovable=function(a){return this.graph.isMovable(a)};mxGraphLayout.prototype.isVertexIgnored=function(a){return !this.graph.getModel().isVertex(a)||!this.graph.isCellVisible(a)};mxGraphLayout.prototype.isEdgeIgnored=function(b){var a=this.graph.getModel();return !a.isEdge(b)||!this.graph.isCellVisible(b)||a.getTerminal(b,true)==null||a.getTerminal(b,false)==null};mxGraphLayout.prototype.setVertexLocation=function(j,h,f){var e=this.graph.getModel();var g=e.getGeometry(j);var k=null;if(g!=null){k=new mxRectangle(h,f,g.width,g.height);if(this.useBoundingBox){var a=this.graph.getView().getState(j);if(a!=null&&a.text!=null&&a.text.boundingBox!=null&&a.text.boundingBox.x<a.x){var b=this.graph.getView().scale;var d=a.text.boundingBox;h+=(a.x-d.x)/b;k.width=d.width}}if(g.x!=h||g.y!=f){g=g.clone();g.x=h;g.y=f;e.setGeometry(j,g)}}return k};mxGraphLayout.prototype.setEdgePoints=function(d,b){if(d!=null){var a=this.graph.model;var e=a.getGeometry(d);if(e==null){e=new mxGeometry();e.setRelative(true)}else{e=e.clone()}e.points=b;a.setGeometry(d,e)}};mxGraphLayout.prototype.getVertexBounds=function(j){var d=this.graph.getModel().getGeometry(j);if(this.useBoundingBox){var a=this.graph.getView().getState(j);if(a!=null&&a.text!=null&&a.text.boundingBox!=null){var b=this.graph.getView().scale;var e=a.text.boundingBox;var k=(e.x-a.x)/b;var g=(e.y-a.y)/b;var h=(e.x+e.width-a.x-a.width)/b;var f=(e.y+e.height-a.y-a.height)/b;d=new mxRectangle(d.x+k,d.y+g,d.width-k+h,d.height-g+f)}}return new mxRectangle(d.x,d.y,d.width,d.height)};function mxStackLayout(e,a,f,b,d){mxGraphLayout.call(this,e);this.horizontal=(a!=null)?a:true;this.spacing=(f!=null)?f:e.gridSize;this.x0=(b!=null)?b:this.spacing;this.y0=(d!=null)?d:this.spacing}mxStackLayout.prototype=new mxGraphLayout();mxStackLayout.prototype.constructor=mxStackLayout;mxStackLayout.prototype.horizontal=null;mxStackLayout.prototype.spacing=null;mxStackLayout.prototype.x0=null;mxStackLayout.prototype.y0=null;mxStackLayout.prototype.fill=false;mxStackLayout.prototype.resizeParent=false;mxStackLayout.prototype.wrap=null;mxStackLayout.prototype.move=function(p,k,j){var h=this.graph.getModel();var n=h.getParent(p);if(p!=null&&n!=null){var g=0;var o=0;var d=h.getChildCount(n);var m=(this.horizontal)?k:j;var f=this.graph.getView().getState(n);if(f!=null){m-=(this.horizontal)?f.x:f.y}for(g=0;g<d;g++){var b=h.getChildAt(n,g);if(b!=p){var a=h.getGeometry(b);if(a!=null){var e=(this.horizontal)?a.x+a.width/2:a.y+a.height/2;if(o<m&&e>m){break}o=e}}}var l=n.getIndex(p);l=Math.max(0,g-((g>l)?1:0));h.add(n,p,l)}};mxStackLayout.prototype.execute=function(n){if(n!=null){var d=this.x0+1;var m=this.y0;var k=this.graph.getModel();var e=k.getGeometry(n);if(this.graph.container!=null&&((e==null&&k.isLayer(n))||n==this.graph.getView().currentRoot)){var a=this.graph.container.offsetWidth;var p=this.graph.container.offsetHeight;e=new mxRectangle(0,0,a,p)}var l=0;if(e!=null){l=(this.horizontal)?e.height:e.width}l-=2*this.spacing;var q=this.graph.getStartSize(n);l-=(this.horizontal)?q.height:q.width;d=this.x0+q.width;m=this.y0+q.height;k.beginUpdate();try{var j=0;var o=null;var f=k.getChildCount(n);for(var h=0;h<f;h++){var b=k.getChildAt(n,h);if(!this.isVertexIgnored(b)&&this.isVertexMovable(b)){var g=k.getGeometry(b);if(g!=null){g=g.clone();if(this.wrap!=null&&o!=null){if((this.horizontal&&o.x+o.width+g.width+2*this.spacing>this.wrap)||(!this.horizontal&&o.y+o.height+g.height+2*this.spacing>this.wrap)){o=null;if(this.horizontal){m+=j+this.spacing}else{d+=j+this.spacing}j=0}}j=Math.max(j,(this.horizontal)?g.height:g.width);if(o!=null){if(this.horizontal){g.x=o.x+o.width+this.spacing}else{g.y=o.y+o.height+this.spacing}}else{if(this.horizontal){g.x=d}else{g.y=m}}if(this.horizontal){g.y=m}else{g.x=d}if(this.fill&&l>0){if(this.horizontal){g.height=l}else{g.width=l}}k.setGeometry(b,g);o=g}}}if(this.resizeParent&&e!=null&&o!=null&&!this.graph.isCellCollapsed(n)){e=e.clone();if(this.horizontal){e.width=o.x+o.width+this.spacing}else{e.height=o.y+o.height+this.spacing}k.setGeometry(n,e)}}finally{k.endUpdate()}}};function mxPartitionLayout(d,a,e,b){mxGraphLayout.call(this,d);this.horizontal=(a!=null)?a:true;this.spacing=e||0;this.border=b||0}mxPartitionLayout.prototype=new mxGraphLayout();mxPartitionLayout.prototype.constructor=mxPartitionLayout;mxPartitionLayout.prototype.horizontal=null;mxPartitionLayout.prototype.spacing=null;mxPartitionLayout.prototype.border=null;mxPartitionLayout.prototype.resizeVertices=true;mxPartitionLayout.prototype.move=function(n,j,h){var g=this.graph.getModel();var l=g.getParent(n);if(n!=null&&l!=null){var f=0;var m=0;var d=g.getChildCount(l);for(f=0;f<d;f++){var b=g.getChildAt(l,f);var a=this.getVertexBounds(b);if(a!=null){var e=a.x+a.width/2;if(m<j&&e>j){break}m=e}}var k=l.getIndex(n);k=Math.max(0,f-((f>k)?1:0));g.add(l,n,k)}};mxPartitionLayout.prototype.execute=function(r){var m=this.graph.getModel();var g=m.getGeometry(r);if(this.graph.container!=null&&((g==null&&m.isLayer(r))||r==this.graph.getView().currentRoot)){var a=this.graph.container.offsetWidth;var s=this.graph.container.offsetHeight;g=new mxRectangle(0,0,a,s)}if(g!=null){var e=new Array();var h=m.getChildCount(r);for(var l=0;l<h;l++){var d=m.getChildAt(r,l);if(!this.isVertexIgnored(d)&&this.isVertexMovable(d)){e.push(d)}}var f=e.length;if(f>0){var b=this.border;var q=this.border;var o=(this.horizontal)?g.height:g.width;o-=2*this.border;var t=this.graph.getStartSize(r);o-=(this.horizontal)?t.height:t.width;b=b+t.width;q=q+t.height;var k=this.border+(f-1)*this.spacing;var p=(this.horizontal)?((g.width-b-k)/f):((g.height-q-k)/f);if(p>0){m.beginUpdate();try{for(var l=0;l<f;l++){var d=e[l];var j=m.getGeometry(d);if(j!=null){j=j.clone();j.x=b;j.y=q;if(this.horizontal){if(this.resizeVertices){j.width=p;j.height=o}b+=p+this.spacing}else{if(this.resizeVertices){j.height=p;j.width=o}q+=p+this.spacing}m.setGeometry(d,j)}}}finally{m.endUpdate()}}}}};function mxCompactTreeLayout(b,a,d){mxGraphLayout.call(this,b);this.horizontal=(a!=null)?a:true;this.invert=(d!=null)?d:false}mxCompactTreeLayout.prototype=new mxGraphLayout();mxCompactTreeLayout.prototype.constructor=mxCompactTreeLayout;mxCompactTreeLayout.prototype.horizontal=null;mxCompactTreeLayout.prototype.invert=null;mxCompactTreeLayout.prototype.resizeParent=true;mxCompactTreeLayout.prototype.moveTree=true;mxCompactTreeLayout.prototype.levelDistance=10;mxCompactTreeLayout.prototype.nodeDistance=20;mxCompactTreeLayout.prototype.resetEdges=true;mxCompactTreeLayout.prototype.isVertexIgnored=function(a){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(a).length==0};mxCompactTreeLayout.prototype.execute=function(m,k){var h=this.graph.getModel();if(k==null){if(this.graph.getEdges(m,h.getParent(m),this.invert,!this.invert,false).length>0){k=m}else{var o=this.graph.findTreeRoots(m,true,this.invert);if(o.length>0){for(var f=0;f<o.length;f++){if(!this.isVertexIgnored(o[f])&&this.graph.getEdges(o[f],null,this.invert,!this.invert,false).length>0){k=o[f];break}}}}}if(k!=null){m=h.getParent(k);h.beginUpdate();try{var e=this.dfs(k,m);if(e!=null){this.layout(e);var d=this.graph.gridSize;var l=d;if(!this.moveTree||h.isLayer(m)){var j=h.getGeometry(k);if(j!=null){d=j.x;l=j.y}}var a=null;if(this.horizontal){a=this.horizontalLayout(e,d,l)}else{a=this.verticalLayout(e,null,d,l)}if(a!=null){var r=0;var p=0;if(a.x<0){r=Math.abs(d-a.x)}if(a.y<0){p=Math.abs(l-a.y)}if(m!=null){var q=this.graph.getStartSize(m);r+=q.width;p+=q.height;if(this.resizeParent&&!this.graph.isCellCollapsed(m)){var j=h.getGeometry(m);if(j!=null){var b=a.width+q.width-a.x+2*d;var n=a.height+q.height-a.y+2*l;j=j.clone();if(j.width>b){r+=(j.width-b)/2}else{j.width=b}if(j.height>n){if(this.horizontal){p+=(j.height-n)/2}}else{j.height=n}h.setGeometry(m,j)}}}this.moveNode(e,r,p)}}}finally{h.endUpdate()}}};mxCompactTreeLayout.prototype.moveNode=function(d,b,a){d.x+=b;d.y+=a;this.apply(d);var e=d.child;while(e!=null){this.moveNode(e,b,a);e=e.next}};mxCompactTreeLayout.prototype.dfs=function(n,m,l){l=l||new Array();var a=mxCellPath.create(n);var d=null;if(n!=null&&l[a]==null&&!this.isVertexIgnored(n)){l[a]=n;d=this.createNode(n);var j=this.graph.getModel();var e=null;var f=this.graph.getEdges(n,m,this.invert,!this.invert,false);for(var h=0;h<f.length;h++){var b=f[h];if(!this.isEdgeIgnored(b)){if(this.resetEdges){this.setEdgePoints(b,null)}var k=this.graph.getView().getVisibleTerminal(b,this.invert);var g=this.dfs(k,m,l);if(g!=null&&j.getGeometry(k)!=null){if(e==null){d.child=g}else{e.next=g}e=g}}}}return d};mxCompactTreeLayout.prototype.layout=function(a){if(a!=null){var b=a.child;while(b!=null){this.layout(b);b=b.next}if(a.child!=null){this.attachParent(a,this.join(a))}else{this.layoutLeaf(a)}}};mxCompactTreeLayout.prototype.horizontalLayout=function(g,b,f,e){g.x+=b+g.offsetX;g.y+=f+g.offsetY;e=this.apply(g,e);var h=g.child;if(h!=null){e=this.horizontalLayout(h,g.x,g.y,e);var a=g.y+h.offsetY;var d=h.next;while(d!=null){e=this.horizontalLayout(d,g.x+h.offsetX,a,e);a+=d.offsetY;d=d.next}}return e};mxCompactTreeLayout.prototype.verticalLayout=function(h,e,b,g,f){h.x+=b+h.offsetY;h.y+=g+h.offsetX;f=this.apply(h,f);var j=h.child;if(j!=null){f=this.verticalLayout(j,h,h.x,h.y,f);var a=h.x+j.offsetY;var d=j.next;while(d!=null){f=this.verticalLayout(d,h,a,h.y+j.offsetX,f);a+=d.offsetY;d=d.next}}return f};mxCompactTreeLayout.prototype.attachParent=function(f,b){var a=this.nodeDistance+this.levelDistance;var d=(b-f.width)/2-this.nodeDistance;var e=d+f.width+2*this.nodeDistance-b;f.child.offsetX=a+f.height;f.child.offsetY=e;f.contour.upperHead=this.createLine(f.height,0,this.createLine(a,e,f.contour.upperHead));f.contour.lowerHead=this.createLine(f.height,0,this.createLine(a,d,f.contour.lowerHead))};mxCompactTreeLayout.prototype.layoutLeaf=function(a){var b=2*this.nodeDistance;a.contour.upperTail=this.createLine(a.height+b,0);a.contour.upperHead=a.contour.upperTail;a.contour.lowerTail=this.createLine(0,-a.width-b);a.contour.lowerHead=this.createLine(a.height+b,0,a.contour.lowerTail)};mxCompactTreeLayout.prototype.join=function(e){var g=2*this.nodeDistance;var j=e.child;e.contour=j.contour;var b=j.width+g;var a=b;j=j.next;while(j!=null){var f=this.merge(e.contour,j.contour);j.offsetY=f+b;j.offsetX=0;b=j.width+g;a+=f+b;j=j.next}return a};mxCompactTreeLayout.prototype.merge=function(m,k){var j=0;var g=0;var h=0;var l=m.lowerHead;var a=k.upperHead;while(a!=null&&l!=null){var e=this.offset(j,g,a.dx,a.dy,l.dx,l.dy);g+=e;h+=e;if(j+a.dx<=l.dx){j+=a.dx;g+=a.dy;a=a.next}else{j-=l.dx;g-=l.dy;l=l.next}}if(a!=null){var f=this.bridge(m.upperTail,0,0,a,j,g);m.upperTail=(f.next!=null)?k.upperTail:f;m.lowerTail=k.lowerTail}else{var f=this.bridge(k.lowerTail,j,g,l,0,0);if(f.next==null){m.lowerTail=f}}m.lowerHead=k.lowerHead;return h};mxCompactTreeLayout.prototype.offset=function(j,h,b,a,g,f){var e=0;if(g<=j||j+b<=0){return 0}var k=g*a-b*f;if(k>0){if(j<0){var l=j*a;e=l/b-h}else{if(j>0){var l=j*f;e=l/g-h}else{e=-h}}}else{if(g<j+b){var l=(g-j)*a;e=f-(h+l/b)}else{if(g>j+b){var l=(b+j)*f;e=l/g-(h+a)}else{e=f-(h+a)}}}if(e>0){return e}else{return 0}};mxCompactTreeLayout.prototype.bridge=function(h,d,f,g,b,e){var l=b+g.dx-d;var j=0;var k=0;if(g.dx==0){j=g.dy}else{var k=l*g.dy;j=k/g.dx}var a=this.createLine(l,j,g.next);h.next=this.createLine(0,e+g.dy-j-f,a);return a};mxCompactTreeLayout.prototype.createNode=function(a){var b=new Object();b.cell=a;b.x=0;b.y=0;b.width=0;b.height=0;var d=this.getVertexBounds(a);if(d!=null){if(this.horizontal){b.width=d.height;b.height=d.width}else{b.width=d.width;b.height=d.height}}b.offsetX=0;b.offsetY=0;b.contour=new Object();return b};mxCompactTreeLayout.prototype.apply=function(d,b){var a=this.graph.getModel().getGeometry(d.cell);if(d.cell!=null&&a!=null){if(this.isVertexMovable(d.cell)){a=this.setVertexLocation(d.cell,d.x,d.y)}if(b==null){b=new mxRectangle(a.x,a.y,a.width,a.height)}else{b=new mxRectangle(Math.min(b.x,a.x),Math.min(b.y,a.y),Math.max(b.x+b.width,a.x+a.width),Math.max(b.y+b.height,a.y+a.height))}}return b};mxCompactTreeLayout.prototype.createLine=function(d,b,e){var a=new Object();a.dx=d;a.dy=b;a.next=e;return a};function mxFastOrganicLayout(a){mxGraphLayout.call(this,a)}mxFastOrganicLayout.prototype=new mxGraphLayout();mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout;mxFastOrganicLayout.prototype.useInputOrigin=true;mxFastOrganicLayout.prototype.resetEdges=true;mxFastOrganicLayout.prototype.forceConstant=50;mxFastOrganicLayout.prototype.forceConstantSquared=0;mxFastOrganicLayout.prototype.minDistanceLimit=2;mxFastOrganicLayout.prototype.minDistanceLimitSquared=4;mxFastOrganicLayout.prototype.initialTemp=200;mxFastOrganicLayout.prototype.temperature=0;mxFastOrganicLayout.prototype.maxIterations=0;mxFastOrganicLayout.prototype.iteration=0;mxFastOrganicLayout.prototype.vertexArray;mxFastOrganicLayout.prototype.dispX;mxFastOrganicLayout.prototype.dispY;mxFastOrganicLayout.prototype.cellLocation;mxFastOrganicLayout.prototype.radius;mxFastOrganicLayout.prototype.radiusSquared;mxFastOrganicLayout.prototype.isMoveable;mxFastOrganicLayout.prototype.neighbours;mxFastOrganicLayout.prototype.indices;mxFastOrganicLayout.prototype.allowedToRun=true;mxFastOrganicLayout.prototype.isVertexIgnored=function(a){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(a).length==0};mxFastOrganicLayout.prototype.execute=function(l){var e=this.graph.getModel();this.vertexArray=new Array();var d=this.graph.getChildVertices(l);for(var w=0;w<d.length;w++){if(!this.isVertexIgnored(d[w])){this.vertexArray.push(d[w])}}var k=(this.useInputOrigin)?this.graph.view.getBounds(this.vertexArray):null;var t=this.vertexArray.length;this.indices=new Array();this.dispX=new Array();this.dispY=new Array();this.cellLocation=new Array();this.isMoveable=new Array();this.neighbours=new Array();this.radius=new Array();this.radiusSquared=new Array();if(this.forceConstant<0.001){this.forceConstant=0.001}this.forceConstantSquared=this.forceConstant*this.forceConstant;for(var w=0;w<this.vertexArray.length;w++){var z=this.vertexArray[w];this.cellLocation[w]=new Array();var s=mxCellPath.create(z);this.indices[s]=w;var h=this.getVertexBounds(z);var u=h.width;var r=h.height;var o=h.x;var m=h.y;this.cellLocation[w][0]=o+u/2;this.cellLocation[w][1]=m+r/2;this.radius[w]=Math.min(u,r);this.radiusSquared[w]=this.radius[w]*this.radius[w]}for(var w=0;w<t;w++){this.dispX[w]=0;this.dispY[w]=0;this.isMoveable[w]=this.isVertexMovable(this.vertexArray[w]);var a=this.graph.getConnections(this.vertexArray[w],l);var d=this.graph.getOpposites(a,this.vertexArray[w]);this.neighbours[w]=new Array();for(var v=0;v<d.length;v++){if(this.resetEdges){this.setEdgePoints(a[v],null)}var s=mxCellPath.create(d[v]);var g=this.indices[s];if(g!=null){this.neighbours[w][v]=g}else{this.neighbours[w][v]=w}}}this.temperature=this.initialTemp;if(this.maxIterations==0){this.maxIterations=20*Math.sqrt(t)}for(this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun){return}this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature()}e.beginUpdate();try{var f=null;var b=null;for(var w=0;w<this.vertexArray.length;w++){var z=this.vertexArray[w];if(this.isVertexMovable(z)){var h=this.getVertexBounds(z);if(h!=null){this.cellLocation[w][0]-=h.width/2;this.cellLocation[w][1]-=h.height/2;var o=this.graph.snap(this.cellLocation[w][0]);var m=this.graph.snap(this.cellLocation[w][1]);this.setVertexLocation(z,o,m);if(f==null){f=o}else{f=Math.min(f,o)}if(b==null){b=m}else{b=Math.min(b,m)}}}}var q=-(f||0)+1;var p=-(b||0)+1;if(k!=null){q+=k.x;p+=k.y}this.graph.move(this.vertexArray,q,p)}finally{e.endUpdate()}};mxFastOrganicLayout.prototype.calcPositions=function(){for(var b=0;b<this.vertexArray.length;b++){if(this.isMoveable[b]){var d=Math.sqrt(this.dispX[b]*this.dispX[b]+this.dispY[b]*this.dispY[b]);if(d<0.001){d=0.001}var e=this.dispX[b]/d*Math.min(d,this.temperature);var a=this.dispY[b]/d*Math.min(d,this.temperature);this.dispX[b]=0;this.dispY[b]=0;this.cellLocation[b][0]+=e;this.cellLocation[b][1]+=a}}};mxFastOrganicLayout.prototype.calcAttraction=function(){for(var m=0;m<this.vertexArray.length;m++){for(var g=0;g<this.neighbours[m].length;g++){var h=this.neighbours[m][g];if(m!=h&&this.isMoveable[m]&&this.isMoveable[h]){var l=this.cellLocation[m][0]-this.cellLocation[h][0];var n=this.cellLocation[m][1]-this.cellLocation[h][1];var f=l*l+n*n-this.radiusSquared[m]-this.radiusSquared[h];if(f<this.minDistanceLimitSquared){f=this.minDistanceLimitSquared}var e=Math.sqrt(f);var d=(f)/this.forceConstant;var b=(l/e)*d;var a=(n/e)*d;this.dispX[m]-=b;this.dispY[m]-=a;this.dispX[h]+=b;this.dispY[h]+=a}}}};mxFastOrganicLayout.prototype.calcRepulsion=function(){var b=this.vertexArray.length;for(var k=0;k<b;k++){for(var g=k;g<b;g++){if(!this.allowedToRun){return}if(g!=k&&this.isMoveable[k]&&this.isMoveable[g]){var h=this.cellLocation[k][0]-this.cellLocation[g][0];var l=this.cellLocation[k][1]-this.cellLocation[g][1];if(h==0){h=0.01+Math.random()}if(l==0){l=0.01+Math.random()}var f=Math.sqrt((h*h)+(l*l));var m=f-this.radius[k]-this.radius[g];if(m<this.minDistanceLimit){m=this.minDistanceLimit}var e=this.forceConstantSquared/m;var d=(h/f)*e;var a=(l/f)*e;this.dispX[k]+=d;this.dispY[k]+=a;this.dispX[g]-=d;this.dispY[g]-=a}}}};mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)};function mxCircleLayout(b,a){mxGraphLayout.call(this,b);this.radius=(a!=null)?a:100}mxCircleLayout.prototype=new mxGraphLayout();mxCircleLayout.prototype.constructor=mxCircleLayout;mxCircleLayout.prototype.radius=null;mxCircleLayout.prototype.execute=function(k){var g=this.graph.getModel();var j=0;var h=new Array();var e=g.getChildCount(k);for(var f=0;f<e;f++){var l=g.getChildAt(k,f);if(!this.isVertexIgnored(l)){h.push(l);var d=this.getVertexBounds(l);j=Math.max(j,Math.max(d.width,d.height))}}var b=h.length;var a=Math.max(b*j/Math.PI,this.radius);this.circle(h,a)};mxCircleLayout.prototype.circle=function(b,g){var a=this.graph.getModel();a.beginUpdate();try{var e=b.length;var f=2*Math.PI/e;for(var d=0;d<e;d++){if(this.isVertexMovable(b[d])){this.setVertexLocation(b[d],g+g*Math.sin(d*f),g+g*Math.cos(d*f))}}}finally{a.endUpdate()}};function mxParallelEdgeLayout(a){mxGraphLayout.call(this,a)}mxParallelEdgeLayout.prototype=new mxGraphLayout();mxParallelEdgeLayout.prototype.constructor=mxParallelEdgeLayout;mxParallelEdgeLayout.prototype.spacing=20;mxParallelEdgeLayout.prototype.execute=function(d){var e=this.findParallels(d);this.graph.model.beginUpdate();try{for(var b in e){var a=e[b];if(a.length>1){this.layout(a)}}}finally{this.graph.model.endUpdate()}};mxParallelEdgeLayout.prototype.findParallels=function(l){var k=this.graph.getView();var j=this.graph.getModel();var f=new Array();var g=j.getChildCount(l);for(var h=0;h<g;h++){var e=j.getChildAt(l,h);if(!this.isEdgeIgnored(e)){var a=k.getVisibleTerminal(e,true);var b=k.getVisibleTerminal(e,false);if(a!=null&&b!=null){a=mxCellPath.create(a);b=mxCellPath.create(b);var d=(a>b)?b+"-"+a:a+"-"+b;if(f[d]==null){f[d]=new Array()}f[d].push(e)}}}return f};mxParallelEdgeLayout.prototype.layout=function(l){var d=l[0];var k=this.graph.getView();var b=this.graph.getModel();var g=b.getGeometry(b.getTerminal(d,true));var q=b.getGeometry(b.getTerminal(d,false));if(g==q){var r=g.x+g.width+this.spacing;var a=g.y+g.height/2;for(var n=0;n<l.length;n++){this.route(l[n],r,a);r+=this.spacing}}else{if(g!=null&&q!=null){var o=g.x+g.width/2;var m=g.y+g.height/2;var f=q.x+q.width/2;var e=q.y+q.height/2;var j=f-o;var h=e-m;var p=Math.sqrt(j*j+h*h);var r=o+j/2;var a=m+h/2;var t=h*this.spacing/p;var s=j*this.spacing/p;r+=t*(l.length-1)/2;a-=s*(l.length-1)/2;for(var n=0;n<l.length;n++){this.route(l[n],r,a);r-=t;a+=s}}}};mxParallelEdgeLayout.prototype.route=function(b,a,d){if(this.graph.isMovable(b)){this.setEdgePoints(b,[new mxPoint(a,d)])}};function mxCompositeLayout(b,d,a){mxGraphLayout.call(this,b);this.layouts=d;this.master=a}mxCompositeLayout.prototype=new mxGraphLayout();mxCompositeLayout.prototype.constructor=mxCompositeLayout;mxCompositeLayout.prototype.layouts=null;mxCompositeLayout.prototype.master=null;mxCompositeLayout.prototype.move=function(b,a,d){if(this.master!=null){this.master.move.apply(this.master,arguments)}else{this.layouts[0].move.apply(this.layouts[0],arguments)}};mxCompositeLayout.prototype.execute=function(d){var a=this.graph.getModel();a.beginUpdate();try{for(var b=0;b<this.layouts.length;b++){this.layouts[b].execute.apply(this.layouts[b],arguments)}}finally{a.endUpdate()}};function mxGraphAbstractHierarchyCell(){this.x=new Array();this.y=new Array();this.temp=new Array()}mxGraphAbstractHierarchyCell.prototype.maxRank=-1;mxGraphAbstractHierarchyCell.prototype.minRank=-1;mxGraphAbstractHierarchyCell.prototype.x=null;mxGraphAbstractHierarchyCell.prototype.y=null;mxGraphAbstractHierarchyCell.prototype.width=0;mxGraphAbstractHierarchyCell.prototype.height=0;mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.temp=null;mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(a){return null};mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(a){return null};mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return false};mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return false};mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(a){return null};mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(a,b){return null};mxGraphAbstractHierarchyCell.prototype.setX=function(a,b){if(this.isVertex()){this.x[0]=b}else{if(this.isEdge()){this.x[a-this.minRank-1]=b}}};mxGraphAbstractHierarchyCell.prototype.getX=function(a){if(this.isVertex()){return this.x[0]}else{if(this.isEdge()){return this.x[a-this.minRank-1]}}return 0};mxGraphAbstractHierarchyCell.prototype.setY=function(a,b){if(this.isVertex()){this.y[0]=b}else{if(this.isEdge()){this.y[a-this.minRank-1]=b}}};function mxGraphHierarchyNode(a){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=a}mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode;mxGraphHierarchyNode.prototype.cell=null;mxGraphHierarchyNode.prototype.connectsAsTarget=new Array();mxGraphHierarchyNode.prototype.connectsAsSource=new Array();mxGraphHierarchyNode.prototype.hashCode=false;mxGraphHierarchyNode.prototype.getRankValue=function(a){return this.maxRank};mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(b){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=new Array();this.nextLayerConnectedCells[0]=new Array();for(var a=0;a<this.connectsAsTarget.length;a++){var d=this.connectsAsTarget[a];if(d.maxRank==-1||d.maxRank==b+1){this.nextLayerConnectedCells[0].push(d.source)}else{this.nextLayerConnectedCells[0].push(d)}}}return this.nextLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(b){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=new Array();this.previousLayerConnectedCells[0]=new Array();for(var a=0;a<this.connectsAsSource.length;a++){var d=this.connectsAsSource[a];if(d.minRank==-1||d.minRank==b-1){this.previousLayerConnectedCells[0].push(d.target)}else{this.previousLayerConnectedCells[0].push(d)}}}return this.previousLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.isVertex=function(){return true};mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(a){return this.temp[0]};mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(a,b){this.temp[0]=b};mxGraphHierarchyNode.prototype.isAncestor=function(b){if(b!=null&&this.hashCode!=null&&b.hashCode!=null&&this.hashCode.length<b.hashCode.length){if(this.hashCode==b.hashCode){return true}if(this.hashCode==null||this.hashCode==null){return false}for(var a=0;a<this.hashCode.length;a++){if(this.hashCode[a]!=b.hashCode[a]){return false}}return true}return false};function mxGraphHierarchyEdge(a){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=a}mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge;mxGraphHierarchyEdge.prototype.edges=null;mxGraphHierarchyEdge.prototype.source=null;mxGraphHierarchyEdge.prototype.target=null;mxGraphHierarchyEdge.prototype.isReversed=false;mxGraphHierarchyEdge.prototype.invert=function(b){var a=this.source;this.source=this.target;this.target=a;this.isReversed=!this.isReversed};mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(b){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=new Array();for(var a=0;a<this.temp.length;a++){this.nextLayerConnectedCells[a]=new Array();if(a==this.nextLayerConnectedCells.length-1){this.nextLayerConnectedCells[a].push(this.source)}else{this.nextLayerConnectedCells[a].push(this)}}}return this.nextLayerConnectedCells[b-this.minRank-1]};mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(b){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=new Array();for(var a=0;a<this.temp.length;a++){this.previousLayerConnectedCells[a]=new Array();if(a==0){this.previousLayerConnectedCells[a].push(this.target)}else{this.previousLayerConnectedCells[a].push(this)}}}return this.previousLayerConnectedCells[b-this.minRank-1]};mxGraphHierarchyEdge.prototype.isEdge=function(){return true};mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(a){return this.temp[a-this.minRank-1]};mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(a,b){this.temp[a-this.minRank-1]=b};function mxGraphHierarchyModel(u,g,l,o,v,m){var b=u.getGraph();this.deterministic=m;this.roots=l;this.vertexMapper=new Object();this.edgeMapper=new Object();this.maxRank=0;var f=new Array();if(g==null){g=this.graph.getChildVertices(o)}if(v){this.formOrderedHierarchy(u,g,o)}else{this.createInternalCells(u,g,f);for(var t=0;t<g.length;t++){var d=f[t].connectsAsSource;for(var s=0;s<d.length;s++){var a=d[s];var e=a.edges;for(var r=0;r<e.length;r++){var n=e[r];var p=b.getView().getVisibleTerminal(n,false);var q=mxCellPath.create(p);var h=this.vertexMapper[q];if(h!=null&&f[t]!=h){a.target=h;if(h.connectsAsTarget.length==0){h.connectsAsTarget=new Array()}if(mxUtils.indexOf(h.connectsAsTarget,a)<0){h.connectsAsTarget.push(a)}}}}f[t].temp[0]=1}}}mxGraphHierarchyModel.prototype.sinksAtLayerZero=true;mxGraphHierarchyModel.prototype.maxRank=null;mxGraphHierarchyModel.prototype.vertexMapper=null;mxGraphHierarchyModel.prototype.edgeMapper=null;mxGraphHierarchyModel.prototype.ranks=null;mxGraphHierarchyModel.prototype.roots=null;mxGraphHierarchyModel.prototype.parent=null;mxGraphHierarchyModel.prototype.dfsCount=0;mxGraphHierarchyModel.prototype.deterministic;mxGraphHierarchyModel.prototype.formOrderedHierarchy=function(o,p,s){var t=o.getGraph();this.createInternalCells(o,p,internalVertices);var q=new Array();for(var m=0;m<p.length;m++){var h=internalVertices[m].connectsAsSource;for(var g=0;g<h.length;g++){var n=h[g];var a=n.edges;for(var f=0;f<a.length;f++){var b=a[f];var d=this.graph.getView().getVisibleTerminal(b,false);var r=mxCellPath.create(d);var e=vertexMapper[r];if(e!=null&&internalVertices[m]!=e){n.target=e;if(e.connectsAsTarget.length==0){e.connectsAsTarget=new Array()}if(e.temp[0]==1){n.invert();e.connectsAsSource.push(n);q.push(n);if(mxUtils.indexOf(internalVertices[m].connectsAsTarget,n)<0){internalVertices[m].connectsAsTarget.push(n)}}else{if(mxUtils.indexOf(e.connectsAsTarget,n)<0){e.connectsAsTarget.push(n)}}}}}for(var g=0;g<q.length;g++){var l=q[g];mxUtils.remove(l,internalVertices[m].connectsAsSource)}q=new Array();internalVertices[m].temp[0]=1}};mxGraphHierarchyModel.prototype.createInternalCells=function(l,m,p){var r=l.getGraph();for(var g=0;g<m.length;g++){p[g]=new mxGraphHierarchyNode(m[g]);var n=mxCellPath.create(m[g]);this.vertexMapper[n]=p[g];var a=r.getConnections(m[g],this.parent);var s=r.getOpposites(a,m[g]);p[g].connectsAsSource=new Array();for(var f=0;f<s.length;f++){var q=s[f];if(q!=m[g]&&!l.isVertexIgnored(q)){var e=r.getEdgesBetween(m[g],q,true);if(e!=null&&e.length>0){var h=new mxGraphHierarchyEdge(e);for(var d=0;d<e.length;d++){var b=e[d];var o=mxCellPath.create(b);this.edgeMapper[o]=h}h.source=p[g];if(mxUtils.indexOf(p[g].connectsAsSource,h)<0){p[g].connectsAsSource.push(h)}}}}p[g].temp[0]=0}};mxGraphHierarchyModel.prototype.initialRank=function(o){sinksAtLayerZero=o;var h=null;if(!o&&this.roots!=null){h=this.roots.slice()}else{h=new Array()}if(o){for(var q in this.vertexMapper){var n=this.vertexMapper[q];if(n.connectsAsSource==null||n.connectsAsSource.length==0){h.push(n)}n.temp[0]=-1}if(h.length==0){o=false}}var m=h.slice();while(h.length>0){var n=h[0];var r;var p;if(o){r=n.connectsAsSource;p=n.connectsAsTarget}else{r=n.connectsAsTarget;p=n.connectsAsSource}var a=true;var d=0;for(var k=0;k<r.length;k++){var l=r[k];if(l.temp[0]==5270620){var g;if(o){g=l.target}else{g=l.source}d=Math.max(d,g.temp[0]+1)}else{a=false;break}}if(a){n.temp[0]=d;this.maxRank=Math.max(this.maxRank,d);if(p!=null){for(var k=0;k<p.length;k++){var l=p[k];l.temp[0]=5270620;var g;if(o){g=l.source}else{g=l.target}if(g.temp[0]==-1){h.push(g);g.temp[0]=-2}}}h.shift()}else{var e=h.shift();h.push(n);if(e==n&&h.length==1){break}}}sinksAtLayerZero=o;if(o){for(var k=0;k<m.length;k++){var n=m[k];var b=1000000;var r=n.connectsAsTarget;for(var f=0;f<n.connectsAsTarget.length;f++){var l=n.connectsAsTarget[f];var g=l.source;n.temp[0]=Math.min(b,g.temp[0]-1);b=n.temp[0]}}}};mxGraphHierarchyModel.prototype.fixRanks=function(){var d=new Array();this.ranks=new Array();for(var e=0;e<this.maxRank+1;e++){d[e]=new Array();this.ranks[e]=d[e]}var h=null;if(this.roots!=null){var b=this.roots;h=new Array();for(var e=0;e<b.length;e++){var a=b[e];var f=mxCellPath.create(a);var g=this.vertexMapper[f];h[e]=g}}this.visit(function(n,p,o,m,k){if(k==0&&p.maxRank<0&&p.minRank<0){d[p.temp[0]].push(p);p.maxRank=p.temp[0];p.minRank=p.temp[0];p.temp[0]=d[p.maxRank].length-1}if(n!=null&&o!=null){var j=n.maxRank-p.maxRank;if(j>1){o.maxRank=n.maxRank;o.minRank=p.maxRank;o.temp=new Array();o.x=new Array();o.y=new Array();for(var l=o.minRank+1;l<o.maxRank;l++){d[l].push(o);o.setGeneralPurposeVariable(l,d[l].length-1)}}}},h,false,null)};mxGraphHierarchyModel.prototype.visit=function(f,a,e,b){if(a!=null){for(var d=0;d<a.length;d++){var g=a[d];if(g!=null){if(b==null){b=new Object()}if(e){g.hashCode=new Array();g.hashCode[0]=this.dfsCount;g.hashCode[1]=d;this.extendedDfs(null,g,null,f,b,g.hashCode,d,0)}else{this.dfs(null,g,null,f,b,0)}}}this.dfsCount++}};mxGraphHierarchyModel.prototype.dfs=function(j,h,l,f,a,e){if(h!=null){var k=mxCellPath.create(h.cell);if(a[k]==null){a[k]=h;f(j,h,l,e,0);for(var b=0;b<h.connectsAsSource.length;b++){var d=h.connectsAsSource[b];var g=d.target;this.dfs(h,g,d,f,a,e+1)}}else{f(j,h,l,e,1)}}};mxGraphHierarchyModel.prototype.extendedDfs=function(n,l,o,j,a,p,d,h){if(l!=null){if(n!=null){if(l.hashCode==null||l.hashCode[0]!=n.hashCode[0]){var b=n.hashCode.length+1;l.hashCode=n.hashCode.slice();l.hashCode[b-1]=d}}var m=mxCellPath.create(l.cell);if(a[m]==null){a[m]=l;j(n,l,o,h,0);var e=l.connectsAsSource.slice();for(var f=0;f<l.connectsAsSource.length;f++){var g=l.connectsAsSource[f];var k=g.target;this.extendedDfs(l,k,g,j,a,l.hashCode,f,h+1)}}else{j(n,l,o,h,1)}}};function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(a){};function mxMedianHybridCrossingReduction(a){this.layout=a}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage();mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;mxMedianHybridCrossingReduction.prototype.execute=function(o){var h=this.layout.getModel();this.nestedBestRanks=new Array();for(var f=0;f<h.ranks.length;f++){this.nestedBestRanks[f]=h.ranks[f].slice()}var a=0;var l=this.calculateCrossings(h);for(var f=0;f<this.maxIterations&&a<this.maxNoImprovementIterations;f++){this.weightedMedian(f,h);this.transpose(f,h);var n=this.calculateCrossings(h);if(n<l){l=n;a=0;for(var d=0;d<this.nestedBestRanks.length;d++){var e=h.ranks[d];for(var q in e){var p=e[q];this.nestedBestRanks[d][p.getGeneralPurposeVariable(d)]=p}}}else{a++;for(var d=0;d<this.nestedBestRanks.length;d++){var e=h.ranks[d];for(var b=0;b<e.length;b++){var p=e[b];p.setGeneralPurposeVariable(d,q)}}}if(l==0){break}}var g=new Array();var m=new Array();for(var f=0;f<h.maxRank+1;f++){m[f]=new Array();g[f]=m[f]}for(var f=0;f<this.nestedBestRanks.length;f++){for(var d=0;d<this.nestedBestRanks[f].length;d++){m[f].push(this.nestedBestRanks[f][d])}}h.ranks=g};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(b){var e=b.ranks.length;var a=0;for(var d=1;d<e;d++){a+=this.calculateRankCrossing(d,b)}return a};mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(m,n){var e=0;var l=n.ranks[m];var s=n.ranks[m-1];var r=l.length;var q=s.length;var u=new Array();for(var g=0;g<r;g++){u[g]=new Array()}for(var g=0;g<l.length;g++){var d=l[g];var a=d.getGeneralPurposeVariable(m);var p=d.getPreviousLayerConnectedCells(m);for(var f=0;f<p.length;f++){var b=p[f];var h=b.getGeneralPurposeVariable(m-1);u[a][h]=201207}}for(var g=0;g<r;g++){for(var f=0;f<q;f++){if(u[g][f]==201207){for(var t=g+1;t<r;t++){for(var o=0;o<f;o++){if(u[t][o]==201207){e++}}}for(var t=0;t<g;t++){for(var o=f+1;o<q;o++){if(u[t][o]==201207){e++}}}}}}return e/2};mxMedianHybridCrossingReduction.prototype.transpose=function(a,g){var b=true;var o=0;var r=10;while(b&&o++<r){var t=a%2==1&&o%2==1;b=false;for(var z=0;z<g.ranks.length;z++){var A=g.ranks[z];var D=new Array();for(var y=0;y<A.length;y++){var e=A[y];var C=e.getGeneralPurposeVariable(z);if(C<0){C=y}D[C]=e}var u=null;var n=null;var h=null;var s=null;var f=null;var x=null;var E=null;var d=null;var m=null;var w=null;for(var y=0;y<(A.length-1);y++){if(y==0){m=D[y];u=m.getNextLayerConnectedCells(z);n=m.getPreviousLayerConnectedCells(z);f=new Array();x=new Array();for(var v=0;v<f.length;v++){f[v]=u[v].getGeneralPurposeVariable(z+1)}for(var v=0;v<x.length;v++){x[v]=n[v].getGeneralPurposeVariable(z-1)}}else{u=h;n=s;f=E;x=d;m=w}w=D[y+1];h=w.getNextLayerConnectedCells(z);s=w.getPreviousLayerConnectedCells(z);E=new Array();d=new Array();for(var v=0;v<E.length;v++){E[v]=h[v].getGeneralPurposeVariable(z+1)}for(var v=0;v<d.length;v++){d[v]=s[v].getGeneralPurposeVariable(z-1)}var l=0;var p=0;for(var v=0;v<f.length;v++){for(var q=0;q<E.length;q++){if(f[v]>E[q]){l++}if(f[v]<E[q]){p++}}}for(var v=0;v<x.length;v++){for(var q=0;q<d.length;q++){if(x[v]>d[q]){l++}if(x[v]<d[q]){p++}}}if((p<l)||(p==l&&t)){var B=m.getGeneralPurposeVariable(z);m.setGeneralPurposeVariable(z,w.getGeneralPurposeVariable(z));w.setGeneralPurposeVariable(z,B);h=u;s=n;E=f;d=x;w=m;if(!t){b=true}}}}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(d,b){var e=(d%2==0);if(e){for(var a=b.maxRank-1;a>=0;a--){this.medianRank(a,e)}}else{for(var a=1;a<b.maxRank;a++){this.medianRank(a,e)}}};mxMedianHybridCrossingReduction.prototype.medianRank=function(f,h){var g=this.nestedBestRanks[f].length;var b=new Array();for(var d=0;d<g;d++){var a=this.nestedBestRanks[f][d];b[d]=new MedianCellSorter();b[d].cell=a;b[d].nudge=!h;var j;if(h){j=a.getNextLayerConnectedCells(f)}else{j=a.getPreviousLayerConnectedCells(f)}var e;if(h){e=f+1}else{e=f-1}if(j!=null&&j.length!=0){b[d].medianValue=this.medianValue(j,e)}else{b[d].medianValue=-1}}b.sort(MedianCellSorter.prototype.compare);for(var d=0;d<g;d++){b[d].cell.setGeneralPurposeVariable(f,d)}};mxMedianHybridCrossingReduction.prototype.medianValue=function(f,k){var g=new Array();var h=0;for(var b=0;b<f.length;b++){var j=f[b];g[h++]=j.getGeneralPurposeVariable(k)}g.sort(MedianCellSorter.prototype.compare);if(h%2==1){return g[h/2]}else{if(h==2){return((g[0]+g[1])/2)}else{var d=h/2;var e=g[d-1]-g[0];var a=g[h-1]-g[d];return(g[d-1]*a+g[d]*e)/(e+a)}}};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.nudge=false;MedianCellSorter.prototype.cell=false;MedianCellSorter.prototype.compare=function(e,d){if(e!=null&&d!=null){if(d.medianValue>e.medianValue){return -1}else{if(d.medianValue<e.medianValue){return 1}else{if(d.nudge){return -1}else{return 1}}}}else{return 0}};function mxMinimumCycleRemover(a){this.layout=a}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage();mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;mxMinimumCycleRemover.prototype.execute=function(o){var m=this.layout.getModel();var a=new Object();var n=mxUtils.clone(m.vertexMapper,null,true);var l=null;if(m.roots!=null){var g=m.roots;l=new Array();for(var j=0;j<g.length;j++){var d=mxCellPath.create(g[j]);l[j]=m.vertexMapper[d]}}m.visit(function(u,v,r,t,s){if(v.isAncestor(u)){r.invert();mxUtils.remove(r,u.connectsAsSource);u.connectsAsTarget.push(r);mxUtils.remove(r,v.connectsAsTarget);v.connectsAsSource.push(r)}var w=mxCellPath.create(v.cell);a[w]=v;delete n[w]},l,true,null);var k=null;if(n.lenth>0){k=mxUtils.clone(n,null,true)}var h=mxUtils.clone(a,null,true);m.visit(function(u,v,r,t,s){if(v.isAncestor(u)){r.invert();mxUtils.remove(r,u.connectsAsSource);v.connectsAsSource.push(r);u.connectsAsTarget.push(r);mxUtils.remove(r,v.connectsAsTarget)}var w=mxCellPath.create(v.cell);a[w]=v;delete n[w]},n,true,h);var q=this.layout.getGraph();if(k!=null&&k.length>0){var p=m.roots;for(var j=0;j<k.length;j++){var f=k[j];var e=f.cell;var b=q.getIncomingEdges(e).length;if(b==0){p.push(e)}}}};function mxCoordinateAssignment(f,b,g,d,e,a){this.layout=f;this.intraCellSpacing=b;this.interRankCellSpacing=g;this.orientation=d;this.initialX=e;this.parallelEdgeSpacing=a}mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage();mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;mxCoordinateAssignment.prototype.interRankCellSpacing=10;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=true;mxCoordinateAssignment.prototype.disableEdgeStyle=true;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.execute=function(h){var e=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),e);if(this.fineTuning){this.minNode(e)}var g=100000000;if(this.fineTuning){for(var f=0;f<this.maxIterations;f++){if(f!=0){this.medianPos(f,e);this.minNode(e)}if(this.currentXDelta<g){for(var d=0;d<e.ranks.length;d++){var l=e.ranks[d];for(var b=0;b<l.length;b++){var a=l[b];a.setX(d,a.getGeneralPurposeVariable(d))}}g=this.currentXDelta}else{for(var d=0;d<e.ranks.length;d++){var l=e.ranks[d];for(var b=0;b<l.length;b++){var a=l[b];a.setGeneralPurposeVariable(d,a.getX(d))}}}this.currentXDelta=0}}this.setCellLocations(this.layout.getGraph(),e)};mxCoordinateAssignment.prototype.minNode=function(k){var I=new Array();var J=new Array();var H=new Array();for(var E=0;E<=k.maxRank;E++){H[E]=k.ranks[E];for(var D=0;D<H[E].length;D++){var y=H[E][D];var p=new WeightedCellSorter(y,E);p.rankIndex=D;p.visited=true;I.push(p);var K=mxCellPath.create(y.cell);J[K]=p}}var C=I.length*10;var n=0;var F=1;while(I.length>0&&n<=C){var f=I.shift();var e=f.cell;var B=f.weightedValue;var q=parseInt(f.rankIndex);var x=e.getNextLayerConnectedCells(B);var b=e.getPreviousLayerConnectedCells(B);var v=x.length;var s=b.length;var o=this.medianXValue(x,B+1);var d=this.medianXValue(b,B-1);var z=v+s;var t=e.getGeneralPurposeVariable(B);var G=t;if(z>0){G=(o*v+d*s)/z}var a=false;if(G<t-F){if(q==0){e.setGeneralPurposeVariable(B,G);a=true}else{var m=H[B][q-1];var h=m.getGeneralPurposeVariable(B);h=h+m.width/2+this.intraCellSpacing+e.width/2;if(h<G){e.setGeneralPurposeVariable(B,G);a=true}else{if(h<e.getGeneralPurposeVariable(B)-F){e.setGeneralPurposeVariable(B,h);a=true}}}}else{if(G>t+F){var r=H[B].length;if(q==r-1){e.setGeneralPurposeVariable(B,G);a=true}else{var A=H[B][q+1];var l=A.getGeneralPurposeVariable(B);l=l-A.width/2-this.intraCellSpacing-e.width/2;if(l>G){e.setGeneralPurposeVariable(B,G);a=true}else{if(l>e.getGeneralPurposeVariable(B)+F){e.setGeneralPurposeVariable(B,l);a=true}}}}}if(a){for(var E=0;E<x.length;E++){var g=x[E];var u=mxCellPath.create(g.cell);var w=J[u];if(w!=null){if(w.visited==false){w.visited=true;I.push(w)}}}for(var E=0;E<b.length;E++){var g=b[E];var u=mxCellPath.create(g.cell);var w=J[u];if(w!=null){if(w.visited==false){w.visited=true;I.push(w)}}}}f.visited=false;n++}};mxCoordinateAssignment.prototype.medianPos=function(d,b){var e=(d%2==0);if(e){for(var a=b.maxRank;a>0;a--){this.rankMedianPosition(a-1,b,a)}}else{for(var a=0;a<b.maxRank-1;a++){this.rankMedianPosition(a+1,b,a)}}};mxCoordinateAssignment.prototype.rankMedianPosition=function(s,e,p){var v=e.ranks[s];var k=new Array();var l=new Array();for(var u=0;u<v.length;u++){var o=v[u];k[u]=new WeightedCellSorter();k[u].cell=o;k[u].rankIndex=u;var n=mxCellPath.create(o.cell);l[n]=k[u];var q=null;if(p<s){q=o.getPreviousLayerConnectedCells(s)}else{q=o.getNextLayerConnectedCells(s)}k[u].weightedValue=this.calculatedWeightedValue(o,q)}k.sort(WeightedCellSorter.prototype.compare);for(var u=0;u<k.length;u++){var m=0;var a=k[u].cell;var q=null;var h=0;if(p<s){q=a.getPreviousLayerConnectedCells(s).slice()}else{q=a.getNextLayerConnectedCells(s).slice()}if(q!=null){m=q.length;if(m>0){h=this.medianXValue(q,p)}else{h=a.getGeneralPurposeVariable(s)}}var x=0;var d=-100000000;for(var t=k[u].rankIndex-1;t>=0;){var b=mxCellPath.create(v[t].cell);var w=l[b];if(w!=null){var g=w.cell;if(w.visited){d=g.getGeneralPurposeVariable(s)+g.width/2+this.intraCellSpacing+x+a.width/2;t=-1}else{x+=g.width+this.intraCellSpacing;t--}}}var y=0;var f=100000000;for(var t=k[u].rankIndex+1;t<k.length;){var b=mxCellPath.create(v[t].cell);var w=l[b];if(w!=null){var r=w.cell;if(w.visited){f=r.getGeneralPurposeVariable(s)-r.width/2-this.intraCellSpacing-y-a.width/2;t=k.length}else{y+=r.width+this.intraCellSpacing;t++}}}if(h>=d&&h<=f){a.setGeneralPurposeVariable(s,h)}else{if(h<d){a.setGeneralPurposeVariable(s,d);this.currentXDelta+=d-h}else{if(h>f){a.setGeneralPurposeVariable(s,f);this.currentXDelta+=h-f}}}k[u].visited=true}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(f,e){var b=0;for(var d=0;d<e.length;d++){var a=e[d];if(f.isVertex()&&a.isVertex()){b++}else{if(f.isEdge()&&a.isEdge()){b+=8}else{b+=2}}}return b};mxCoordinateAssignment.prototype.medianXValue=function(d,h){if(d.length==0){return 0}var a=new Array();for(var g=0;g<d.length;g++){a[g]=d[g].getGeneralPurposeVariable(h)}a.sort(MedianCellSorter.prototype.compare);if(d.length%2==1){return a[d.length/2]}else{var f=d.length/2;var b=a[f-1];var e=a[f];return((b+e)/2)}};mxCoordinateAssignment.prototype.initialCoords=function(d,a){this.calculateWidestRank(d,a);for(var b=this.widestRank;b>0;b--){if(b<a.maxRank){this.rankCoordinates(b,d,a)}}for(var b=this.widestRank;b<=a.maxRank;b++){if(b>0){this.rankCoordinates(b,d,a)}}};mxCoordinateAssignment.prototype.rankCoordinates=function(m,l,k){var h=k.ranks[m];var b=0;var f=this.initialX+(this.widestRankValue-this.rankWidths[m])/2;var d=false;for(var j=0;j<h.length;j++){var e=h[j];if(e.isVertex()){var a=this.layout.getVertexBounds(e.cell);if(a!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){e.width=a.width;e.height=a.height}else{e.width=a.height;e.height=a.width}}else{d=true}b=Math.max(b,e.height)}else{if(e.isEdge()){var g=1;if(e.edges!=null){g=e.edges.length}else{mxLog.warn("edge.edges is null")}e.width=(g-1)*this.parallelEdgeSpacing}}f+=e.width/2;e.setX(m,f);e.setGeneralPurposeVariable(m,f);f+=e.width/2;f+=this.intraCellSpacing}if(d==true){mxLog.warn("At least one cell has no bounds")}};mxCoordinateAssignment.prototype.calculateWidestRank=function(p,m){var n=-this.interRankCellSpacing;var f=0;this.rankWidths=new Array();this.rankY=new Array();for(var q=m.maxRank;q>=0;q--){var b=0;var l=m.ranks[q];var g=this.initialX;var d=false;for(var k=0;k<l.length;k++){var e=l[k];if(e.isVertex()){var a=this.layout.getVertexBounds(e.cell);if(a!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){e.width=a.width;e.height=a.height}else{e.width=a.height;e.height=a.width}}else{d=true}b=Math.max(b,e.height)}else{if(e.isEdge()){var j=1;if(e.edges!=null){j=e.edges.length}else{mxLog.warn("edge.edges is null")}e.width=(j-1)*this.parallelEdgeSpacing}}g+=e.width/2;e.setX(q,g);e.setGeneralPurposeVariable(q,g);g+=e.width/2;g+=this.intraCellSpacing;if(g>this.widestRankValue){this.widestRankValue=g;widestRank=q}this.rankWidths[q]=g}if(d==true){mxLog.warn("At least one cell has no bounds")}this.rankY[q]=n;var h=b/2+f/2+this.interRankCellSpacing;f=b;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST){n+=h}else{n-=h}for(var k=0;k<l.length;k++){var o=l[k];o.setY(q,n)}}};mxCoordinateAssignment.prototype.setCellLocations=function(r,n){for(var g=0;g<n.ranks.length;g++){var f=n.ranks[g];for(var m=0;m<f.length;m++){var b=f[m];if(b.isVertex()){var q=b.cell;var p=b.x[0]-b.width/2;var o=b.y[0]-b.height/2;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){this.layout.setVertexLocation(q,p,o)}else{this.layout.setVertexLocation(q,o,p)}limitX=Math.max(this.limitX,p+b.width)}else{if(b.isEdge()){var l=0;if(b.temp[0]!=101207){for(var e=0;e<b.edges.length;e++){var a=b.edges[e];var s=new Array();if(b.isReversed){for(var d=0;d<b.x.length;d++){var p=b.x[d]+l;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){s.push(new mxPoint(p,b.y[d]))}else{s.push(new mxPoint(b.y[d],p))}limitX=Math.max(limitX,p)}this.processReversedEdge(b,a)}else{for(var d=b.x.length-1;d>=0;d--){var p=b.x[d]+l;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){s.push(new mxPoint(p,b.y[d]))}else{s.push(new mxPoint(b.y[d],p))}limitX=Math.max(limitX,p)}}this.layout.setEdgePoints(a,s);if(this.disableEdgeStyle){r.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,"1",[a])}if(l==0){l=this.parallelEdgeSpacing}else{if(l>0){l=-l}else{l=-l+this.parallelEdgeSpacing}}}b.temp[0]=101207}}}}}};mxCoordinateAssignment.prototype.processReversedEdge=function(b,a){};function WeightedCellSorter(a,b){this.cell=a;this.weightedValue=b}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(e,d){if(e!=null&&d!=null){if(d.weightedValue>e.weightedValue){return -1}else{if(d.weightedValue<e.weightedValue){return 1}else{if(d.nudge){return -1}else{return 1}}}}else{return 0}};function mxHierarchicalLayout(b,a){mxGraphLayout.call(this,b);this.deterministic=(a!=null)?a:true}mxHierarchicalLayout.prototype=new mxGraphLayout();mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout;mxHierarchicalLayout.prototype.INITIAL_X_POSITION=100;mxHierarchicalLayout.prototype.roots=null;mxHierarchicalLayout.prototype.intraCellSpacing=30;mxHierarchicalLayout.prototype.interRankCellSpacing=50;mxHierarchicalLayout.prototype.interHierarchySpacing=60;mxHierarchicalLayout.prototype.parallelEdgeSpacing=10;mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxHierarchicalLayout.prototype.fineTuning=true;mxHierarchicalLayout.prototype.deterministic;mxHierarchicalLayout.prototype.fixRoots=false;mxHierarchicalLayout.prototype.model=null;mxHierarchicalLayout.prototype.getModel=function(){return this.model};mxHierarchicalLayout.prototype.execute=function(d,a){if(a==null){a=this.graph.findTreeRoots(d)}this.roots=a;if(this.roots!=null){var b=this.graph.getModel();b.beginUpdate();try{this.run(d)}finally{b.endUpdate()}}};mxHierarchicalLayout.prototype.run=function(g){var w=new Array();var h=null;var p=null;var A=null;if(this.fixRoots){h=new Array();p=new Array();A=new Array()}for(var y=0;y<this.roots.length;y++){var m=true;for(var x=0;m&&x<w.length;x++){var C=mxCellPath.create(this.roots[y]);if(w[x][C]!=null){m=false}}if(m){var f=new Array();f.push(this.roots[y]);var d=null;if(this.fixRoots){h.push(this.roots[y]);var a=this.getVertexBounds(this.roots[y]).getPoint();p.push(a);d=new Array()}var q=new Object();while(f.length>0){var b=f.shift();var E=mxCellPath.create(b);if(q[E]==null){q[E]=b;if(this.fixRoots){var B=this.graph.getIncomingEdges(b,g);for(var v=0;v<B.length;v++){d.push(B[v])}}var l=this.graph.getConnections(b,g);var e=this.graph.getOpposites(l,b);for(var v=0;v<e.length;v++){var n=mxCellPath.create(e[v]);if(q[n]==null){f.push(e[v])}}}}w.push(q);if(this.fixRoots){A.push(d)}}}var D=this.INITIAL_X_POSITION;for(var y=0;y<w.length;y++){var q=w[y];var B=new Array();for(var F in q){B.push(q[F])}this.model=new mxGraphHierarchyModel(this,B,this.roots,g,false,this.deterministic);this.cycleStage(g);this.layeringStage();this.crossingStage(g);D=this.placementStage(D,g);if(this.fixRoots){var u=h[y];var s=p[y];var t=this.getVertexBounds(u).getPoint();var r=s.x-t.x;var o=s.y-t.y;this.graph.move(q,r,o);var z=A[y+1];this.graph.move(z,r,o)}}};mxHierarchicalLayout.prototype.cycleStage=function(b){var a=new mxMinimumCycleRemover(this);a.execute(b)};mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank(true);this.model.fixRanks()};mxHierarchicalLayout.prototype.crossingStage=function(a){var b=new mxMedianHybridCrossingReduction(this);b.execute(a)};mxHierarchicalLayout.prototype.placementStage=function(a,d){var b=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,a,this.parallelEdgeSpacing);b.fineTuning=this.fineTuning;b.execute(d);return b.limitX+this.interHierarchySpacing};function mxGraphModel(a){this.currentEdit=this.createUndoableEdit();if(a==null){a=this.createRoot()}this.setRoot(a)}mxGraphModel.prototype=new mxEventSource();mxGraphModel.prototype.constructor=mxGraphModel;mxGraphModel.prototype.root=null;mxGraphModel.prototype.cells=null;mxGraphModel.prototype.maintainEdgeParent=true;mxGraphModel.prototype.createIds=true;mxGraphModel.prototype.prefix="";mxGraphModel.prototype.postfix="";mxGraphModel.prototype.nextId=0;mxGraphModel.prototype.currentEdit=null;mxGraphModel.prototype.updateLevel=0;mxGraphModel.prototype.createRoot=function(){var a=new mxCell();a.insert(new mxCell());return a};mxGraphModel.prototype.getCell=function(a){return(this.cells!=null)?this.cells[a]:null};mxGraphModel.prototype.getCells=function(f,e,a){a=a||new Array();if(typeof(f)=="function"){e=e||this.getRoot();if(f(e)){a.push(e)}var b=this.getChildCount(e);for(var d=0;d<b;d++){var g=this.getChildAt(e,d);this.getCells(f,g,a)}}return a};mxGraphModel.prototype.getRoot=function(a){var b=a||this.root;if(a!=null){while(a!=null){b=a;a=this.getParent(a)}}return b};mxGraphModel.prototype.setRoot=function(a){this.execute(new mxRootChange(this,a));return a};mxGraphModel.prototype.rootChanged=function(a){var b=this.root;this.root=a;this.nextId=0;this.cells=null;this.cellAdded(a);return b};mxGraphModel.prototype.isRoot=function(a){return a!=null&&this.root==a};mxGraphModel.prototype.isLayer=function(a){return this.isRoot(this.getParent(a))};mxGraphModel.prototype.isAncestor=function(a,b){while(b!=null&&b!=a){b=this.getParent(b)}return b==a};mxGraphModel.prototype.contains=function(a){return this.isAncestor(this.root,a)};mxGraphModel.prototype.getParent=function(a){return(a!=null)?a.getParent():null};mxGraphModel.prototype.add=function(b,e,a){if(b!=null&&e!=null){if(a==null){a=this.getChildCount(b)}var d=b!=this.getParent(e);this.execute(new mxChildChange(this,b,e,a));if(this.maintainEdgeParent&&d){this.updateEdgeParents(e)}}return e};mxGraphModel.prototype.cellAdded=function(a){if(a!=null){if(a.getId()==null&&this.createIds){a.setId(this.createId(a))}if(a.getId()!=null){var e=this.getCell(a.getId());if(e!=a){while(e!=null){a.setId(this.createId(a));e=this.getCell(a.getId())}if(this.cells==null){this.cells=new Object()}this.cells[a.getId()]=a}}if(mxUtils.isNumeric(a.getId())){this.nextId=Math.max(this.nextId,a.getId())}var b=this.getChildCount(a);for(var d=0;d<b;d++){this.cellAdded(this.getChildAt(a,d))}}};mxGraphModel.prototype.createId=function(a){var b=this.nextId;this.nextId++;return this.prefix+b+this.postfix};mxGraphModel.prototype.updateEdgeParents=function(a,b){b=b||this.getRoot(a);var d=this.getChildCount(a);for(var e=0;e<d;e++){var h=this.getChildAt(a,e);this.updateEdgeParents(h,b)}var g=this.getEdgeCount(a);for(var e=0;e<g;e++){var f=this.getEdgeAt(a,e);if(this.isAncestor(b,f)){this.updateEdgeParent(f)}}if(this.isEdge(a)){this.updateEdgeParent(a)}};mxGraphModel.prototype.updateEdgeParent=function(b){var a=this.getTerminal(b,true);var e=this.getTerminal(b,false);var h=null;if(a==e){h=this.getParent(a)}else{h=this.getNearestCommonAncestor(a,e)}if(h!=null&&this.getParent(h)!=this.root&&this.getParent(b)!=h){var d=this.getGeometry(b);if(d!=null){var g=this.getOrigin(this.getParent(b));var f=this.getOrigin(h);var k=f.x-g.x;var j=f.y-g.y;d=d.translate(-k,-j);this.setGeometry(b,d)}this.add(h,b,this.getChildCount(h))}};mxGraphModel.prototype.getOrigin=function(b){var a=null;if(b!=null){a=this.getOrigin(this.getParent(b));if(!this.isEdge(b)){var d=this.getGeometry(b);if(d!=null){a.x+=d.x;a.y+=d.y}}}else{a=new mxPoint()}return a};mxGraphModel.prototype.getNearestCommonAncestor=function(d,b){if(d!=null&&b!=null){var g=mxCellPath.create(b);if(g!=null&&g.length>0){var a=d;var f=mxCellPath.create(a)+mxCellPath.PATH_SEPARATOR;while(a!=null){var e=this.getParent(a);if(g.indexOf(f)==0&&e!=null){return a}f=mxCellPath.getParentPath(f)+mxCellPath.PATH_SEPARATOR;a=e}}}return null};mxGraphModel.prototype.remove=function(a){if(a==this.root){this.setRoot(null)}else{if(this.getParent(a)!=null){this.execute(new mxChildChange(this,null,a))}}return a};mxGraphModel.prototype.cellRemoved=function(a){if(a!=null&&this.cells!=null){var b=this.getChildCount(a);for(var d=b-1;d>=0;d--){this.cellRemoved(this.getChildAt(a,d))}if(this.cells!=null&&a.getId()!=null){delete this.cells[a.getId()]}}};mxGraphModel.prototype.parentForCellChanged=function(a,d,b){var e=this.getParent(a);if(d!=null){if(d!=e||e.getIndex(a)!=b){d.insert(a,b)}}else{if(e!=null){var f=e.getIndex(a);e.remove(f)}}if(!this.contains(e)&&d!=null){this.cellAdded(a)}else{if(d==null){this.cellRemoved(a)}}return e};mxGraphModel.prototype.getChildCount=function(a){return(a!=null)?a.getChildCount():0};mxGraphModel.prototype.getChildAt=function(a,b){return(a!=null)?a.getChildAt(b):null};mxGraphModel.prototype.getChildren=function(a){return(a!=null)?a.children:null};mxGraphModel.prototype.getChildVertices=function(a){return this.getChildCells(a,true,false)};mxGraphModel.prototype.getChildEdges=function(a){return this.getChildCells(a,false,true)};mxGraphModel.prototype.getChildCells=function(g,e,d){e=(e!=null)?e:false;d=(d!=null)?d:false;var b=this.getChildCount(g);var a=new Array();for(var f=0;f<b;f++){var h=this.getChildAt(g,f);if((!d&&!e)||(d&&this.isEdge(h))||(e&&this.isVertex(h))){a.push(h)}}return a};mxGraphModel.prototype.getTerminal=function(b,a){return b.getTerminal(a)};mxGraphModel.prototype.setTerminal=function(d,b,a){if(b!=this.getTerminal(d,a)){this.execute(new mxTerminalChange(this,d,b,a));if(this.maintainEdgeParent){this.updateEdgeParent(d)}}return b};mxGraphModel.prototype.setTerminals=function(a,b,d){this.beginUpdate();try{this.setTerminal(a,b,true);this.setTerminal(a,d,false)}finally{this.endUpdate()}};mxGraphModel.prototype.terminalForCellChanged=function(e,b,a){var d=this.getTerminal(e,a);if(b!=null){b.insertEdge(e,a)}else{if(d!=null){d.removeEdge(e,a)}}return d};mxGraphModel.prototype.getEdgeCount=function(a){return(a!=null)?a.getEdgeCount():0};mxGraphModel.prototype.getEdgeAt=function(a,b){return(a!=null)?a.getEdgeAt(b):null};mxGraphModel.prototype.getDirectedEdgeCount=function(a,b,g){var f=0;var h=this.getEdgeCount(a);for(var d=0;d<h;d++){var e=this.getEdgeAt(a,d);if(e!=g&&this.getTerminal(e,b)==a){f++}}return f};mxGraphModel.prototype.getConnections=function(a){return this.getEdges(a,true,true,false)};mxGraphModel.prototype.getIncomingEdges=function(a){return this.getEdges(a,true,false,false)};mxGraphModel.prototype.getOutgoingEdges=function(a){return this.getEdges(a,false,true,false)};mxGraphModel.prototype.getEdges=function(k,f,h,e){f=(f!=null)?f:true;h=(h!=null)?h:true;e=(e!=null)?e:true;var b=this.getEdgeCount(k);var l=new Array();for(var g=0;g<b;g++){var d=this.getEdgeAt(k,g);var a=this.getTerminal(d,true);var j=this.getTerminal(d,false);if(e||((a!=j)&&((f&&j==k)||(h&&a==k)))){l.push(d)}}return l};mxGraphModel.prototype.getEdgesBetween=function(d,m,g){g=(g!=null)?g:false;var j=this.getEdgeCount(d);var h=this.getEdgeCount(m);var l=d;var b=j;if(h<j){b=h;l=m}var o=new Array();for(var k=0;k<b;k++){var f=this.getEdgeAt(l,k);var a=this.getTerminal(f,true);var e=this.getTerminal(f,false);var n=a==d;if(n&&e==m||(!g&&this.getTerminal(f,!n)==m)){o.push(f)}}return o};mxGraphModel.prototype.getOpposites=function(b,f,d,a){d=(d!=null)?d:true;a=(a!=null)?a:true;var j=new Array();if(b!=null){for(var e=0;e<b.length;e++){var g=this.getTerminal(b[e],true);var h=this.getTerminal(b[e],false);if(g==f&&h!=null&&h!=f&&a){j.push(h)}else{if(h==f&&g!=null&&g!=f&&d){j.push(g)}}}}return j};mxGraphModel.prototype.getTopmostCells=function(d){var f=new Array();for(var e=0;e<d.length;e++){var a=d[e];var b=true;var g=this.getParent(a);while(g!=null){if(mxUtils.indexOf(d,g)>=0){b=false;break}g=this.getParent(g)}if(b){f.push(a)}}return f};mxGraphModel.prototype.isVertex=function(a){return a.isVertex()};mxGraphModel.prototype.isEdge=function(a){return a.isEdge()};mxGraphModel.prototype.isConnectable=function(a){return a.isConnectable()};mxGraphModel.prototype.getValue=function(a){return(a!=null)?a.getValue():null};mxGraphModel.prototype.setValue=function(a,b){this.execute(new mxValueChange(this,a,b));return b};mxGraphModel.prototype.valueForCellChanged=function(a,b){return a.valueChanged(b)};mxGraphModel.prototype.getGeometry=function(a,b){return(a!=null)?a.getGeometry():null};mxGraphModel.prototype.setGeometry=function(a,b){if(b!=this.getGeometry(a)){this.execute(new mxGeometryChange(this,a,b))}return b};mxGraphModel.prototype.geometryForCellChanged=function(a,d){var b=this.getGeometry(a);a.setGeometry(d);return b};mxGraphModel.prototype.getStyle=function(a){return a.getStyle()};mxGraphModel.prototype.setStyle=function(a,b){if(b!=this.getStyle(a)){this.execute(new mxStyleChange(this,a,b))}return b};mxGraphModel.prototype.styleForCellChanged=function(a,b){var d=this.getStyle(a);a.setStyle(b);return d};mxGraphModel.prototype.isCollapsed=function(a){return a.isCollapsed()};mxGraphModel.prototype.setCollapsed=function(a,b){if(b!=this.isCollapsed(a)){this.execute(new mxCollapseChange(this,a,b))}return b};mxGraphModel.prototype.collapsedStateForCellChanged=function(a,d){var b=this.isCollapsed(a);a.setCollapsed(d);return b};mxGraphModel.prototype.isVisible=function(a){return a.isVisible()};mxGraphModel.prototype.setVisible=function(a,b){if(b!=this.isVisible(a)){this.execute(new mxVisibleChange(this,a,b))}return b};mxGraphModel.prototype.visibleStateForCellChanged=function(a,d){var b=this.isVisible(a);a.setVisible(d);return b};mxGraphModel.prototype.execute=function(a){this.dispatchEvent("beforeExecute",this,a);a.execute();this.dispatchEvent("execute",this,a);this.beginUpdate();this.currentEdit.add(a);this.endUpdate();this.dispatchEvent("afterExecute",this,a)};mxGraphModel.prototype.beginUpdate=function(){this.updateLevel++;this.dispatchEvent("beginUpdate",this)};mxGraphModel.prototype.endUpdate=function(){this.updateLevel--;this.dispatchEvent("endUpdate",this);if(this.updateLevel==0){if(!this.currentEdit.isEmpty()){var a=this.currentEdit;this.dispatchEvent("beforeUndo",this,a);this.currentEdit=this.createUndoableEdit();a.notify();this.dispatchEvent("undo",this,a)}}};mxGraphModel.prototype.createUndoableEdit=function(){var a=new mxUndoableEdit(this,true);a.notify=function(){a.source.dispatchEvent("change",a.source,a.changes);a.source.dispatchEvent("notify",a.source,a.changes)};return a};mxGraphModel.prototype.mergeChildren=function(h,g,b){b=(b!=null)?b:true;this.beginUpdate();try{var d=new Object();this.mergeChildrenImpl(h,g,b,d);for(var f in d){var a=d[f];var e=this.getTerminal(a,true);if(e!=null){e=d[mxCellPath.create(e)];this.setTerminal(a,e,true)}e=this.getTerminal(a,false);if(e!=null){e=d[mxCellPath.create(e)];this.setTerminal(a,e,false)}}}finally{this.endUpdate()}};mxGraphModel.prototype.mergeChildrenImpl=function(j,k,e,a){this.beginUpdate();try{var d=j.getChildCount();for(var f=0;f<d;f++){var l=j.getChildAt(f);if(typeof(l.getId)=="function"){var b=l.getId();var g=(b!=null&&(!this.isEdge(l)||!e))?this.getCell(b):null;if(g==null){var h=l.clone();h.setId(b);h.setTerminal(l.getTerminal(true),true);h.setTerminal(l.getTerminal(false),false);g=this.add(k,h,this.getChildCount(k))}a[mxCellPath.create(l)]=g;this.mergeChildrenImpl(l,g,e,a)}}}finally{this.endUpdate()}};mxGraphModel.prototype.cloneCell=function(a){if(a!=null){return this.cloneCells([a],true)[0]}return null};mxGraphModel.prototype.cloneCells=function(d,a){var b=new Object();var f=new Array();for(var e=0;e<d.length;e++){if(d[e]!=null){f.push(this.cloneCellImpl(d[e],b,a))}else{f.push(null)}}for(var e=0;e<f.length;e++){if(f[e]!=null){this.restoreClone(f[e],d[e],b)}}return f};mxGraphModel.prototype.cloneCellImpl=function(b,e,a){var h=this.cellCloned(b);e[mxObjectIdentity.get(b)]=h;if(a){var d=this.getChildCount(b);for(var f=0;f<d;f++){var g=this.cloneCellImpl(this.getChildAt(b,f),e,true);h.insert(g)}}return h};mxGraphModel.prototype.cellCloned=function(a){return a.clone()};mxGraphModel.prototype.restoreClone=function(j,a,d){var g=this.getTerminal(a,true);if(g!=null){var f=d[mxObjectIdentity.get(g)];if(f!=null){f.insertEdge(j,true)}}var h=this.getTerminal(a,false);if(h!=null){var f=d[mxObjectIdentity.get(h)];if(f!=null){f.insertEdge(j,false)}}var b=this.getChildCount(j);for(var e=0;e<b;e++){this.restoreClone(this.getChildAt(j,e),this.getChildAt(a,e),d)}};function mxRootChange(b,a){this.model=b;this.root=a;this.previous=a}mxRootChange.prototype.execute=function(){this.root=this.previous;this.previous=this.model.rootChanged(this.previous)};function mxChildChange(b,d,e,a){this.model=b;this.parent=d;this.previous=d;this.child=e;this.index=a;this.previousIndex=a;this.isAdded=(d==null)}mxChildChange.prototype.execute=function(){var a=this.model.getParent(this.child);var b=(a!=null)?a.getIndex(this.child):0;if(this.previous==null){this.connect(this.child,false)}a=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex);if(this.previous!=null){this.connect(this.child,true)}this.parent=this.previous;this.previous=a;this.index=this.previousIndex;this.previousIndex=b;this.isAdded=!this.isAdded};mxChildChange.prototype.connect=function(a,e){e=(e!=null)?e:true;var f=a.getTerminal(true);var g=a.getTerminal(false);if(f!=null){if(e){this.model.terminalForCellChanged(a,f,true)}else{this.model.terminalForCellChanged(a,null,true)}}if(g!=null){if(e){this.model.terminalForCellChanged(a,g,false)}else{this.model.terminalForCellChanged(a,null,false)}}a.setTerminal(f,true);a.setTerminal(g,false);var b=this.model.getChildCount(a);for(var d=0;d<b;d++){this.connect(this.model.getChildAt(a,d),e)}};function mxTerminalChange(b,a,e,d){this.model=b;this.cell=a;this.terminal=e;this.previous=e;this.isSource=d}mxTerminalChange.prototype.execute=function(){this.terminal=this.previous;this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.isSource)};function mxValueChange(b,a,d){this.model=b;this.cell=a;this.value=d;this.previous=d}mxValueChange.prototype.execute=function(){this.value=this.previous;this.previous=this.model.valueForCellChanged(this.cell,this.previous)};function mxStyleChange(b,a,d){this.model=b;this.cell=a;this.style=d;this.previous=d}mxStyleChange.prototype.execute=function(){this.style=this.previous;this.previous=this.model.styleForCellChanged(this.cell,this.previous)};function mxGeometryChange(b,a,d){this.model=b;this.cell=a;this.geometry=d;this.previous=d}mxGeometryChange.prototype.execute=function(){this.geometry=this.previous;this.previous=this.model.geometryForCellChanged(this.cell,this.previous)};function mxCollapseChange(b,a,d){this.model=b;this.cell=a;this.collapsed=d;this.previous=d}mxCollapseChange.prototype.execute=function(){this.collapsed=this.previous;this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous)};function mxVisibleChange(b,a,d){this.model=b;this.cell=a;this.visible=d;this.previous=d}mxVisibleChange.prototype.execute=function(){this.visible=this.previous;this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous)};function mxCellAttributeChange(a,b,d){this.cell=a;this.attribute=b;this.value=d;this.previous=d}mxCellAttributeChange.prototype.execute=function(){var a=this.cell.getAttribute(this.attribute);if(this.previous==null){this.cell.value.removeAttribute(this.attribute)}else{this.cell.setAttribute(this.attribute,this.previous)}this.previous=a};function mxCell(b,d,a){this.value=b;this.setGeometry(d);this.setStyle(a);if(this.onInit!=null){this.onInit()}}mxCell.prototype.id=null;mxCell.prototype.value=null;mxCell.prototype.geometry=null;mxCell.prototype.style=null;mxCell.prototype.vertex=false;mxCell.prototype.edge=false;mxCell.prototype.connectable=true;mxCell.prototype.visible=true;mxCell.prototype.collapsed=false;mxCell.prototype.parent=null;mxCell.prototype.source=null;mxCell.prototype.target=null;mxCell.prototype.children=null;mxCell.prototype.edges=null;mxCell.prototype.mxTransient=[mxObjectIdentity.FIELD_NAME,"id","value","parent","source","target","children","edges"];mxCell.prototype.getId=function(){return this.id};mxCell.prototype.setId=function(a){this.id=a};mxCell.prototype.getValue=function(){return this.value};mxCell.prototype.setValue=function(a){this.value=a};mxCell.prototype.valueChanged=function(b){var a=this.getValue();this.setValue(b);return a};mxCell.prototype.getGeometry=function(){return this.geometry};mxCell.prototype.setGeometry=function(a){this.geometry=a};mxCell.prototype.getStyle=function(){return this.style};mxCell.prototype.setStyle=function(a){this.style=a};mxCell.prototype.isVertex=function(){return this.vertex};mxCell.prototype.setVertex=function(a){this.vertex=a};mxCell.prototype.isEdge=function(){return this.edge};mxCell.prototype.setEdge=function(a){this.edge=a};mxCell.prototype.isConnectable=function(){return this.connectable};mxCell.prototype.setConnectable=function(a){this.connectable=a};mxCell.prototype.isVisible=function(){return this.visible};mxCell.prototype.setVisible=function(a){this.visible=a};mxCell.prototype.isCollapsed=function(){return this.collapsed};mxCell.prototype.setCollapsed=function(a){this.collapsed=a};mxCell.prototype.getParent=function(a){return this.parent};mxCell.prototype.setParent=function(a){this.parent=a};mxCell.prototype.getTerminal=function(a){return(a)?this.source:this.target};mxCell.prototype.setTerminal=function(b,a){if(a){this.source=b}else{this.target=b}return b};mxCell.prototype.getChildCount=function(){return(this.children==null)?0:this.children.length};mxCell.prototype.getIndex=function(a){return mxUtils.indexOf(this.children,a)};mxCell.prototype.getChildAt=function(a){return(this.children==null)?null:this.children[a]};mxCell.prototype.insert=function(b,a){if(b!=null){a=(a!=null)?a:this.getChildCount();b.removeFromParent();b.setParent(this);if(this.children==null){this.children=new Array();this.children.push(b)}else{this.children.splice(a,0,b)}}return b};mxCell.prototype.remove=function(a){var b=null;if(this.children!=null&&a>=0){b=this.getChildAt(a);if(b!=null){this.children.splice(a,1);b.setParent(null)}}return b};mxCell.prototype.removeFromParent=function(){if(this.parent!=null){var a=this.parent.getIndex(this);this.parent.remove(a)}};mxCell.prototype.getEdgeCount=function(){return(this.edges==null)?0:this.edges.length};mxCell.prototype.getEdgeIndex=function(a){return mxUtils.indexOf(this.edges,a)};mxCell.prototype.getEdgeAt=function(a){return(this.edges==null)?null:this.edges[a]};mxCell.prototype.insertEdge=function(a,b){if(a!=null){a.removeFromTerminal(b);a.setTerminal(this,b);if(this.edges==null||a.getTerminal(!b)!=this||mxUtils.indexOf(this.edges,a)<0){if(this.edges==null){this.edges=new Array()}this.edges.push(a)}}return a};mxCell.prototype.removeEdge=function(b,d){if(b!=null){if(b.getTerminal(!d)!=this&&this.edges!=null){var a=this.getEdgeIndex(b);if(a>=0){this.edges.splice(a,1)}}b.setTerminal(null,d)}return b};mxCell.prototype.removeFromTerminal=function(b){var a=this.getTerminal(b);if(a!=null){a.removeEdge(this,b)}};mxCell.prototype.getAttribute=function(b,a){var d=this.getValue();var e=(d!=null&&d.nodeType==mxConstants.NODETYPE_ELEMENT)?d.getAttribute(b):null;return e||a};mxCell.prototype.setAttribute=function(a,d){var b=this.getValue();if(b!=null&&b.nodeType==mxConstants.NODETYPE_ELEMENT){b.setAttribute(a,d)}};mxCell.prototype.clone=function(){var a=mxUtils.clone(this,this.mxTransient);a.setValue(this.cloneValue());return a};mxCell.prototype.cloneValue=function(){var a=this.getValue();if(a!=null){if(typeof(a.clone)=="function"){a=a.clone()}else{if(!isNaN(a.nodeType)){a=a.cloneNode(true)}}}return a};function mxGeometry(b,e,d,a){mxRectangle.call(this,b,e,d,a)}mxGeometry.prototype=new mxRectangle();mxGeometry.prototype.constructor=mxGeometry;mxGeometry.prototype.alternateBounds=null;mxGeometry.prototype.sourcePoint=null;mxGeometry.prototype.targetPoint=null;mxGeometry.prototype.points=null;mxGeometry.prototype.offset=null;mxGeometry.prototype.relative=false;mxGeometry.prototype.swap=function(){if(this.alternateBounds!=null){var a=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x;this.y=this.alternateBounds.y;this.width=this.alternateBounds.width;this.height=this.alternateBounds.height;this.alternateBounds=a}};mxGeometry.prototype.getTerminalPoint=function(a){return(a)?this.sourcePoint:this.targetPoint};mxGeometry.prototype.setTerminalPoint=function(a,b){if(b){this.sourcePoint=a}else{this.targetPoint=a}return a};mxGeometry.prototype.translate=function(b,a){var g=this.clone();if(!g.relative){g.x+=b;g.y+=a}if(g.sourcePoint!=null){g.sourcePoint.x+=b;g.sourcePoint.y+=a}if(g.targetPoint!=null){g.targetPoint.x+=b;g.targetPoint.y+=a}if(g.points!=null){var e=g.points.length;for(var d=0;d<e;d++){var f=g.points[d];f.x+=b;f.y+=a}}return g};var mxCellPath={PATH_SEPARATOR:".",create:function(b){var a="";if(b!=null){var e=b.getParent();while(e!=null){var d=e.getIndex(b);a=d+mxCellPath.PATH_SEPARATOR+a;b=e;e=b.getParent()}}var f=a.length;if(f>1){a=a.substring(0,f-1)}return a},getParentPath:function(b){if(b!=null){var a=b.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(a>=0){return b.substring(0,a)}else{if(b.length>0){return""}}}return null},resolve:function(a,f){var d=a;if(f!=null){var e=f.split(mxCellPath.PATH_SEPARATOR);for(var b=0;b<e.length;b++){d=d.getChildAt(parseInt(e[b]))}}return d}};var mxPerimeter={RectanglePerimeter:function(a,k,b,m,j){var g=a.x+a.width/2;var e=a.y+a.height/2;var r=j.x-g;var q=j.y-e;var f=Math.atan2(q,r);var d=new mxPoint(0,0);var h=Math.PI;var l=Math.PI/2;var n=l-f;var o=Math.atan2(a.height,a.width);if(f<-h+o||f>h-o){d.x=a.x;d.y=e-a.width*Math.tan(f)/2}else{if(f<-o){d.y=a.y;d.x=g-a.height*Math.tan(n)/2}else{if(f<o){d.x=a.x+a.width;d.y=e+a.width*Math.tan(f)/2}else{d.y=a.y+a.height;d.x=g+a.height*Math.tan(n)/2}}}if(k!=null&&k.view.graph.isOrthogonal(k,b)){if(j.x>=a.x&&j.x<=a.x+a.width){d.x=j.x}else{if(j.y>=a.y&&j.y<=a.y+a.height){d.y=j.y}}if(j.x<a.x){d.x=a.x}else{if(j.x>a.x+a.width){d.x=a.x+a.width}}if(j.y<a.y){d.y=a.y}else{if(j.y>a.y+a.height){d.y=a.y+a.height}}}return d},EllipsePerimeter:function(p,E,o,j,D){var v=p.x;var u=p.y;var Q=p.width/2;var N=p.height/2;var l=v+Q;var k=u+N;var B=D.x;var A=D.y;var z=B-l;var w=A-k;if(z==0&&w!=0){return new mxPoint(l,k+N*w/Math.abs(w))}var n=E!=null&&E.view.graph.isOrthogonal(E,o);if(n){if(A>=u&&A<=u+p.height){var O=A-k;var P=Math.sqrt(Q*Q*(1-(O*O)/(N*N)))||0;if(B<=v){P=-P}return new mxPoint(l+P,A)}if(B>=v&&B<=v+p.width){var P=B-l;var O=Math.sqrt(N*N*(1-(P*P)/(Q*Q)))||0;if(A<=u){O=-O}return new mxPoint(B,k+O)}}var M=w/z;var I=k-M*l;var L=Q*Q*M*M+N*N;var K=-2*l*L;var J=Q*Q*M*M*l*l+N*N*l*l-Q*Q*N*N;var m=Math.sqrt(K*K-4*L*J);var G=(-K+m)/(2*L);var F=(-K-m)/(2*L);var r=M*G+I;var q=M*F+I;var t=Math.sqrt(Math.pow((G-B),2)+Math.pow((r-A),2));var s=Math.sqrt(Math.pow((F-B),2)+Math.pow((q-A),2));var C=0;var H=0;if(t<s){C=G;H=r}else{C=F;H=q}return new mxPoint(C,H)},RhombusPerimeter:function(a,l,b,m,k){var p=a.x;var n=a.y;var r=a.width;var j=a.height;var e=p+r/2;var d=n+j/2;var q=k.x;var o=k.y;if(e==q){if(d>o){return new mxPoint(e,n)}else{return new mxPoint(e,n+j)}}else{if(d==o){if(e>q){return new mxPoint(p,d)}else{return new mxPoint(p+r,d)}}}var g=e;var f=d;if(l!=null&&l.view.graph.isOrthogonal(l,b)){if(q>=p&&q<=p+r){g=q}else{if(o>=n&&o<=n+j){f=o}}}if(q<e){if(o<d){return mxUtils.intersection(q,o,g,f,e,n,p,d)}else{return mxUtils.intersection(q,o,g,f,e,n+j,p,d)}}else{if(o<d){return mxUtils.intersection(q,o,g,f,e,n,p+r,d)}else{return mxUtils.intersection(q,o,g,f,e,n+j,p+r,d)}}},TrianglePerimeter:function(n,C,m,b,A){var j=C!=null&&C.view.graph.isOrthogonal(C,m);var E=(m!=null)?m.style[mxConstants.STYLE_DIRECTION]:null;var a=E==mxConstants.DIRECTION_NORTH||E==mxConstants.DIRECTION_SOUTH;var q=n.x;var p=n.y;var u=n.width;var D=n.height;var e=q+u/2;var d=p+D/2;var k=new mxPoint(q,p);var o=new mxPoint(q+u,d);var f=new mxPoint(q,p+D);if(E==mxConstants.DIRECTION_NORTH){k=f;o=new mxPoint(e,p);f=new mxPoint(q+u,p+D)}else{if(E==mxConstants.DIRECTION_SOUTH){o=new mxPoint(e,p+D);f=new mxPoint(q+u,p)}else{if(E==mxConstants.DIRECTION_WEST){k=new mxPoint(q+u,p);o=new mxPoint(q,d);f=new mxPoint(q+u,p+D)}}}var v=A.x-e;var s=A.y-d;var g=(a)?Math.atan2(v,s):Math.atan2(s,v);var z=(a)?Math.atan2(u,D):Math.atan2(D,u);var l=false;if(E==mxConstants.DIRECTION_NORTH||E==mxConstants.DIRECTION_WEST){l=g>-z&&g<z}else{l=g<-Math.PI+z||g>Math.PI-z}var r=null;if(l){if(j&&((a&&A.x>=k.x&&A.x<=f.x)||(!a&&A.y>=k.y&&A.y<=f.y))){if(a){r=new mxPoint(A.x,k.y)}else{r=new mxPoint(k.x,A.y)}}else{if(E==mxConstants.DIRECTION_NORTH){r=new mxPoint(q+u/2+D*Math.tan(g)/2,p+D)}else{if(E==mxConstants.DIRECTION_SOUTH){r=new mxPoint(q+u/2-D*Math.tan(g)/2,p)}else{if(E==mxConstants.DIRECTION_WEST){r=new mxPoint(q+u,p+D/2+u*Math.tan(g)/2)}else{r=new mxPoint(q,p+D/2-u*Math.tan(g)/2)}}}}}else{if(j){var B=new mxPoint(e,d);if(A.y>=p&&A.y<=p+D){B.x=(a)?e:((E==mxConstants.DIRECTION_WEST)?q+u:q);B.y=A.y}else{if(A.x>=q&&A.x<=q+u){B.x=A.x;B.y=(!a)?d:((E==mxConstants.DIRECTION_NORTH)?p+D:p)}}v=A.x-B.x;s=A.y-B.y;e=B.x;d=B.y}if((a&&A.x<=q+u/2)||(!a&&A.y<=p+D/2)){r=mxUtils.intersection(A.x,A.y,e,d,k.x,k.y,o.x,o.y)}else{r=mxUtils.intersection(A.x,A.y,e,d,o.x,o.y,f.x,f.y)}}if(r==null){r=new mxPoint(e,d)}return r}};function mxStylesheet(){this.styles=new Object();this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}mxStylesheet.prototype.styles;mxStylesheet.prototype.createDefaultVertexStyle=function(){var a=new Object();a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;a[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_FILLCOLOR]="#C3D9FF";a[mxConstants.STYLE_STROKECOLOR]="#6482B9";a[mxConstants.STYLE_FONTCOLOR]="#774400";return a};mxStylesheet.prototype.createDefaultEdgeStyle=function(){var a=new Object();a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR;a[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_STROKECOLOR]="#6482B9";a[mxConstants.STYLE_FONTCOLOR]="#446299";return a};mxStylesheet.prototype.putDefaultVertexStyle=function(a){this.putCellStyle("defaultVertex",a)};mxStylesheet.prototype.putDefaultEdgeStyle=function(a){this.putCellStyle("defaultEdge",a)};mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles.defaultVertex};mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles.defaultEdge};mxStylesheet.prototype.putCellStyle=function(a,b){this.styles[a]=b};mxStylesheet.prototype.getCellStyle=function(name,defaultStyle){var style=defaultStyle;if(name!=null&&name.length>0){var pairs=name.split(";");if(pairs!=null&&pairs.length>0){if(style!=null&&pairs[0].indexOf("=")>=0){style=mxUtils.clone(style)}else{style=new Object()}for(var i=0;i<pairs.length;i++){var tmp=pairs[i];var pos=tmp.indexOf("=");if(pos>=0){var key=tmp.substring(0,pos);var value=tmp.substring(pos+1);if(value==mxConstants.NONE){delete style[key]}else{if(mxUtils.isNumeric(value)){style[key]=parseFloat(value)}else{if(value.indexOf(".")>0){try{var tmp=mxUtils.eval(value);if(typeof(tmp)=="function"){value=tmp}}catch(e){}}style[key]=value}}}else{var tmpStyle=this.styles[tmp];if(tmpStyle!=null){for(var key in tmpStyle){style[key]=tmpStyle[key]}}}}}}return style};function mxCellState(b,a,d){this.view=b;this.cell=a;this.style=d;this.origin=new mxPoint();this.absoluteOffset=new mxPoint()}mxCellState.prototype.view=null;mxCellState.prototype.cell=null;mxCellState.prototype.style=null;mxCellState.prototype.x=0;mxCellState.prototype.y=0;mxCellState.prototype.width=0;mxCellState.prototype.height=0;mxCellState.prototype.invalid=true;mxCellState.prototype.origin=null;mxCellState.prototype.absolutePoints=null;mxCellState.prototype.absoluteOffset=null;mxCellState.prototype.terminalDistance=0;mxCellState.prototype.length=0;mxCellState.prototype.segments=null;mxCellState.prototype.shape=null;mxCellState.prototype.text=null;mxCellState.prototype.getCenterX=function(){return this.x+this.width/2};mxCellState.prototype.getCenterY=function(){return this.y+this.height/2};mxCellState.prototype.getRoutingCenterX=function(){if(this.style!=null){var a=parseFloat(this.style[mxConstants.STYLE_ROUTING_CENTER_X])||0;return this.getCenterX()+a*this.width}return this.getCenterX()};mxCellState.prototype.getRoutingCenterY=function(){if(this.style!=null){var a=parseFloat(this.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0;return this.getCenterY()+a*this.height}return this.getCenterY()};mxCellState.prototype.getPerimeterBounds=function(a){a=a||0;var b=new mxRectangle(this.x,this.y,this.width,this.height);b.grow(a);return b};mxCellState.prototype.setAbsoluteTerminalPoint=function(a,b){if(b){if(this.absolutePoints==null||this.absolutePoints.length==0){this.absolutePoints=new Array();this.absolutePoints.push(a)}else{this.absolutePoints[0]=a}}else{if(this.absolutePoints==null){this.absolutePoints=new Array();this.absolutePoints.push(null);this.absolutePoints.push(a)}else{if(this.absolutePoints.length==1){this.absolutePoints.push(a)}else{this.absolutePoints[this.absolutePoints.length-1]=a}}}};mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this);this.view.graph.destroyHandler(this)};mxCellState.prototype.clone=function(){var a=new mxCellState(this.view,this.cell,this.style);if(this.absolutePoints!=null){a.absolutePoints=new Array();for(i=0;i<this.absolutePoints.length;i++){a.absolutePoints.push(this.absolutePoints[i].clone())}}if(this.origin!=null){a.origin=this.origin.clone()}if(this.absoluteOffset!=null){a.absoluteOffset=this.absoluteOffset.clone()}if(this.sourcePoint!=null){a.sourcePoint=this.sourcePoint.clone()}if(this.boundingBox!=null){a.boundingBox=this.boundingBox.clone()}a.terminalDistance=this.terminalDistance;a.segments=this.segments;a.length=this.length;a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a};function mxGraphSelection(a){this.graph=a;this.cells=new Array()}mxGraphSelection.prototype=new mxEventSource();mxGraphSelection.prototype.constructor=mxGraphSelection;mxGraphSelection.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphSelection.prototype.updatingSelectionResource=(mxClient.language!="none")?"updatingSelection":"";mxGraphSelection.prototype.graph=null;mxGraphSelection.prototype.singleSelection=false;mxGraphSelection.prototype.isSingleSelection=function(){return this.singleSelection};mxGraphSelection.prototype.setSingleSelection=function(a){this.singleSelection=a};mxGraphSelection.prototype.isSelected=function(a){if(a==null){return false}else{var b=this.graph.getView().getState(a);return this.graph.hasHandler(b)}};mxGraphSelection.prototype.clear=function(){this.changeSelection(null,this.cells)};mxGraphSelection.prototype.setCell=function(a){if(a!=null){this.setCells([a])}};mxGraphSelection.prototype.setCells=function(a){if(a!=null){if(this.singleSelection){a=[this.getFirstSelectableCell(a)]}var d=new Array();for(var b=0;b<a.length;b++){if(this.graph.isSelectable(a[b])){d.push(a[b])}}this.changeSelection(d,this.cells)}};mxGraphSelection.prototype.getFirstSelectableCell=function(a){if(a!=null){for(var b=0;b<a.length;b++){if(this.graph.isSelectable(a[b])){return a[b]}}}return null};mxGraphSelection.prototype.addCell=function(a){if(a!=null){this.addCells([a])}};mxGraphSelection.prototype.addCells=function(b){if(b!=null){var a=null;if(this.singleSelection){a=this.cells;b=[this.getFirstSelectableCell(b)]}var e=new Array();for(var d=0;d<b.length;d++){if(!this.isSelected(b[d])&&this.graph.isSelectable(b[d])){e.push(b[d])}}this.changeSelection(e,a)}};mxGraphSelection.prototype.removeCell=function(a){if(a!=null){this.removeCells([a])}};mxGraphSelection.prototype.removeCells=function(a){if(a!=null){var d=new Array();for(var b=0;b<a.length;b++){if(this.isSelected(a[b])){d.push(a[b])}}this.changeSelection(null,d)}};mxGraphSelection.prototype.changeSelection=function(a,d){if((a!=null&&a.length>0&&a[0]!=null)||(d!=null&&d.length>0&&d[0]!=null)){var e=new mxSelectionChange(this,a,d);e.execute();var b=new mxUndoableEdit(this,false);b.add(e);this.dispatchEvent("undo",this,b)}};mxGraphSelection.prototype.cellAdded=function(a){if(a!=null){var b=this.graph.getView().getState(a);if(b!=null&&!this.graph.hasHandler(b)){this.graph.createHandler(b);this.cells.push(a)}}};mxGraphSelection.prototype.cellRemoved=function(a){if(a!=null){var b=mxUtils.indexOf(this.cells,a);if(b>=0){var d=this.graph.getView().getState(a);if(d!=null){this.graph.destroyHandler(d)}this.cells.splice(b,1)}}};function mxSelectionChange(b,a,d){this.selection=b;this.added=(a!=null)?a.slice():null;this.removed=(d!=null)?d.slice():null}mxSelectionChange.prototype.execute=function(){var d=mxLog.enter("mxSelectionChange.execute");window.status=mxResources.get(this.selection.updatingSelectionResource)||this.selection.updatingSelectionResource;if(this.removed!=null){for(var b=0;b<this.removed.length;b++){this.selection.cellRemoved(this.removed[b])}}if(this.added!=null){for(var b=0;b<this.added.length;b++){this.selection.cellAdded(this.added[b])}}var a=this.added;this.added=this.removed;this.removed=a;window.status=mxResources.get(this.selection.doneResource)||this.selection.doneResource;mxLog.leave("mxSelectionChange.execute",d);this.selection.dispatchEvent("change",this,this.removed,this.added)};function mxCellEditor(a){this.graph=a;this.textarea=document.createElement("textarea");this.textarea.className="mxCellEditor";this.textarea.style.position="absolute";this.textarea.style.overflow="visible";this.textarea.setAttribute("cols","20");this.textarea.setAttribute("rows","4");this.init()}mxCellEditor.prototype.graph=null;mxCellEditor.prototype.textarea=null;mxCellEditor.prototype.cell=null;mxCellEditor.prototype.emptyLabelText="";mxCellEditor.prototype.init=function(){var a=this;mxEvent.addListener(this.textarea,"blur",function(b){a.stopEditing(false)});mxEvent.addListener(this.textarea,"keydown",function(b){if(a.clearOnChange){a.clearOnChange=false;a.textarea.value=""}a.modified=true})};mxCellEditor.prototype.startEditing=function(a,b){this.stopEditing(true);var f=this.graph.getView().getState(a);if(f!=null){this.cell=a;this.trigger=b;this.textNode=null;if(f.text!=null){if(this.isHideLabel(f)){this.textNode=f.text.node;this.textNode.style.visibility="hidden"}var g=this.graph.getView().scale;this.textarea.style.fontSize=f.text.size*g;this.textarea.style.fontFamily=f.text.family;this.textarea.style.color=f.text.color;if(this.textarea.style.color=="white"){this.textarea.style.color="black"}this.textarea.style.textAlign=(this.graph.model.isEdge(f.cell))?"left":(f.text.align||"left");this.textarea.style.fontWeight=f.text.isStyleSet(mxConstants.FONT_BOLD)?"bold":"normal"}var d=this.getEditorBounds(f);try{this.textarea.style.left=d.x+"px";this.textarea.style.top=d.y+"px";this.textarea.style.width=d.width+"px";this.textarea.style.height=d.height+"px";this.textarea.style.zIndex=5;}catch(e){}var e=this.graph.getEditingValue(a,b);if(e==null||e.length==0){e=this.getEmptyLabelText();this.clearOnChange=true}else{this.clearOnChange=false}this.modified=false;this.textarea.value=e;this.graph.container.appendChild(this.textarea);this.textarea.focus();this.textarea.select()}};mxCellEditor.prototype.isHideLabel=function(a){return true};mxCellEditor.prototype.getEditorBounds=function(a){var e=this.graph.getView().scale;var k=(a.text==null)?30:a.text.size*e+20;var b=(this.textarea.style.textAlign=="left")?120:40;var j=parseInt(a.style[mxConstants.STYLE_SPACING]||2)*e;var h=(parseInt(a.style[mxConstants.STYLE_SPACING_TOP]||0))*e+j;var f=(parseInt(a.style[mxConstants.STYLE_SPACING_RIGHT]||0))*e+j;var d=(parseInt(a.style[mxConstants.STYLE_SPACING_BOTTOM]||0))*e+j;var g=(parseInt(a.style[mxConstants.STYLE_SPACING_LEFT]||0))*e+j;var l=new mxRectangle(a.x,a.y,Math.max(b,a.width-g-f),Math.max(k,a.height-h-d));if(this.graph.getModel().isEdge(a.cell)){l.x=a.absoluteOffset.x;l.y=a.absoluteOffset.y;if(a.text!=null&&a.text.boundingBox!=null){l.x=a.text.boundingBox.x;l.y=a.text.boundingBox.y}}else{if(a.text!=null&&a.text.boundingBox!=null){l.x=Math.min(l.x,a.text.boundingBox.x);l.y=Math.min(l.y,a.text.boundingBox.y)}}l.x+=g;l.y+=h;if(a.text!=null&&a.text.boundingBox!=null){l.width=Math.max(l.width,a.text.boundingBox.width);l.height=Math.max(l.height,a.text.boundingBox.height)}return l};mxCellEditor.prototype.getEmptyLabelText=function(a){return this.emptyLabelText};mxCellEditor.prototype.isEditing=function(a){return(a==null)?this.cell!=null:this.cell==a};mxCellEditor.prototype.stopEditing=function(a){a=a||false;if(this.cell!=null){if(this.textNode!=null){this.textNode.style.visibility="visible";this.textNode=null}if(!a&&this.modified){this.graph.labelChanged(this.cell,this.textarea.value.replace(/\r/g,""),this.trigger)}this.cell=null;this.trigger=null;this.textarea.blur();this.textarea.parentNode.removeChild(this.textarea)}};mxCellEditor.prototype.destroy=function(){mxUtils.release(this.textarea);if(this.textarea.parentNode!=null){this.textarea.parentNode.removeChild(this.textarea)}this.textarea=null};function mxCellRenderer(){this.shapes=mxUtils.clone(this.defaultShapes)}mxCellRenderer.prototype.collapseExpandResource=(mxClient.language!="none")?"collapse-expand":"";mxCellRenderer.prototype.shapes=null;mxCellRenderer.prototype.checkStyleChanged=true;mxCellRenderer.prototype.defaultShapes=new Object();mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ARROW]=mxArrow;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RECTANGLE]=mxRectangleShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ELLIPSE]=mxEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_DOUBLE_ELLIPSE]=mxDoubleEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RHOMBUS]=mxRhombus;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_IMAGE]=mxImageShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LINE]=mxLine;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LABEL]=mxLabel;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CYLINDER]=mxCylinder;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_SWIMLANE]=mxSwimlane;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CONNECTOR]=mxConnector;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ACTOR]=mxActor;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CLOUD]=mxCloud;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_TRIANGLE]=mxTriangle;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_HEXAGON]=mxHexagon;mxCellRenderer.prototype.registerShape=function(b,a){this.shapes[b]=a};mxCellRenderer.prototype.initialize=function(e){var b=e.view.graph.getModel();if(e.view.graph.container!=null&&e.shape==null&&e.cell!=e.view.currentRoot&&(b.isVertex(e.cell)||b.isEdge(e.cell))){this.createShape(e);if(e.shape!=null){e.shape.init(e.view.getDrawPane());if(e.view.graph.ordered){this.order(e)}else{if(b.isEdge(e.cell)){this.orderEdge(e)}else{if(e.view.graph.keepEdgesInForeground&&this.firstEdge!=null){if(this.firstEdge.parentNode==e.shape.node.parentNode){e.shape.node.parentNode.insertBefore(e.shape.node,this.firstEdge)}else{this.firstEdge=null}}}}e.shape.scale=e.view.scale;this.createLabel(e);this.createOverlay(e);this.createControl(e);this.installListeners(e)}var a=e.view.graph.getSelectionCells();for(var d=0;d<a.length;d++){if(a[d]==e.cell){e.doCreateHandler=true;break}}}};mxCellRenderer.prototype.order=function(a){var l=a.view;var g=l.graph.getModel();var h=g.getParent(a.cell);var j=h.getIndex(a.cell);var k=null;while(j>0){h=g.getChildAt(h,j-1);k=l.getState(h);if(k!=null){break}j--}if(k!=null){var d=g.getChildCount(h);while(d>0){k=null;var e=g.getChildAt(h,d-1);var f=l.getState(e);if(f==null){break}else{k=f}h=e;d=g.getChildCount(h)}}if(k==null){k=l.getState(h)}var b=null;if(k!=null&&k.shape!=null){if(k.text!=null){b=k.text.node}if(b==null||b.parentNode==k.shape.node||b.parentNode!=k.shape.node.parentNode){b=k.shape.node}if(b!=null){b=b.nextSibling}}else{b=a.shape.node.parentNode.firstChild}if(b!=null){b.parentNode.insertBefore(a.shape.node,b)}};mxCellRenderer.prototype.orderEdge=function(h){var b=h.view;var d=b.graph.getModel();if(b.graph.keepEdgesInForeground){var f=h.shape.node;if(this.firstEdge==null||this.firstEdge.parentNode==null||this.firstEdge.parentNode!=h.shape.node.parentNode){this.firstEdge=h.shape.node}}else{if(b.graph.keepEdgesInBackground){var f=h.shape.node;var e=f.parentNode;var a=d.getParent(h.cell);var g=b.getState(a);if(g!=null&&g.shape!=null&&g.shape.node!=null){var j=g.shape.node.nextSibling;if(j!=null&&j!=f){e.insertBefore(f,j)}}else{var j=e.firstChild;if(j!=null&&j!=f){e.insertBefore(f,j)}}}}};mxCellRenderer.prototype.createShape=function(f){if(f.style!=null){var e=f.view.graph;var d=e.getModel().isEdge(f.cell);var a=f.style[mxConstants.STYLE_SHAPE];var b=(a!=null)?this.shapes[a]:null;if(b==null){if(d){b=mxPolyline}else{b=mxRectangleShape}}f.shape=new b();if(d){f.shape.points=f.absolutePoints}else{f.shape.bounds=new mxRectangle(f.x,f.y,f.width,f.height)}f.shape.dialect=f.view.graph.dialect;this.configureShape(f)}};mxCellRenderer.prototype.postConfigureShape=function(a){if(a.shape!=null){this.resolveColor(a,"indicatorColor",mxConstants.STYLE_FILLCOLOR);this.resolveColor(a,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR);this.resolveColor(a,"fill",mxConstants.STYLE_FILLCOLOR);this.resolveColor(a,"stroke",mxConstants.STYLE_STROKECOLOR);this.resolveColor(a,"gradient",mxConstants.STYLE_GRADIENTCOLOR)}};mxCellRenderer.prototype.resolveColor=function(f,h,a){var e=f.shape[h];var d=f.view.graph;var g=null;if(e=="inherit"){g=d.model.getParent(f.cell)}else{if(e=="swimlane"){if(d.model.getTerminal(f.cell,false)!=null){g=d.model.getTerminal(f.cell,false)}else{g=f.cell}g=d.getSwimlane(g);a=d.swimlaneIndicatorColorAttribute}else{if(e=="indicated"){f.shape[h]=f.shape.indicatorColor}}}if(g!=null){var b=d.getView().getState(g);f.shape[h]=null;if(b!=null){if(b.shape!=null&&h!="indicatorColor"){f.shape[h]=b.shape[h]}else{f.shape[h]=b.style[a]}}}};mxCellRenderer.prototype.configureShape=function(e){e.shape.apply(e);var f=e.view.graph.getImage(e);if(f!=null){e.shape.image=f}var a=e.view.graph.getIndicatorColor(e);var b=e.view.graph.getIndicatorShape(e);var d=(b!=null)?this.shapes[b]:null;if(a!=null){e.shape.indicatorShape=d;e.shape.indicatorColor=a;e.shape.indicatorGradientColor=e.view.graph.getIndicatorGradientColor(e)}else{var a=e.view.graph.getIndicatorImage(e);if(a!=null){e.shape.indicatorImage=a}}this.postConfigureShape(e)};mxCellRenderer.prototype.getLabelValue=function(d){var b=d.view.graph;var a=b.getLabel(d.cell);if(!b.isHtmlLabel(d.cell)&&(a!=null&&!mxUtils.isNode(a))&&mxClient.IS_IE){a=mxUtils.htmlEntities(a,false)}return a};mxCellRenderer.prototype.createLabel=function(f){var e=f.view.graph;var d=e.getModel().isEdge(f.cell);if(f.style[mxConstants.STYLE_FONTSIZE]>0||f.style[mxConstants.STYLE_FONTSIZE]==null){var b=this.getLabelValue(f);if(d&&(b==null||b.length==0)){return}var g=(e.isHtmlLabel(f.cell)||(b!=null&&mxUtils.isNode(b)))&&e.dialect==mxConstants.DIALECT_SVG;var a=f.style[mxConstants.STYLE_HORIZONTAL]==false;f.text=new mxText(b,new mxRectangle(),f.style[mxConstants.STYLE_ALIGN],e.getVerticalAlign(f),f.style[mxConstants.STYLE_FONTCOLOR],f.style[mxConstants.STYLE_FONTFAMILY],f.style[mxConstants.STYLE_FONTSIZE],f.style[mxConstants.STYLE_FONTSTYLE],f.style[mxConstants.STYLE_SPACING],f.style[mxConstants.STYLE_SPACING_TOP],f.style[mxConstants.STYLE_SPACING_RIGHT],f.style[mxConstants.STYLE_SPACING_BOTTOM],f.style[mxConstants.STYLE_SPACING_LEFT],a,f.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],f.style[mxConstants.STYLE_LABEL_BORDERCOLOR],d,d||g,e.isWrapping(f.cell),e.isClipping(f.cell));f.text.opacity=f.style[mxConstants.STYLE_TEXT_OPACITY];f.text.dialect=(g)?mxConstants.DIALECT_STRICTHTML:f.view.graph.dialect;this.initializeLabel(f)}};mxCellRenderer.prototype.initializeLabel=function(d){var b=d.view.graph;if(d.text.dialect!=mxConstants.DIALECT_SVG){if(b.dialect==mxConstants.DIALECT_SVG){var a=b.container;var e=a.style.overflow;d.text.isAbsolute=true;d.text.init(a);a.style.overflow=e;return}else{if(mxUtils.isVml(d.view.getDrawPane())){if(d.shape.label!=null){d.text.init(d.shape.label)}else{d.text.init(d.shape.node)}return}}}d.text.init(d.view.getDrawPane());d.text.isAbsolute=true;if(d.shape!=null&&d.text!=null){d.shape.node.parentNode.insertBefore(d.text.node,d.shape.node.nextSibling)}};mxCellRenderer.prototype.createOverlay=function(f){var e=f.view.graph;var d=e.getOverlays(f.cell);if(d!=null){f.overlays=new Array();for(var b=0;b<d.length;b++){var a=new mxImageShape(new mxRectangle(),d[b].image.src);a.dialect=f.view.graph.dialect;a.init(f.view.getOverlayPane());a.node.style.cursor="help";this.installOverlayListeners(f,d[b],a);f.overlays.push(a)}}};mxCellRenderer.prototype.installOverlayListeners=function(d,b,a){mxEvent.addListener(a.node,"click",function(e){b.dispatchEvent("click",b,e,d.cell)});mxEvent.addListener(a.node,"mousedown",function(e){mxEvent.consume(e)});mxEvent.addListener(a.node,"mousemove",function(e){d.view.graph.dispatchGraphEvent("mousemove",e,d.cell,b)})};mxCellRenderer.prototype.createControl=function(g){var f=g.view.graph;var h=f.getFoldingImage(g);if(f.foldingEnabled&&h!=null){var a=new mxRectangle(0,0,h.width,h.height);g.control=new mxImageShape(a,h.src);g.control.dialect=g.view.graph.dialect;var j=f.isHtmlLabel(g.cell)&&g.view.graph.dialect==mxConstants.DIALECT_SVG;if(j){g.control.dialect=mxConstants.DIALECT_PREFERHTML;g.control.init(f.container);g.control.node.style.zIndex=1}else{g.control.init(g.view.getOverlayPane())}var e=g.control.innerNode||g.control.node;if(f.isEnabled()){e.style.cursor="pointer"}mxEvent.addListener(e,"click",function(b){if(f.isEnabled()){var k=new Array();k[0]=g.cell;if(f.isCellCollapsed(g.cell)){f.expand(k)}else{f.collapse(k)}mxEvent.consume(b)}});mxEvent.addListener(e,"mousedown",function(b){f.dispatchGraphEvent("mousedown",b,g.cell);mxEvent.consume(b)});var d=this;mxEvent.addListener(e,"mousemove",function(b){f.dispatchGraphEvent("mousemove",b,g.cell,mxResources.get(d.collapseExpandResource)||d.collapseExpandResource)})}};mxCellRenderer.prototype.installListeners=function(d){var b=d.view.graph;if(b.dialect==mxConstants.DIALECT_SVG){var a="all";if(b.getModel().isEdge(d.cell)&&d.shape.stroke!=null&&d.shape.fill==null){a="visibleStroke"}if(d.shape.innerNode!=null){d.shape.innerNode.setAttribute("pointer-events",a)}else{d.shape.node.setAttribute("pointer-events",a)}}var e=b.getCursorForCell(d.cell);if(e!=null||b.isEnabled()){if(e==null){if(b.getModel().isEdge(d.cell)){e="pointer"}else{if(b.isMovable(d.cell)){e="move"}}}if(d.shape.innerNode!=null&&!b.getModel().isEdge(d.cell)){d.shape.innerNode.style.cursor=e}else{d.shape.node.style.cursor=e}}mxEvent.addListener(d.shape.node,"mousedown",function(f){if(d.shape!=null&&mxEvent.getSource(f)==d.shape.content){b.dispatchGraphEvent("mousedown",f)}else{b.dispatchGraphEvent("mousedown",f,d.cell)}});mxEvent.addListener(d.shape.node,"mousemove",function(f){if(d.shape!=null&&mxEvent.getSource(f)==d.shape.content){b.dispatchGraphEvent("mousemove",f)}else{b.dispatchGraphEvent("mousemove",f,d.cell)}});mxEvent.addListener(d.shape.node,"mouseup",function(f){if(d.shape!=null&&mxEvent.getSource(f)==d.shape.content){b.dispatchGraphEvent("mouseup",f)}else{b.dispatchGraphEvent("mouseup",f,d.cell)}});mxEvent.addListener(d.shape.node,"dblclick",function(f){if(d.shape!=null&&mxEvent.getSource(f)==d.shape.content){b.dblClick(f)}else{b.dblClick(f,d.cell)}mxEvent.consume(f)});if(d.text!=null){var e=b.getCursorForCell(d.cell);if(e!=null||(b.isEnabled()&&b.isMovable(d.cell))){d.text.node.style.cursor=e||"move"}mxEvent.addListener(d.text.node,"mousedown",function(f){if(b.getModel().isEdge(d.cell)&&b.isCellSelected(d.cell)){b.dispatchGraphEvent("mousedown",f,d.cell,mxEdgeHandler.prototype.LABEL_INDEX)}else{b.dispatchGraphEvent("mousedown",f,d.cell)}});mxEvent.addListener(d.text.node,"mousemove",function(f){b.dispatchGraphEvent("mousemove",f,d.cell)});mxEvent.addListener(d.text.node,"mouseup",function(f){b.dispatchGraphEvent("mouseup",f,d.cell)});mxEvent.addListener(d.text.node,"dblclick",function(f){b.dblClick(f,d.cell);mxEvent.consume(f)})}};mxCellRenderer.prototype.redrawLabel=function(f){if(f.text!=null){var e=f.view.graph;var b=e.isWrapping(f.cell);var g=e.isClipping(f.cell);var d=this.getLabelValue(f);var a=this.getLabelBounds(f);if(f.text.value!=d||f.text.isWrapping!=b||f.text.isClipping!=g||f.text.scale!=f.view.scale||!mxUtils.equals(a,f.text.bounds)){f.text.value=d;f.text.bounds=a;f.text.scale=f.view.scale;f.text.isWrapping=b;f.text.isClipping=g;f.text.redraw()}}};mxCellRenderer.prototype.getLabelBounds=function(g){var f=g.view.graph;var e=f.getModel().isEdge(g.cell);var d=new mxRectangle(g.absoluteOffset.x,g.absoluteOffset.y);if(!e){d.x+=g.shape.bounds.x;d.y+=g.shape.bounds.y;d.width=Math.max(1,g.shape.bounds.width);d.height=Math.max(1,g.shape.bounds.height);var b=g.style[mxConstants.STYLE_HORIZONTAL]==false;if(f.isSwimlane(g.cell)){var h=f.view.scale;var a=(parseInt(g.style[mxConstants.STYLE_STARTSIZE])||0)*h;if(b){d.width=a}else{d.height=a}}}return d};mxCellRenderer.prototype.redrawOverlays=function(g){var d=g.view.graph.getOverlays(g.cell);var a=(g.overlays!=null)?g.overlays.length:0;var f=(d!=null)?d.length:0;if(a!=f){if(a>0){for(var b=0;b<g.overlays.length;b++){g.overlays[b].destroy()}g.overlays=null}if(f>0){this.createOverlay(g)}}if(g.overlays!=null){for(var b=0;b<d.length;b++){var e=d[b].getBounds(g);if(e!=null){g.overlays[b].bounds=e;g.overlays[b].scale=g.view.scale;g.overlays[b].redraw()}}}};mxCellRenderer.prototype.redrawControl=function(e){if(e.control!=null){var d=e.view.graph.getModel().isEdge(e.cell);var a=e.view.scale;var b=(d)?new mxRectangle(e.x+e.width/2-4*a,e.y+e.height/2-4*a,9*a,9*a):new mxRectangle(e.x+4*a,e.y+4*a,9*a,9*a);e.control.bounds=b;e.control.scale=a;e.control.redraw()}};mxCellRenderer.prototype.redraw=function(g){var f=g.view.graph.getModel().isEdge(g.cell);if(g.shape!=null){if(this.checkStyleChanged){var e=g.view.graph.getCellStyle(g.cell);var d=false;if(e.length==g.style.length){for(var a in e){if(e[a]!=g.style[a]){d=true;break}}}else{d=true}if(d){g.style=e;g.shape.apply(g);g.shape.reconfigure()}}var b=g.view.scale;if(!mxUtils.equals(g,g.shape.bounds)||g.shape.scale!=b||f){if(f){g.shape.points=g.absolutePoints;g.shape.bounds=new mxRectangle(g.x,g.y,g.width,g.height)}else{g.shape.bounds=new mxRectangle(g.x,g.y,g.width,g.height)}g.shape.scale=b;g.shape.redraw()}this.redrawLabel(g);this.redrawOverlays(g);this.redrawControl(g)}if(g.doCreateHandler){delete g.doCreateHandler;g.view.graph.createHandler(g)}if(g.view.graph.hasHandler(g)){g.view.graph.redrawHandler(g)}};mxCellRenderer.prototype.destroy=function(b){if(b.shape!=null){if(b.text!=null){b.text.destroy();b.text=null}if(b.overlays!=null){for(var a=0;a<b.overlays.length;a++){b.overlays[a].destroy()}b.overlays=null}if(b.control!=null){b.control.destroy();b.control=null}b.shape.destroy();b.shape=null}};var mxEdgeStyle={EntityRelation:function(j,q,y,s,n){var e=j.view.graph;var d=mxUtils.getValue(j.style,mxConstants.STYLE_STARTSIZE,mxConstants.ENTITY_SEGMENT)*j.view.scale;var u=false;if(q!=null){var p=e.getCellGeometry(q.cell);if(p.relative){u=p.x<=0.5}else{if(y!=null){u=y.x+y.width<q.x}}}else{var w=j.absolutePoints[0];if(w==null){return}q=new mxCellState();q.x=w.x;q.y=w.y}var h=true;if(y!=null){var f=e.getCellGeometry(y.cell);if(f.relative){h=f.x<=0.5}else{if(q!=null){h=q.x+q.width<y.x}}}else{var z=j.absolutePoints;var w=z[z.length-1];if(w==null){return}y=new mxCellState();y.x=w.x;y.y=w.y}var v=(u)?q.x:q.x+q.width;var g=q.getRoutingCenterY();var r=(h)?y.x:y.x+y.width;var b=y.getRoutingCenterY();var t=d;var o=(u)?-t:t;var k=new mxPoint(v+o,g);o=(h)?-t:t;var a=new mxPoint(r+o,b);if(u==h){var l=(u)?Math.min(v,r)-d:Math.max(v,r)+d;n.push(new mxPoint(l,g));n.push(new mxPoint(l,b))}else{if((k.x<a.x)==u){var m=g+(b-g)/2;n.push(k);n.push(new mxPoint(k.x,m));n.push(new mxPoint(a.x,m));n.push(a)}else{n.push(k);n.push(a)}}},Loop:function(b,a,d,h,o){var f=b.view;var j=f.graph;var n=(h!=null)?h[0]:null;var m=f.scale;if(n!=null){n=new mxPoint(m*(f.translate.x+n.x+b.origin.x),m*(f.translate.y+n.y+b.origin.y));if(mxUtils.contains(a,n.x,n.y)){n=null}}var g=0;var l=0;var e=a.getRoutingCenterY();var k=m*j.gridSize;if(n==null||n.x<a.x||n.x>a.x+a.width){if(n!=null){g=n.x;k=Math.max(Math.abs(e-n.y),k)}else{g=a.x+a.width+2*k}}else{if(n!=null){g=a.getRoutingCenterX();l=Math.max(Math.abs(g-n.x),k);e=n.y;k=0}}o.push(new mxPoint(g-l,e-k));o.push(new mxPoint(g+l,e+k))},ElbowConnector:function(d,b,h,m,o){var n=(m!=null)?m[0]:null;var g=false;var e=false;if(b!=null&&h!=null){if(n!=null){var f=Math.min(b.x,h.x);var l=Math.max(b.x+b.width,h.x+h.width);var k=Math.min(b.y,h.y);var a=Math.max(b.y+b.height,h.y+h.height);var j=d.view;n=new mxPoint(j.scale*(j.translate.x+n.x+d.origin.x),j.scale*(j.translate.y+n.y+d.origin.y));g=n.y<k||n.y>a;e=n.x<f||n.x>l}else{var f=Math.max(b.x,h.x);var l=Math.min(b.x+b.width,h.x+h.width);g=f==l;if(!g){var k=Math.max(b.y,h.y);var a=Math.min(b.y+b.height,h.y+h.height);e=k==a}}}if(!e&&(g||d.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)){mxEdgeStyle.TopToBottom(d,b,h,m,o)}else{mxEdgeStyle.SideToSide(d,b,h,m,o)}},SideToSide:function(e,d,h,p,v){var u=(p!=null)?p[0]:null;if(u!=null){var m=e.view;u=new mxPoint(m.scale*(m.translate.x+u.x+e.origin.x),m.scale*(m.translate.y+u.y+e.origin.y))}if(d==null){var g=e.absolutePoints[0];if(g==null){return}d=new mxCellState();d.x=g.x;d.y=g.y}if(h==null){var s=e.absolutePoints;var g=s[s.length-1];if(g==null){return}h=new mxCellState();h.x=g.x;h.y=g.y}var f=Math.max(d.x,h.x);var a=Math.min(d.x+d.width,h.x+h.width);var o=(u!=null)?u.x:a+(f-a)/2;var n=d.getRoutingCenterY();var k=h.getRoutingCenterY();if(u!=null){if(u.y>=d.y&&u.y<=d.y+d.height){n=u.y}if(u.y>=h.y&&u.y<=h.y+h.height){k=u.y}}if(!mxUtils.contains(h,o,n)&&!mxUtils.contains(d,o,n)){v.push(new mxPoint(o,n))}if(!mxUtils.contains(h,o,k)&&!mxUtils.contains(d,o,k)){v.push(new mxPoint(o,k))}if(v.length==1){if(u!=null){if(!mxUtils.contains(h,o,u.y)&&!mxUtils.contains(d,o,u.y)){v.push(new mxPoint(o,u.y))}}else{var q=Math.max(d.y,h.y);var j=Math.min(d.y+d.height,h.y+h.height);v.push(new mxPoint(o,q+(j-q)/2))}}},TopToBottom:function(e,d,h,o,u){var s=(o!=null)?o[0]:null;if(s!=null){var m=e.view;s=new mxPoint(m.scale*(m.translate.x+s.x+e.origin.x),m.scale*(m.translate.y+s.y+e.origin.y))}if(d==null){var g=e.absolutePoints[0];if(g==null){return}d=new mxCellState();d.x=g.x;d.y=g.y}if(h==null){var q=e.absolutePoints;var g=q[q.length-1];if(g==null){return}h=new mxCellState();h.x=g.x;h.y=g.y}var p=Math.max(d.y,h.y);var k=Math.min(d.y+d.height,h.y+h.height);var n=d.getRoutingCenterX();if(s!=null&&s.x>=d.x&&s.x<=d.x+d.width){n=s.x}var j=(s!=null)?s.y:k+(p-k)/2;if(!mxUtils.contains(h,n,j)&&!mxUtils.contains(d,n,j)){u.push(new mxPoint(n,j))}if(s!=null&&s.x>=h.x&&s.x<=h.x+h.width){n=s.x}else{n=h.getRoutingCenterX()}if(!mxUtils.contains(h,n,j)&&!mxUtils.contains(d,n,j)){u.push(new mxPoint(n,j))}if(u.length==1){if(s!=null&&u.length==1){if(!mxUtils.contains(h,s.x,j)&&!mxUtils.contains(d,s.x,j)){u.push(new mxPoint(s.x,j))}}else{var f=Math.max(d.x,h.x);var a=Math.min(d.x+d.width,h.x+h.width);u.push(new mxPoint(f+(a-f)/2,j))}}}};function mxGraphView(a){this.graph=a;this.translate=new mxPoint();this.bounds=new mxRectangle();this.states=new mxDictionary()}mxGraphView.prototype=new mxEventSource();mxGraphView.prototype.constructor=mxGraphView;mxGraphView.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphView.prototype.updatingDocumentResource=(mxClient.language!="none")?"updatingDocument":"";mxGraphView.prototype.graph=null;mxGraphView.prototype.currentRoot=null;mxGraphView.prototype.captureDocumentGesture=true;mxGraphView.prototype.bounds=null;mxGraphView.prototype.scale=1;mxGraphView.prototype.translate=null;mxGraphView.prototype.getBounds=function(b){var a=null;if(b!=null&&b.length>0){for(var d=0;d<b.length;d++){var e=this.getState(b[d]);if(e!=null){if(a==null){a=new mxRectangle(e.x,e.y,e.width,e.height)}else{a.add(e)}}}}return a};mxGraphView.prototype.setCurrentRoot=function(a){if(this.currentRoot!=a){var d=new mxCurrentRootChange(this,a);d.execute();var b=new mxUndoableEdit(this,false);b.add(d);this.dispatchEvent("undo",this,b);this.graph.sizeDidChange()}return a};mxGraphView.prototype.scaleAndTranslate=function(g,e,d){var f=this.scale;var b=this.translate.x;var a=this.translate.y;if(this.scale!=g||this.translate.x!=e||this.translate.y!=d){this.scale=g;this.translate.x=e;this.translate.y=d;this.revalidate();this.graph.sizeDidChange()}this.dispatchEvent("scaleAndTranslate",this,f,g,b,a,e,d)};mxGraphView.prototype.getScale=function(){return this.scale};mxGraphView.prototype.setScale=function(b){var a=this.scale;if(this.scale!=b){this.scale=b;this.revalidate();this.graph.sizeDidChange()}this.dispatchEvent("scale",this,a,b)};mxGraphView.prototype.getTranslate=function(){return this.translate};mxGraphView.prototype.setTranslate=function(e,d){var b=this.translate.x;var a=this.translate.y;if(this.translate.x!=e||this.translate.y!=d){this.translate.x=e;this.translate.y=d;this.revalidate();this.graph.sizeDidChange()}this.dispatchEvent("translate",this,b,a,e,d)};mxGraphView.prototype.refresh=function(){if(this.currentRoot!=null){this.clear()}this.revalidate()};mxGraphView.prototype.revalidate=function(){this.invalidate();this.validate()};mxGraphView.prototype.clear=function(a,g,f){var d=this.graph.getModel();a=a||d.getRoot();g=(g!=null)?g:false;f=(f!=null)?f:true;this.removeState(a);if(f&&(g||a!=this.currentRoot)){var b=d.getChildCount(a);for(var e=0;e<b;e++){this.clear(d.getChildAt(a,e),g)}}else{this.invalidate(a)}};mxGraphView.prototype.invalidate=function(a){var d=this.graph.getModel();a=a||d.getRoot();var f=this.getState(a);if(f==null||!f.invalid){if(f!=null){f.invalid=true}var b=d.getChildCount(a);for(var e=0;e<b;e++){var h=d.getChildAt(a,e);this.invalidate(h)}var g=d.getEdgeCount(a);for(var e=0;e<g;e++){this.invalidate(d.getEdgeAt(a,e))}}};mxGraphView.prototype.validate=function(a){var b=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;a=a||((this.currentRoot!=null)?this.currentRoot:this.graph.getModel().getRoot());this.validateBounds(null,a);this.bounds=this.validatePoints(null,a);this.validateBackground();window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",b)};mxGraphView.prototype.validateBackground=function(){var a=this.graph.getBackgroundImage();if(a!=null){if(this.backgroundImage==null||this.backgroundImage.image!=a.src){if(this.backgroundImage!=null){this.backgroundImage.destroy()}var b=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(b,a.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane)}this.redrawBackground(this.backgroundImage,a)}else{if(this.backgroundImage!=null){this.backgroundImage.destroy();this.backgroundImage=null}}};mxGraphView.prototype.redrawBackground=function(b,a){b.scale=this.scale;b.bounds.x=this.scale*this.translate.x;b.bounds.y=this.scale*this.translate.y;b.bounds.width=this.scale*a.width;b.bounds.height=this.scale*a.height;b.redraw()};mxGraphView.prototype.validateBounds=function(j,k){var h=this.graph.getModel();var a=this.getState(k,true);if(a!=null&&a.invalid){if(!this.graph.isCellVisible(k)){this.removeState(k)}else{if(k!=this.currentRoot&&j!=null){a.origin.x=j.origin.x;a.origin.y=j.origin.y;var f=this.graph.getCellGeometry(k);if(f!=null){if(!h.isEdge(k)){var d=f.offset||new mxPoint();if(f.relative){a.origin.x+=f.x*j.width/this.scale+d.x;a.origin.y+=f.y*j.height/this.scale+d.y}else{a.absoluteOffset.x=this.scale*d.x;a.absoluteOffset.y=this.scale*d.y;a.origin.x+=f.x;a.origin.y+=f.y}}a.x=this.scale*(this.translate.x+a.origin.x);a.y=this.scale*(this.translate.y+a.origin.y);a.width=this.scale*f.width;a.height=this.scale*f.height;if(h.isVertex(k)){this.updateVertexLabelOffset(a)}}}}var d=this.graph.getChildOffsetForCell(k);if(d!=null){a.origin.x+=d.x;a.origin.y+=d.y}}if(a!=null&&(!this.graph.isCellCollapsed(k)||k==this.currentRoot)){var e=h.getChildCount(k);for(var g=0;g<e;g++){var b=h.getChildAt(k,g);this.validateBounds(a,b)}}};mxGraphView.prototype.updateVertexLabelOffset=function(d){var a=mxUtils.getValue(d.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(a==mxConstants.ALIGN_LEFT){d.absoluteOffset.x-=d.width}else{if(a==mxConstants.ALIGN_RIGHT){d.absoluteOffset.x+=d.width}}var b=mxUtils.getValue(d.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(b==mxConstants.ALIGN_TOP){d.absoluteOffset.y-=d.height}else{if(b==mxConstants.ALIGN_BOTTOM){d.absoluteOffset.y+=d.height}}};mxGraphView.prototype.validatePoints=function(a,b){var r=null;var o=null;var q=0;var n=0;var d=this.graph.getModel();var e=this.getState(b);if(e!=null){if(e.invalid){var v=this.graph.getCellGeometry(b);if(d.isEdge(b)){var k=this.getVisibleTerminal(b,true);if(k!=null&&!d.isAncestor(k,b)){var j=d.getParent(k);var u=this.getState(j);this.validatePoints(u,k)}var t=this.getVisibleTerminal(b,false);if(t!=null&&!d.isAncestor(t,b)){var j=d.getParent(t);var u=this.getState(j);this.validatePoints(u,t)}this.setTerminalPoints(e);this.updatePoints(e,v.points,k,t);this.updateTerminalPoints(e,k,t);this.updateEdgeBounds(e);this.updateEdgeLabelOffset(e)}else{if(v!=null&&v.relative&&a!=null&&d.isEdge(a.cell)){var s=this.getPoint(a,v);if(s!=null){e.x=s.x;e.y=s.y}}}e.invalid=false;if(b!=this.currentRoot){this.graph.cellRenderer.redraw(e)}}if(d.isEdge(b)||d.isVertex(b)){var h=(e.text!=null&&(!this.graph.isHtmlLabel(b)||!this.graph.isClipping(b)))?e.text.boundingBox:null;if(h!=null){r=Math.min(e.x,h.x);o=Math.min(e.y,h.y);q=Math.max(e.x+e.width,h.x+h.width);n=Math.max(e.y+e.height,h.y+h.height)}else{r=e.x;o=e.y;q=e.x+e.width;n=e.y+e.height}}}if(e!=null&&(!this.graph.isCellCollapsed(b)||b==this.currentRoot)){var m=d.getChildCount(b);for(var l=0;l<m;l++){var f=d.getChildAt(b,l);var g=this.validatePoints(e,f);r=(r!=null)?Math.min(r,g.x):g.x;o=(o!=null)?Math.min(o,g.y):g.y;q=Math.max(q,g.x+g.width);n=Math.max(n,g.y+g.height)}}return new mxRectangle(r,o,q-r,n-o)};mxGraphView.prototype.setTerminalPoints=function(e){var d=this.translate;var a=this.scale;var b=e.cell;var h=e.origin;var g=this.graph.getCellGeometry(b);var f=g.getTerminalPoint(true);if(f!=null){f=new mxPoint(a*(d.x+f.x+h.x),a*(d.y+f.y+h.y));e.setAbsoluteTerminalPoint(f,true)}else{e.setAbsoluteTerminalPoint(null,true)}f=g.getTerminalPoint(false);if(f!=null){f=new mxPoint(a*(d.x+f.x+h.x),a*(d.y+f.y+h.y));e.setAbsoluteTerminalPoint(f,false)}else{e.setAbsoluteTerminalPoint(null,false)}};mxGraphView.prototype.updatePoints=function(d,k,b,j){if(d!=null){var m=new Array();m.push(d.absolutePoints[0]);var h=this.getEdgeStyle(d,b,j);if(h!=null){var a=this.getState(b);var e=this.getState(j);h(d,a,e,k,m)}else{if(k!=null){for(var g=0;g<k.length;g++){var l=mxUtils.clone(k[g]);l.x+=this.translate.x+d.origin.x;l.y+=this.translate.y+d.origin.y;l.x*=this.scale;l.y*=this.scale;m.push(l)}}}var f=d.absolutePoints;m.push(f[f.length-1]);d.absolutePoints=m}};mxGraphView.prototype.getEdgeStyle=function(a,b,d){return(b!=null&&b==d)?mxUtils.getValue(a.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):(!mxUtils.getValue(a.style,mxConstants.STYLE_NOEDGESTYLE,false)?a.style[mxConstants.STYLE_EDGE]:null)};mxGraphView.prototype.updateTerminalPoints=function(b,a,d){if(d!=null){this.updateTerminalPoint(b,d,a,false)}if(a!=null){this.updateTerminalPoint(b,a,d,true)}};mxGraphView.prototype.updateTerminalPoint=function(d,f,a,b){var e=this.getPerimeterPoint(d,f,a,b);d.setAbsoluteTerminalPoint(e,b)};mxGraphView.prototype.getPerimeterPoint=function(b,d,f,h){var k=null;var e=this.getState(d);if(e!=null){var j=this.getPerimeterFunction(e);var g=this.getNextPoint(b,f,h);if(j!=null&&g!=null){var a=this.getPerimeterBounds(e,b,h);k=j(a,b,e,h,g)}if(k==null){k=this.getPoint(e)}}return k};mxGraphView.prototype.getPerimeterBounds=function(d,e,b){var a=0;if(e!=null){a=parseFloat(e.style[mxConstants.STYLE_PERIMETER_SPACING]||0);a+=parseFloat(e.style[(b)?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0)}if(d!=null){a+=parseFloat(d.style[mxConstants.STYLE_PERIMETER_SPACING]||0)}return d.getPerimeterBounds(a*this.scale)};mxGraphView.prototype.getPerimeterFunction=function(a){return a.style[mxConstants.STYLE_PERIMETER]};mxGraphView.prototype.getNextPoint=function(f,g,d){var a=null;var h=f.absolutePoints;if(h!=null&&(d||h.length>2||g==null)){var e=h.length;a=h[(d)?Math.min(1,e-1):Math.max(0,e-2)]}if(a==null&&g!=null){var b=this.getState(g);if(b!=null){a=new mxPoint(b.getCenterX(),b.getCenterY())}}return a};mxGraphView.prototype.getVisibleTerminal=function(e,d){var b=this.graph.getModel();var a=b.getTerminal(e,d);var f=a;while(a!=null&&a!=this.currentRoot){if(!this.graph.isCellVisible(f)||this.graph.isCellCollapsed(a)){f=a}a=b.getParent(a)}return f};mxGraphView.prototype.updateEdgeBounds=function(d){var o=d.absolutePoints;d.length=0;if(o!=null&&o.length>0){var p=o[0];var m=o[o.length-1];if(p==null||m==null){this.clear(d.cell,true)}else{if(p.x!=m.x||p.y!=m.y){var s=m.x-p.x;var q=m.y-p.y;d.terminalDistance=Math.sqrt(s*s+q*q)}else{d.terminalDistance=0}var e=0;var k=new Array();var r=p;if(r!=null){var g=r.x;var f=r.y;var b=g;var a=f;for(var j=1;j<o.length;j++){var h=o[j];if(h!=null){var s=r.x-h.x;var q=r.y-h.y;var l=Math.sqrt(s*s+q*q);k.push(l);e+=l;r=h;g=Math.min(r.x,g);f=Math.min(r.y,f);b=Math.max(r.x,b);a=Math.max(r.y,a)}}d.length=e;d.segments=k;var n=1;d.x=g;d.y=f;d.width=Math.max(n,b-g);d.height=Math.max(n,a-f)}}}};mxGraphView.prototype.getPoint=function(e,f){var k=e.getCenterX();var j=e.getCenterY();if(e.segments!=null&&(f==null||f.relative)){var o=(f!=null)?f.x/2:0;var u=e.absolutePoints.length;var q=(o+0.5)*e.length;var a=e.segments[0];var d=0;var h=1;while(q>d+a&&h<u-1){d+=a;a=e.segments[h++]}if(a!=0){var p=(q-d)/a;var b=e.absolutePoints[h-1];var w=e.absolutePoints[h];if(b!=null&&w!=null){var n=0;var s=0;var r=0;if(f!=null){n=f.y;var g=f.offset;if(g!=null){s=g.x;r=g.y}}var m=w.x-b.x;var l=w.y-b.y;var v=l/a;var t=m/a;k=b.x+m*p+(v*n+s)*this.scale;j=b.y+l*p-(t*n-r)*this.scale}}}else{if(f!=null){var g=f.offset;if(g!=null){k+=g.x;j+=g.y}}}return new mxPoint(k,j)};mxGraphView.prototype.getRelativePoint=function(t,l,k){var f=this.graph.getModel();var h=f.getGeometry(t.cell);var H=this.graph.getView().scale;if(h!=null){var C=t.absolutePoints.length;if(h.relative&&C>1){var m=t.length;var u=t.segments;var b=t.absolutePoints[0];var G=t.absolutePoints[1];var a=mxUtils.ptSegDistSq(b.x,b.y,G.x,G.y,l,k);var j=0;var D=0;var g=0;for(var v=2;v<C;v++){D+=u[v-2];G=t.absolutePoints[v];var s=mxUtils.ptSegDistSq(b.x,b.y,G.x,G.y,l,k);if(s<=a){a=s;j=v-1;g=D}b=G}var A=u[j];b=t.absolutePoints[j];G=t.absolutePoints[j+1];var w=b.x;var d=b.y;var z=G.x;var e=G.y;var q=l;var o=k;var n=w-z;var p=d-e;q-=z;o-=e;var I=0;q=n-q;o=p-o;var r=q*n+o*p;if(r<=0){I=0}else{I=r*r/(n*n+p*p)}var B=Math.sqrt(I);if(B>A){B=A}var F=Math.sqrt(mxUtils.ptSegDistSq(b.x,b.y,G.x,G.y,l,k));var E=mxUtils.relativeCcw(b.x,b.y,G.x,G.y,l,k);if(E==-1){F=-F}return new mxPoint(((m/2-g-B)/m)*-2,F/H)}}return new mxPoint()};mxGraphView.prototype.updateEdgeLabelOffset=function(a){var l=a.absolutePoints;a.absoluteOffset.x=a.getCenterX();a.absoluteOffset.y=a.getCenterY();if(l!=null&&l.length>0&&a.segments!=null){var h=this.graph.getCellGeometry(a.cell);if(h.relative){var e=this.getPoint(a,h);if(e!=null){a.absoluteOffset=e}}else{var m=l[0];var f=l[l.length-1];if(m!=null&&f!=null){var o=f.x-m.x;var n=f.y-m.y;var b=0;var k=0;var d=h.offset;if(d!=null){b=d.x;k=d.y}var j=m.x+o/2+b*this.scale;var g=m.y+n/2+k*this.scale;a.absoluteOffset.x=j;a.absoluteOffset.y=g}}}};mxGraphView.prototype.getState=function(a,b){b=b||false;var d=null;if(a!=null){d=this.states.get(a);if(d==null&&b&&this.graph.isCellVisible(a)){d=this.createState(a);this.states.put(a,d)}}return d};mxGraphView.prototype.getStates=function(b){var a=new Array();for(var d=0;d<b.length;d++){var e=this.getState(b[d]);if(e!=null){a.push(e)}}return a};mxGraphView.prototype.removeState=function(a){var b=null;if(a!=null){b=this.states.remove(a);if(b!=null){this.graph.cellRenderer.destroy(b);b.destroy()}}return b};mxGraphView.prototype.createState=function(a){var b=this.graph.getCellStyle(a);var d=new mxCellState(this,a,b);this.graph.cellRenderer.initialize(d);return d};mxGraphView.prototype.getCanvas=function(){return this.canvas};mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane};mxGraphView.prototype.getDrawPane=function(){return this.drawPane};mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane};mxGraphView.prototype.isContainerEvent=function(a){var b=mxEvent.getSource(a);var d=(this.backgroundImage!=null)?this.backgroundImage.node:null;return(b==this.graph.container||b.parentNode==d||b==this.canvas.parentNode||b==this.canvas||b==this.backgroundPane||b==this.drawPane||b==this.overlayPane)};mxGraphView.prototype.isScrollEvent=function(d){var h=mxUtils.getOffset(this.graph.container);var g=new mxPoint(d.clientX-h.x,d.clientY-h.y);var a=this.graph.container.offsetWidth;var b=this.graph.container.clientWidth;if(a>b&&g.x>b+2&&g.x<=a){return true}var f=this.graph.container.offsetHeight;var e=this.graph.container.clientHeight;if(f>e&&g.y>e+2&&g.y<=f){return true}return false};mxGraphView.prototype.init=function(){var d=this.graph;var a=d.container;if(a!=null){var b=this;mxEvent.addListener(a,"mousedown",function(e){if(b.isContainerEvent(e)&&((!mxClient.IS_IE&&!mxClient.IS_GC&&!mxClient.IS_SF)||!b.isScrollEvent(e))){d.dispatchGraphEvent("mousedown",e)}});mxEvent.addListener(a,"mousemove",function(e){if(b.isContainerEvent(e)){d.dispatchGraphEvent("mousemove",e)}});mxEvent.addListener(a,"mouseup",function(e){if(b.isContainerEvent(e)){d.dispatchGraphEvent("mouseup",e)}});mxEvent.addListener(a,"dblclick",function(e){d.dblClick(e);mxEvent.consume(e)});mxEvent.addListener(document,"mousedown",function(e){if(b.isContainerEvent(e)){d.panningHandler.hideMenu()}});mxEvent.addListener(document,"mousemove",function(e){d.tooltipHandler.hide();if(b.captureDocumentGesture&&d.gestureHandler!=null){d.dispatchGraphEvent("mousemove",e)}});mxEvent.addListener(document,"mouseup",function(e){if(b.captureDocumentGesture&&d.gestureHandler!=null){d.dispatchGraphEvent("mouseup",e)}})}if(d.dialect==mxConstants.DIALECT_SVG){this.createSvg()}else{if(d.dialect==mxConstants.DIALECT_VML){this.createVml()}else{this.createHtml()}}};mxGraphView.prototype.createHtml=function(){var a=this.graph.container;if(a!=null){this.canvas=this.createHtmlPane();this.backgroundPane=this.createHtmlPane(1,1);this.drawPane=this.createHtmlPane(1,1);this.overlayPane=this.createHtmlPane(1,1);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);a.appendChild(this.canvas)}};mxGraphView.prototype.createHtmlPane=function(b,a){var d=document.createElement("DIV");if(b!=null&&a!=null){d.style.position="absolute";d.style.left="0px";d.style.top="0px";d.style.width=b+"px";d.style.height=a+"px"}else{d.style.position="relative"}return d};mxGraphView.prototype.createVml=function(){var b=this.graph.container;if(b!=null){var d=b.offsetWidth;var a=b.offsetHeight;this.canvas=this.createVmlPane(d,a);this.backgroundPane=this.createVmlPane(d,a);this.drawPane=this.createVmlPane(d,a);this.overlayPane=this.createVmlPane(d,a);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);b.appendChild(this.canvas)}};mxGraphView.prototype.createVmlPane=function(b,a){var d=document.createElement("v:group");d.style.position="absolute";d.style.left="0px";d.style.top="0px";d.style.width=b+"px";d.style.height=a+"px";d.setAttribute("coordsize",b+","+a);d.setAttribute("coordorigin","0,0");return d};mxGraphView.prototype.createSvg=function(){var b=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);var a=document.createElementNS(mxConstants.NS_SVG,"svg");var d=this;var f=function(h){if(d.graph.container!=null){var j=d.graph.container.offsetWidth;var g=d.graph.container.offsetHeight;a.setAttribute("width",Math.max(j,d.bounds.width));a.setAttribute("height",Math.max(g,d.bounds.height))}};mxEvent.addListener(window,"resize",f);if(mxClient.IS_OP){f()}a.appendChild(this.canvas);if(b!=null){b.appendChild(a);var e=mxUtils.getCurrentStyle(b);if(e.position=="static"){b.style.position="relative"}}};mxGraphView.prototype.destroy=function(){var a=this.canvas.ownerSVGElement||this.canvas;if(a.parentNode!=null){this.clear(this.currentRoot,true);mxEvent.removeAllListeners(document);mxUtils.release(this.graph.container);a.parentNode.removeChild(a);this.canvas=null;this.backgroundPane=null;this.drawPane=null;this.overlayPane=null}};function mxCurrentRootChange(b,a){this.view=b;this.root=a;this.previous=a;this.isUp=a==null;if(!this.isUp){var e=this.view.currentRoot;var d=this.view.graph.getModel();while(e!=null){if(e==a){this.isUp=true;break}e=d.getParent(e)}}}mxCurrentRootChange.prototype.execute=function(){var b=this.view.currentRoot;this.view.currentRoot=this.previous;this.previous=b;var d=this.view.graph.getTranslateForRoot(this.view.currentRoot);if(d!=null){this.view.translate=new mxPoint(-d.x,-d.y)}var a=(this.isUp)?"up":"down";this.view.dispatchEvent(a,this.view,this.previous,this.view.currentRoot);if(this.isUp){this.view.clear(this.view.currentRoot,true);this.view.validate()}else{this.view.refresh()}this.isUp=!this.isUp};function mxGraph(a,d,e){this.renderHint=e;if(mxClient.IS_SVG){this.dialect=mxConstants.DIALECT_SVG}else{if(e=="exact"&&mxClient.IS_VML){this.dialect=mxConstants.DIALECT_VML}else{if(e=="fastest"){this.dialect=mxConstants.DIALECT_STRICTHTML}else{if(e=="faster"){this.dialect=mxConstants.DIALECT_PREFERHTML}else{this.dialect=mxConstants.DIALECT_MIXEDHTML}}}}this.model=(d!=null)?d:new mxGraphModel();this.stylesheet=new mxStylesheet();this.cellRenderer=new mxCellRenderer();this.multiplicities=new Array();this.view=new mxGraphView(this);this.selection=new mxGraphSelection(this);var b=this;this.model.addListener("change",function(f,g){b.graphModelChanged(g)});this.tooltipHandler=new mxTooltipHandler(this);this.tooltipHandler.setEnabled(false);this.panningHandler=new mxPanningHandler(this);this.panningHandler.panningEnabled=false;this.connectionHandler=new mxConnectionHandler(this);this.connectionHandler.setEnabled(false);this.graphHandler=new mxGraphHandler(this);if(a!=null){this.init(a)}this.view.revalidate()}mxResources.add(mxClient.basePath+"js/resources/graph");mxGraph.prototype=new mxEventSource();mxGraph.prototype.constructor=mxGraph;mxGraph.prototype.EMPTY_ARRAY=new Array();mxGraph.prototype.graphListeners=null;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selection=null;mxGraph.prototype.editor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=true;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=0.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;mxGraph.prototype.enabled=true;mxGraph.prototype.escapeEnabled=true;mxGraph.prototype.locked=false;mxGraph.prototype.cloneable=true;mxGraph.prototype.exportEnabled=true;mxGraph.prototype.importEnabled=true;mxGraph.prototype.foldingEnabled=true;mxGraph.prototype.editable=true;mxGraph.prototype.deletable=true;mxGraph.prototype.movable=true;mxGraph.prototype.edgeLabelsMovable=true;mxGraph.prototype.vertexLabelsMovable=false;mxGraph.prototype.dropEnabled=false;mxGraph.prototype.sizable=true;mxGraph.prototype.bendable=true;mxGraph.prototype.disconnectable=true;mxGraph.prototype.selectable=true;mxGraph.prototype.autoSize=false;mxGraph.prototype.autoLayout=true;mxGraph.prototype.bubbleLayout=true;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.border=0;mxGraph.prototype.ordered=true;mxGraph.prototype.keepEdgesInForeground=false;mxGraph.prototype.keepEdgesInBackground=true;mxGraph.prototype.keepInsideParentOnMove=true;mxGraph.prototype.extendParentOnResize=true;mxGraph.prototype.shiftDownwards=false;mxGraph.prototype.shiftRightwards=false;mxGraph.prototype.collapseToPreferredSize=true;mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=false;mxGraph.prototype.centerZoom=true;mxGraph.prototype.resetViewOnRootChange=true;mxGraph.prototype.resetEdgesOnResize=false;mxGraph.prototype.resetEdgesOnMove=false;mxGraph.prototype.allowLoops=false;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=true;mxGraph.prototype.connectableEdges=false;mxGraph.prototype.allowDanglingEdges=true;mxGraph.prototype.cloneInvalidEdges=false;mxGraph.prototype.disconnectOnMove=true;mxGraph.prototype.labelsVisible=true;mxGraph.prototype.htmlLabels=mxClient.IS_MAC&&!mxClient.IS_FF3;mxGraph.prototype.swimlaneSelectionEnabled=true;mxGraph.prototype.swimlaneNesting=true;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"warning"+((mxClient.IS_MAC)?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource=(mxClient.language!="none")?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource=(mxClient.language!="none")?"containsValidationErrors":"";mxGraph.prototype.resizeContainer=false;mxGraph.prototype.init=function(a){this.container=a;this.editor=new mxCellEditor(this);this.view.init();this.tooltipHandler.init();this.panningHandler.init();this.connectionHandler.init();this.sizeDidChange();if(mxClient.IS_IE){var b=this;mxEvent.addListener(window,"unload",function(){b.destroy()})}else{var b=this;this.focusHandler=function(d){b.activeElement=mxEvent.getSource(d)};this.blurHandler=function(d){b.activeElement=null};mxEvent.addListener(document.body,"focus",this.focusHandler);mxEvent.addListener(document.body,"blur",this.blurHandler)}};mxGraph.prototype.getModel=function(){return this.model};mxGraph.prototype.getView=function(){return this.view};mxGraph.prototype.getStylesheet=function(){return this.stylesheet};mxGraph.prototype.setStylesheet=function(a){this.stylesheet=a};mxGraph.prototype.addOverlay=function(a,b){if(a.overlays==null){a.overlays=new Array()}a.overlays.push(b);var d=this.view.getState(a);if(d!=null){this.cellRenderer.redraw(d)}this.dispatchEvent("addoverlay",this,a,b);return b};mxGraph.prototype.getOverlays=function(a){return a.overlays};mxGraph.prototype.removeOverlay=function(a,d){if(d==null){this.removeOverlays(a)}else{var b=mxUtils.indexOf(a.overlays,d);if(b>=0){a.overlays.splice(b,1);if(a.overlays.length==0){a.overlays=null}var e=this.view.getState(a);if(e!=null){this.cellRenderer.redraw(e)}this.dispatchEvent("removeoverlay",this,a,d)}else{d=null}}return d};mxGraph.prototype.removeOverlays=function(a){var d=a.overlays;if(d!=null){a.overlays=null;var e=this.view.getState(a);if(e!=null){this.cellRenderer.redraw(e)}for(var b=0;b<d.length;b++){this.dispatchEvent("removeoverlay",this,a,d[b])}}return d};mxGraph.prototype.clearOverlays=function(a){a=(a!=null)?a:this.model.getRoot();this.removeOverlays(a);var b=this.model.getChildCount(a);for(var d=0;d<b;d++){var e=this.model.getChildAt(a,d);this.clearOverlays(e)}};mxGraph.prototype.setWarning=function(a,f,d,g){if(f!=null&&f.length>0){d=(d!=null)?d:this.warningImage;var e=new mxOverlay(d,"<font color=red>"+f+"</font>");if(g){var b=this;e.addListener("click",function(j,h){b.setSelectionCell(a)})}return this.addOverlay(a,e)}else{this.removeOverlays(a)}return null};mxGraph.prototype.edit=function(a,b){a=a||this.getSelectionCell();if(a!=null&&this.isEditable(a)){this.startEditingAtCell(a,b)}};mxGraph.prototype.startEditingAtCell=function(a,b){this.dispatchEvent("startEditing",this,a,b);this.editor.startEditing(a,b)};mxGraph.prototype.getEditingValue=function(a,b){return this.convertValueToString(a)};mxGraph.prototype.labelChanged=function(a,e,d){var b=this.model.getValue(a);this.dispatchEvent("beforeLabelChanged",this,a,b,e,d);this.model.beginUpdate();try{this.model.setValue(a,e);if(this.isUpdateSize(a)){this.updateSize(a)}this.dispatchEvent("labelChanged",this,a,b,e,d)}finally{this.model.endUpdate()}this.dispatchEvent("afterLabelChanged",this,a,b,e,d)};mxGraph.prototype.escape=function(a){if(this.escapeEnabled){this.editor.stopEditing(true);this.connectionHandler.reset();this.graphHandler.reset();var b=this.getSelectionCells();for(var d=0;d<b.length;d++){var e=this.view.getState(b[d]);if(e!=null&&e.handler!=null){e.handler.reset()}}}};mxGraph.prototype.click=function(b,a){this.dispatchEvent("click",this,b,a);if(this.isEnabled()&&!mxEvent.isConsumed(b)){if(a!=null){this.selectCellForEvent(a,b)}else{var d=null;if(this.swimlaneSelectionEnabled){var e=mxUtils.convertPoint(this.container,b.clientX,b.clientY);d=this.getSwimlaneAt(e.x,e.y)}if(d!=null){this.selectCellForEvent(d,b)}else{if(!mxEvent.isToggleEvent(b)){this.clearSelection()}}}}};mxGraph.prototype.dblClick=function(b,a){this.dispatchEvent("dblclick",this,b,a);if(this.isEnabled()&&!mxEvent.isConsumed(b)&&a!=null){this.edit(a,b)}};mxGraph.prototype.graphModelChanged=function(b){for(var a=0;a<b.length;a++){this.processChange(b[a])}this.view.validate();this.sizeDidChange()};mxGraph.prototype.processChange=function(b){if(b.constructor==mxRootChange){if(this.resetViewOnRootChange){this.view.scale=1;this.view.translate.x=0;this.view.translate.y=0}this.cellRemoved(b.previous);this.clearSelection();this.dispatchEvent("root",this)}else{if(b.constructor==mxChildChange){if(b.isAdded){this.view.clear(b.child)}else{this.cellRemoved(b.child,true)}var a=this.model.getParent(b.child);if(a!=b.previous){if(a!=null){this.view.clear(a,null,false)}if(b.previous!=null){this.view.clear(b.previous,null,false)}}}else{if(b.constructor==mxTerminalChange||b.constructor==mxGeometryChange){this.view.invalidate(b.cell)}else{if(b.constructor==mxValueChange||b.constructor==mxStyleChange){this.view.clear(b.cell,null,false)}else{if(b.cell!=null&&b.cell.constructor==mxCell){this.cellRemoved(b.cell,b.constructor==mxVisibleChange)}}}}}};mxGraph.prototype.cellRemoved=function(a,e){if(a!=null){if(e&&this.isCellSelected(a)){this.selection.removeCell(a)}var b=this.model.getChildCount(a);for(var d=0;d<b;d++){this.cellRemoved(this.model.getChildAt(a,d),e)}this.view.removeState(a)}};mxGraph.prototype.sizeDidChange=function(){var k=this.getBounds();if(this.container!=null){var f=this.getBorder();var j=k.x+k.width+1+f;var a=k.y+k.height+1+f;if(this.minimumContainerSize!=null){j=Math.max(j,this.minimumContainerSize.width);a=Math.max(a,this.minimumContainerSize.height)}if(this.resizeContainer){var d=j;var g=a;if(this.maximumContainerSize!=null){d=Math.min(this.maximumContainerSize.width,d);g=Math.min(this.maximumContainerSize.height,g)}this.container.style.width=d+"px";this.container.style.height=g+"px"}j=Math.max(j,this.container.offsetWidth);a=Math.max(a,this.container.offsetHeight);if(this.dialect==mxConstants.DIALECT_SVG){var b=this.view.getDrawPane().ownerSVGElement;b.setAttribute("width",j);b.setAttribute("height",a)}else{var e=this.view.getDrawPane();e.style.width=j+"px";e.style.height=a+"px"}}this.dispatchEvent("size",this,k)};mxGraph.prototype.getCellStyle=function(a){var d=this.model.getStyle(a);var b=null;if(this.model.isEdge(a)){b=this.stylesheet.getDefaultEdgeStyle()}else{b=this.stylesheet.getDefaultVertexStyle()}if(d!=null){b=this.stylesheet.getCellStyle(d,b)}if(b==null){b=mxGraph.prototype.EMPTY_ARRAY}return b};mxGraph.prototype.setCellStyle=function(d,a){a=a||this.getSelectionCells();if(a!=null){this.model.beginUpdate();try{for(var b=0;b<a.length;b++){this.model.setStyle(a[b],d)}}finally{this.model.endUpdate()}}};mxGraph.prototype.toggleCellStyle=function(d,b,a){a=a||this.getSelectionCell();this.toggleCellStyles(d,b,[a])};mxGraph.prototype.toggleCellStyles=function(d,a,b){a=(a!=null)?a:false;b=b||this.getSelectionCells();if(b!=null&&b.length>0){var f=this.view.getState(b[0]);var e=(f!=null)?f.style:this.getCellStyle(b[0]);if(e!=null){var g=(mxUtils.getValue(e,d,a))?0:1;this.setCellStyles(d,g,b)}}};mxGraph.prototype.setCellStyles=function(b,d,a){a=a||this.getSelectionCells();mxUtils.setCellStyles(this.model,a,b,d)};mxGraph.prototype.toggleCellStyleFlags=function(d,a,b){this.setCellStyleFlags(d,a,null,b)};mxGraph.prototype.setCellStyleFlags=function(d,a,g,b){b=b||this.getSelectionCells();if(b!=null&&b.length>0){if(g==null){var f=this.view.getState(b[0]);var e=(f!=null)?f.style:this.getCellStyle(b[0]);if(e!=null){var h=parseInt(e[d]||0);g=!((h&a)==a)}}mxUtils.setCellStyleFlags(this.model,b,d,a,g)}};mxGraph.prototype.alignCells=function(f,a,e){a=a||this.getSelectionCells();if(a!=null&&a.length>1){if(e==null){for(var b=0;b<a.length;b++){var d=this.getCellGeometry(a[b]);if(d!=null&&!this.model.isEdge(a[b])){if(e==null){if(f==mxConstants.ALIGN_CENTER){e=d.x+d.width/2;break}else{if(f==mxConstants.ALIGN_RIGHT){e=d.x+d.width}else{if(f==mxConstants.ALIGN_TOP){e=d.y}else{if(f==mxConstants.ALIGN_MIDDLE){e=d.y+d.height/2;break}else{if(f==mxConstants.ALIGN_BOTTOM){e=d.y+d.height}else{e=d.x}}}}}}else{if(f==mxConstants.ALIGN_RIGHT){e=Math.max(e,d.x+d.width)}else{if(f==mxConstants.ALIGN_TOP){e=Math.min(e,d.y)}else{if(f==mxConstants.ALIGN_BOTTOM){e=Math.max(e,d.y+d.height)}else{e=Math.min(e,d.x)}}}}}}}this.model.beginUpdate();try{for(var b=0;b<a.length;b++){var d=this.getCellGeometry(a[b]);if(d!=null&&!this.model.isEdge(a[b])){d=d.clone();if(f==mxConstants.ALIGN_CENTER){d.x=e-d.width/2}else{if(f==mxConstants.ALIGN_RIGHT){d.x=e-d.width}else{if(f==mxConstants.ALIGN_TOP){d.y=e}else{if(f==mxConstants.ALIGN_MIDDLE){d.y=e-d.height/2}else{if(f==mxConstants.ALIGN_BOTTOM){d.y=e-d.height}else{d.x=e}}}}}this.model.setGeometry(a[b],d)}}}finally{this.model.endUpdate()}}};mxGraph.prototype.flip=function(b){if(b!=null){this.model.beginUpdate();try{if(this.alternateEdgeStyle!=null){var a=this.model.getStyle(b);if(a==null||a.length==0){this.model.setStyle(b,this.alternateEdgeStyle)}else{this.model.setStyle(b,null)}var d=this.model.getGeometry(b);if(d!=null){d=d.clone();d.points=new Array();this.model.setGeometry(b,d)}}this.dispatchEvent("flip",this,b)}finally{this.model.endUpdate()}}return b};mxGraph.prototype.toBack=function(a){this.setIndexForCells(a,0)};mxGraph.prototype.toFront=function(a){this.setIndexForCells(a)};mxGraph.prototype.setIndexForCells=function(b,a){b=b||this.getSelectionCells();if(b!=null){this.model.beginUpdate();try{for(var d=0;d<b.length;d++){var e=this.model.getParent(b[d]);this.model.add(e,b[d],a)}this.dispatchEvent("indexChanged",this,b,a)}finally{this.model.endUpdate()}}};mxGraph.prototype.cloneCells=function(d){var w=null;if(d!=null){var b=new Array();w=new Array();for(var t=0;t<d.length;t++){if(this.isCellCloneable(d[t])){var p=mxCellPath.create(d[t]);b[p]=d[t];w.push(d[t])}}if(w.length>0){var y=this.view.scale;var e=this.view.translate;d=w;var a=this.model.cloneCells(d,true);for(var t=0;t<d.length;t++){var v=this.model.getGeometry(a[t]);if(v!=null){var f=this.view.getState(d[t]);var x=this.view.getState(this.model.getParent(d[t]));if(f!=null&&x!=null){var o=x.origin.x;var m=x.origin.y;if(this.model.isEdge(a[t])){var z=f.absolutePoints;var k=this.model.getTerminal(d[t],true);var l=mxCellPath.create(k);while(k!=null&&b[l]==null){k=this.model.getParent(k);l=mxCellPath.create(k)}if(k==null){v.setTerminalPoint(new mxPoint(z[0].x/y-e.x,z[0].y/y-e.y),true)}var u=this.model.getTerminal(d[t],false);var h=mxCellPath.create(u);while(u!=null&&b[h]==null){u=this.model.getParent(u);h=mxCellPath.create(u)}if(u==null){var q=z.length-1;v.setTerminalPoint(new mxPoint(z[q].x/y-e.x,z[q].y/y-e.y),false)}var s=v.points;if(s!=null){for(var r=0;r<s.length;r++){s[r].x+=o;s[r].y+=m}}}else{v.x+=o;v.y+=m}}}}return a}}return w};mxGraph.prototype.insertVertex=function(j,b,h,g,f,d,k,a){var e=this.createVertex(j,b,h,g,f,d,k,a);return this.addCell(e,j)};mxGraph.prototype.createVertex=function(k,b,j,h,g,d,l,a){var f=new mxGeometry(h,g,d,l);var e=new mxCell(j,f,a);e.setId(b);e.setVertex(true);e.setConnectable(true);return e};mxGraph.prototype.insertEdge=function(b,h,f,e,g,a){var d=this.createEdge(b,h,f,e,g,a);return this.addEdge(d,b,e,g)};mxGraph.prototype.createEdge=function(b,h,f,e,g,a){var d=new mxCell(f,new mxGeometry(),a);d.setId(h);d.setEdge(true);d.geometry.relative=true;return d};mxGraph.prototype.addCells=function(b,e,a){e=e||this.getDefaultParent();a=(a!=null)?a:this.model.getChildCount(e);this.dispatchEvent("beforeAdd",this,b,e,a);this.model.beginUpdate();try{for(var d=0;d<b.length;d++){this.model.add(e,b[d],a+d)}this.dispatchEvent("add",this,b);this.layoutAfterAdd(e,b)}finally{this.model.endUpdate()}this.dispatchEvent("afterAdd",this,b);return b};mxGraph.prototype.addEdge=function(d,b,e,f,a){return this.addCell(d,b,a,e,f)};mxGraph.prototype.addCell=function(a,d,b,e,f){d=d||this.getDefaultParent();b=(b!=null)?b:this.model.getChildCount(d);this.dispatchEvent("beforeAdd",this,[a],d,b,e,f);this.model.beginUpdate();try{a=this.model.add(d,a,b);if(a!=null){if(e!=null){this.model.setTerminal(a,e,true);this.dispatchEvent("connect",this,a,e,true)}if(f!=null){this.model.setTerminal(a,f,false);this.dispatchEvent("connect",this,a,f,false)}this.dispatchEvent("add",this,[a]);this.layoutAfterAdd(d,[a])}}finally{this.model.endUpdate()}if(a!=null){this.dispatchEvent("afterAdd",this,[a])}return a};mxGraph.prototype.layoutAfterAdd=function(b,a){return this.layout([b])};mxGraph.prototype.splitEdge=function(f,a,d){d=d||this.cloneCells([f])[0];var e=this.model.getParent(f);var b=this.model.getChildCount(e);var g=this.model.getTerminal(f,true);this.dispatchEvent("beforeAdd",this,[d],e,b,g,a);this.model.beginUpdate();try{this.model.add(e,d,b);this.model.setTerminals(d,g,a);this.dispatchEvent("connect",this,d,g,true);this.dispatchEvent("connect",this,d,a,false);this.model.setTerminal(f,a,true);this.dispatchEvent("connect",this,f,a,true);this.dispatchEvent("add",this,[d]);this.layoutAfterSplit(e,f,a,d)}finally{this.model.endUpdate()}this.dispatchEvent("afterAdd",this,[d]);return d};mxGraph.prototype.layoutAfterSplit=function(d,e,a,b){return this.layout([d])};mxGraph.prototype.hide=function(a,b){this.remove(a,b,true,false)};mxGraph.prototype.show=function(b,a){this.remove(b,a,false,true)};mxGraph.prototype.remove=function(u,t,d,m){u=u||this.getSelectionCells();t=(t!=null)?t:true;d=(d!=null)?d:false;m=(m!=null)?m:false;if(u.length>0){var l=(m)?"Show":((d)?"Hide":"Remove");this.dispatchEvent("before"+l,this,p);var f=this.view.scale;var r=this.view.translate;var p=new Array();this.model.beginUpdate();try{var s=this.getParents(u);for(var o=0;o<u.length;o++){if(d||m){if(t){this.removeEdges(u[o],true,d,m)}this.model.setVisible(u[o],m);p.push(u[o])}else{if(this.isDeletable(u[o])){if(t){this.removeEdges(u[o],true)}else{var k=this.getConnections(u[o]);for(var h=0;h<k.length;h++){if(mxUtils.indexOf(u,k[h])<0){var q=this.model.getGeometry(k[h]);if(q!=null){var b=this.view.getState(k[h]);if(b!=null){q=q.clone();var a=this.view.getVisibleTerminal(k[h],true)==u[o];var v=b.absolutePoints;var e=(a)?0:v.length-1;q.setTerminalPoint(new mxPoint(v[e].x/f-r.x,v[e].y/f-r.y),a);this.model.setTerminal(k[h],null,a);this.model.setGeometry(k[h],q)}}}}}this.model.remove(u[o]);p.push(u[o])}}}this.dispatchEvent(l.toLowerCase(),this,p,s);this.layoutAfterRemove(s,p,d,m)}finally{this.model.endUpdate()}this.dispatchEvent("after"+l,this,p)}};mxGraph.prototype.layoutAfterRemove=function(d,b,e,a){return this.layout(d)};mxGraph.prototype.hideEdges=function(a,b){this.removeEdges(a,b,true)};mxGraph.prototype.showEdges=function(a,b){this.removeEdges(a,b,false,true)};mxGraph.prototype.removeEdges=function(a,j,h,d){j=(j!=null)?j:true;h=(h!=null)?h:false;d=(d!=null)?d:false;if(a!=null){var g=new Array();this.model.beginUpdate();try{var b=this.model.getEdges(a);if(b!=null&&b.length>0){if(d){this.dispatchEvent("beforeShow",this,g)}else{if(h){this.dispatchEvent("beforeHide",this,g)}else{this.dispatchEvent("beforeRemove",this,g)}}if(d||h){for(var f=0;f<b.length;f++){this.model.setVisible(b[f],d);g.push(b[f])}}else{for(var f=0;f<b.length;f++){if(this.isDeletable(b[f])){this.model.remove(b[f]);g.push(b[f])}}}if(d){this.dispatchEvent("show",this,g)}else{if(h){this.dispatchEvent("hide",this,g)}else{this.dispatchEvent("remove",this,g)}}}if(j){var e=this.model.getChildren(a);if(e!=null){for(var f=0;f<e.length;f++){this.removeEdges(e[f],true,h,d)}}}}finally{this.model.endUpdate()}if(g.length>0){if(d){this.dispatchEvent("afterShow",this,g)}else{if(h){this.dispatchEvent("afterHide",this,g)}else{this.dispatchEvent("afterRemove",this,g)}}}}};mxGraph.prototype.updateSize=function(a){if(a!=null){var b=this.getPreferredSizeForCell(a);var d=this.model.getGeometry(a);if(b!=null&&d!=null){this.dispatchEvent("beforeUpdateSize",this,a,b);this.model.beginUpdate();try{var e=d.clone();if(this.isSwimlane(a)){e=this.updateSwimlaneSize(a,e,b)}else{e.width=b.width;e.height=b.height}if(d.width!=e.width||d.height!=e.height){this.resize(a,e)}this.dispatchEvent("updateSize",this,a,e)}finally{this.model.endUpdate()}this.dispatchEvent("afterUpdateSize",this,a)}}return a};mxGraph.prototype.updateSwimlaneSize=function(j,g,f){if(j!=null&&g!=null&&f!=null){this.model.beginUpdate();try{var e=this.isCellCollapsed(j);var a=this.getCellStyle(j);var d=this.model.getStyle(j)||"";if(mxUtils.getValue(a,mxConstants.STYLE_HORIZONTAL,true)){d=mxUtils.setStyle(d,mxConstants.STYLE_STARTSIZE,f.height);if(e){g.height=f.height}g.width=f.width}else{d=mxUtils.setStyle(d,mxConstants.STYLE_STARTSIZE,f.width);if(e){g.width=f.width}g.height=f.height}this.model.setStyle(j,d);if(!e){var h=this.view.getBounds(this.model.getChildren(j));if(h!=null){var l=this.view.translate;var m=this.view.scale;var b=(h.x+h.width)/m-g.x-l.x;var k=(h.y+h.height)/m-g.y-l.y;g.width=Math.max(g.width,b);g.height=Math.max(g.height,k)}}}finally{this.model.endUpdate()}}return g};mxGraph.prototype.getPreferredSizeForCell=function(j){var p=null;if(j!=null){var a=this.view.getState(j);var b=(a!=null)?a.style:this.getCellStyle(j);if(b!=null&&!this.model.isEdge(j)){var n=b[mxConstants.STYLE_FONTSIZE]||10;var o=0;var l=0;if(this.getImage(a)!=null||b[mxConstants.STYLE_IMAGE]!=null){if(b[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){if(b[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE){o+=b[mxConstants.STYLE_IMAGE_WIDTH]||mxLabel.prototype.imageSize}if(b[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER){l+=b[mxConstants.STYLE_IMAGE_HEIGHT]||mxLabel.prototype.imageSize}}}o+=2*(b[mxConstants.STYLE_SPACING]||0);o+=b[mxConstants.STYLE_SPACING_LEFT]||0;o+=b[mxConstants.STYLE_SPACING_RIGHT]||0;l+=2*(b[mxConstants.STYLE_SPACING]||0);l+=b[mxConstants.STYLE_SPACING_TOP]||0;l+=b[mxConstants.STYLE_SPACING_BOTTOM]||0;var f=this.getFoldingImage(a);if(f!=null){o+=f.width+8}var h=this.getLabel(j);if(h!=null&&h.length>0){if(!this.isHtmlLabel(j)){h=h.replace(/\n/g,"<br>")}var m=this.getSizeForString(h,n,b[mxConstants.STYLE_FONTFAMILY]);var d=m.width+o;var k=m.height+l;if(b[mxConstants.STYLE_HORIZONTAL]==false){var g=k;k=d;d=g}if(this.gridEnabled){d=this.snap(d+this.gridSize/2);k=this.snap(k+this.gridSize/2)}p=new mxRectangle(0,0,d,k)}else{var e=4*this.gridSize;p=new mxRectangle(0,0,e,e)}}}return p};mxGraph.prototype.getSizeForString=function(e,d,a){var f=document.createElement("div");f.style.fontSize=d||mxConstants.DEFAULT_FONTSIZE;f.style.fontFamily=a||mxConstants.DEFAULT_FONTFAMILY;f.style.position="absolute";f.style.display="inline";f.style.visibility="hidden";f.innerHTML=e;document.body.appendChild(f);var b=new mxRectangle(0,0,f.offsetWidth,f.offsetHeight);document.body.removeChild(f);return b};mxGraph.prototype.resize=function(a,b){this.resizeCells([a],[b])};mxGraph.prototype.resizeCells=function(m,k){if(m!=null&&k!=null){this.dispatchEvent("beforeResize",this,m,k);var d=new Array();var h=new Array();var j=new Array();var b=new Array();this.model.beginUpdate();try{for(var e=0;e<m.length;e++){var l=m[e];var a=k[e];var f=this.model.getGeometry(l);if(f.x!=a.x||f.y!=a.y||f.width!=a.width||f.height!=a.height){d.push(l);j.push(a);b.push(f);f=f.clone();if(f.relative){if(f.offset!=null){f.offset.x+=a.x-f.x;f.offset.y+=a.y-f.y}}else{f.x=a.x;f.y=a.y}f.width=a.width;f.height=a.height;this.model.setGeometry(l,f);if(this.isExtendParentOnResize(l)){this.extendParent(l)}if(!this.isCellCollapsed(l)){h.push(l)}}}if(d.length>0){this.dispatchEvent("resize",this,d,j,b);if(this.resetEdgesOnResize){this.resetEdges(d)}if(this.layoutAfterResize(this.getParents(d),h).length==0){this.cascadeResize(d[0])}}}finally{this.model.endUpdate()}this.dispatchEvent("afterResize",this,d)}};mxGraph.prototype.layoutAfterResize=function(b,a){return this.layout(a.concat(b))};mxGraph.prototype.cascadeResize=function(a){if(a!=null){var h=this.view.getState(a);var s=this.view.getState(this.model.getParent(a));if(h!=null&&s!=null){var f=this.getCellsToShift(h);if(f!=null){var t=this.view.scale;var q=h.x-s.origin.x-this.view.translate.x*t;var d=h.y-s.origin.y-this.view.translate.y*t;var r=h.x+h.width;var l=h.y+h.height;var u=this.model.getGeometry(a);var n=h.width-u.width*t+q-u.x*t;var m=h.height-u.height*t+d-u.y*t;var e=1-u.width*t/h.width;var b=1-u.height*t/h.height;this.model.beginUpdate();try{for(var o=0;o<f.length;o++){var p=this.model.getGeometry(f[o]);h=this.view.getState(f[o]);if(h!=null&&f[o]!=a&&this.isShiftable(f[o])){if(this.shiftRightwards){if(h.x>=r){p=p.translate(-n,0)}else{var k=Math.max(0,h.x-q);p=p.translate(-e*k,0)}}if(this.shiftDownwards){if(h.y>=l){p=p.translate(0,-m)}else{var j=Math.max(0,h.y-d);p=p.translate(0,-b*j)}if(p!=this.model.getGeometry(f[o])){this.model.setGeometry(f[o],p);if(this.isExtendParentOnResize(f[o])){this.extendParent(f[o])}}}}}}finally{this.model.endUpdate()}}}}};mxGraph.prototype.isExtendParentOnResize=function(a){return this.extendParentOnResize};mxGraph.prototype.extendParent=function(a){if(a!=null){var b=this.model.getParent(a);var e=this.model.getGeometry(b);if(b!=null&&e!=null&&!this.isCellCollapsed(b)){var d=this.model.getGeometry(a);if(d!=null&&(e.width<d.x+d.width||e.height<d.y+d.height)){e=e.clone();e.width=Math.max(e.width,d.x+d.width);e.height=Math.max(e.height,d.y+d.height);this.resize(b,e)}}}};mxGraph.prototype.getCellsToShift=function(a){return this.getCellsBeyond(a.x+((this.shiftDownwards)?0:a.width),a.y+((this.shiftDownwards&&this.shiftRightwards)?0:a.height),this.model.getParent(a.cell),this.shiftRightwards,this.shiftDownwards)};mxGraph.prototype.move=function(m,o,n,h,f,l){var k=m;o=o||0;n=n||0;if(k!=null&&(o!=0||n!=0||h||f!=null)){this.dispatchEvent("beforeMove",this,m,o,n,h,f,l);this.model.beginUpdate();try{if(h){k=this.cloneCells(m);for(var d=0;d<k.length;d++){if(this.cloneInvalidEdges||!this.model.isEdge(k[d])||this.getEdgeValidationError(k[d],this.model.getTerminal(k[d],true),this.model.getTerminal(k[d],false))==null){var j=this.getDefaultParent();this.model.add(j,k[d]);var b=this.view.getState(j);var a=this.model.getGeometry(k[d]);if(b!=null&&a!=null){this.model.setGeometry(k[d],a.translate(-b.origin.x,-b.origin.y))}}else{k[d]=null}}this.dispatchEvent("clone",this,k,m)}else{if(this.disconnectOnMove&&this.allowDanglingEdges){this.disconnect(m)}}for(var d=0;d<k.length;d++){var e=this.model.getGeometry(k[d]);if(e!=null&&this.isMovable(k[d])){e=e.translate(o,n);if(e.relative&&!this.model.isEdge(k[d])){if(e.offset==null){e.offset=new mxPoint(o,n)}else{e.offset.x+=o;e.offset.y+=n}}this.model.setGeometry(k[d],e)}}this.moveInto(k,f,l)}finally{this.model.endUpdate()}this.dispatchEvent("afterMove",this,m,k,o,n,h,f,l)}return k};mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds};mxGraph.prototype.getContentArea=function(b){if(b!=null&&!this.model.isEdge(b)){var j=this.model.getParent(b);if(j==this.getDefaultParent()||j==this.getCurrentRoot()){return this.getMaximumGraphBounds()}else{(j!=null&&j!=this.getDefaultParent())}var k=this.model.getGeometry(j);if(k!=null){var a=0;var l=0;var d=k.width;var f=k.height;if(this.isSwimlane(j)){var e=this.getStartSize(j);a=e.width;d-=e.width;l=e.height;f-=e.height}return new mxRectangle(a,l,d,f)}}return null};mxGraph.prototype.removeFromParent=function(b){b=b||this.getSelectionCells();if(b!=null){var f=this.getDefaultParent();var a=this.getModel();var e=new Array();for(var d=0;d<b.length;d++){if(a.getParent(b[d])!=f){e.push(b[d])}}if(e.length>0){this.moveInto(e,f)}}};mxGraph.prototype.moveInto=function(o,j,m){if(o!=null&&o.length>0){var k=null;this.model.beginUpdate();try{if(j!=null){k=[j];var n=o[0];if(this.model.isEdge(j)&&this.model.isConnectable(n)){if(this.getEdgeValidationError(j,this.model.getTerminal(j,true),n)==null){this.splitEdge(j,n)}}else{var e=new Array();for(var f=0;f<o.length;f++){if(o[f]!=j){var l=this.model.getParent(o[f]);var b=mxCellPath.create(l);if(e[b]==null){e[b]=l;k.push(l)}if(j!=l){var a=this.view.getState(j);var d=this.view.getState(l);var h=this.model.getGeometry(o[f]);if(h!=null&&a!=null&&d!=null){h=h.translate(d.origin.x-a.origin.x,d.origin.y-a.origin.y);this.model.setGeometry(o[f],h)}}this.model.add(j,o[f])}}}}else{k=this.getParents(o)}this.cellsMoved(o,m);this.keepInside(o);if(this.resetEdgesOnMove){this.resetEdges(o)}this.dispatchEvent("move",this,o,k,j);this.layoutAfterMove(k,o,j)}finally{this.model.endUpdate()}}};mxGraph.prototype.cellsMoved=function(d,b){if(d!=null&&b!=null){var a=mxUtils.convertPoint(this.container,b.clientX,b.clientY);for(var e=0;e<d.length;e++){var f=this.getLayout(this.model.getParent(d[e]));if(f!=null&&f.move!=null){f.move(d[e],a.x,a.y)}}}};mxGraph.prototype.keepInside=function(d){if(d!=null){this.model.beginUpdate();try{for(var e=0;e<d.length;e++){var a=d[e];var h=(this.isKeepInsideParentOnMove(a)?this.getContentArea(a):this.getMaximumGraphBounds());if(h!=null){var f=this.model.getGeometry(a);if(!f.relative&&(f.x<h.x||f.y<h.y||h.width<f.x+f.width||h.height<f.y+f.height)){var b=this.getOverlap(a);if(h.width>0){f.x=Math.min(f.x,h.x+h.width-(1-b)*f.width)}if(h.height>0){f.y=Math.min(f.y,h.y+h.height-(1-b)*f.height)}f.x=Math.max(f.x,h.x-f.width*b);f.y=Math.max(f.y,h.y-f.height*b)}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.resetEdges=function(n){if(n!=null){var g=new Array();for(var h=0;h<n.length;h++){var b=mxCellPath.create(n[h]);g[b]=n[h]}this.model.beginUpdate();try{for(var h=0;h<n.length;h++){var e=this.model.getEdges(n[h]);if(e!=null){for(var d=0;d<e.length;d++){var a=this.view.getVisibleTerminal(e[d],true);var m=mxCellPath.create(a);var k=this.view.getVisibleTerminal(e[d],false);var l=mxCellPath.create(k);if(g[m]==null||g[l]==null){var f=this.model.getGeometry(e[d]);if(f!=null&&f.points!=null&&f.points.length>0){f=f.clone();f.points=new Array();this.model.setGeometry(e[d],f)}}}}this.resetEdges(this.model.getChildren(n[h]))}}finally{this.model.endUpdate()}}};mxGraph.prototype.layoutAfterMove=function(b,a,d){return this.layout(b)};mxGraph.prototype.connect=function(d,b,a){if(d!=null){this.dispatchEvent("beforeConnect",this,d,b,a);this.model.beginUpdate();try{this.model.setTerminal(d,b,a);var e=this.model.getGeometry(d);if(e!=null&&e.points!=null){e=e.clone();e.points=new Array();this.model.setGeometry(d,e)}this.dispatchEvent("connect",this,d,b,a);this.layoutAfterConnect(d,b,a)}finally{this.model.endUpdate()}this.dispatchEvent("afterConnect",this,d,b,a)}};mxGraph.prototype.layoutAfterConnect=function(e,b,a){var d=this.model.getParent(b);if(d!=null){return this.layout([d])}return false};mxGraph.prototype.disconnect=function(s){if(s!=null){this.dispatchEvent("beforeDisconnect",this,s);this.model.beginUpdate();try{var j=this.view.scale;var p=this.view.translate;var l=new Array();for(var m=0;m<s.length;m++){var f=mxCellPath.create(s[m]);l[f]=s[m]}for(var m=0;m<s.length;m++){if(this.model.isEdge(s[m])){var o=this.model.getGeometry(s[m]);if(o!=null){var e=this.view.getState(s[m]);var k=this.view.getState(this.model.getParent(s[m]));if(e!=null&&k!=null){o=o.clone();var u=-k.origin.x;var r=-k.origin.y;var t=e.absolutePoints;var b=this.model.getTerminal(s[m],true);if(b!=null&&this.isDisconnectable(s[m],b,true)){var a=mxCellPath.create(b);while(b!=null&&l[a]==null){b=this.model.getParent(b);a=mxCellPath.create(b)}if(b==null){o.setTerminalPoint(new mxPoint(t[0].x/j-p.x+u,t[0].y/j-p.y+r),true);this.model.setTerminal(s[m],null,true)}}var d=this.model.getTerminal(s[m],false);if(d!=null&&this.isDisconnectable(s[m],d,false)){var q=mxCellPath.create(d);while(d!=null&&l[q]==null){d=this.model.getParent(d);q=mxCellPath.create(d)}if(d==null){var h=t.length-1;o.setTerminalPoint(new mxPoint(t[h].x/j-p.x+u,t[h].y/j-p.y+r),false);this.model.setTerminal(s[m],null,false)}}this.model.setGeometry(s[m],o)}}}}this.dispatchEvent("disconnect",this,s)}finally{this.model.endUpdate()}this.dispatchEvent("afterDisconnect",this,s)}};mxGraph.prototype.getBounds=function(){return this.view.bounds};mxGraph.prototype.getCellBounds=function(b,j,h){var e=[b];if(j){e=e.concat(this.model.getEdges(b))}var a=this.view.getBounds(e);if(h){var d=this.model.getChildCount(b);for(var g=0;g<d;g++){var f=this.getCellBounds(this.model.getChildAt(b,g),j,true);if(a!=null){a.add(f)}else{a=f}}}};mxGraph.prototype.refresh=function(a){this.view.clear(a,a==null);this.view.validate();this.sizeDidChange();this.dispatchEvent("refresh",this)};mxGraph.prototype.snap=function(a){if(this.gridEnabled){a=Math.round(a/this.gridSize)*this.gridSize}return a};mxGraph.prototype.shift=function(b,a){var f=mxUtils.getCurrentStyle(this.container);if(mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-b;this.container.scrollTop=-a}else{var d=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG){d.setAttribute("transform","translate("+b+","+a+")");if(b==0&&a==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);this.shiftPreview=null;var h=this.container.firstChild;while(h!=null){if(h!=d.parentNode){if(h.style!=null){h.style.visibility="visible"}}h=h.nextSibling}}}else{if(this.shiftPreview==null){this.shiftPreview=document.createElement("div");var e=new Array();var h=this.container.firstChild;while(h!=null){if(h!=d.parentNode){e.push(mxUtils.getInnerHtml(h));if(h.style!=null){h.style.visibility="hidden"}}h=h.nextSibling}this.shiftPreview.innerHTML=e.join("");this.shiftPreview.style.position="absolute";this.shiftPreview.style.overflow="visible";var g=mxUtils.getOffset(this.container);this.shiftPreview.style.left=g.x+"px";this.shiftPreview.style.top=g.y+"px";this.container.appendChild(this.shiftPreview)}this.shiftPreview.style.left=b+"px";this.shiftPreview.style.top=a+"px"}}else{if(this.dialect==mxConstants.DIALECT_VML){d.setAttribute("coordorigin",(-b)+","+(-a))}else{if(b==0&&a==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);d.style.visibility="visible";this.shiftPreview=null}}else{if(this.shiftPreview==null){this.shiftPreview=this.view.getDrawPane().cloneNode(false);var e=mxUtils.getInnerHtml(this.view.getBackgroundPane());e+=mxUtils.getInnerHtml(this.view.getDrawPane());this.shiftPreview.innerHTML=e;var g=mxUtils.getOffset(this.container);this.shiftPreview.style.position="absolute";this.shiftPreview.style.left=g.x+"px";this.shiftPreview.style.top=g.y+"px";d.style.visibility="hidden";this.container.appendChild(this.shiftPreview)}this.shiftPreview.style.left=b+"px";this.shiftPreview.style.top=a+"px"}}}}};mxGraph.prototype.zoomIn=function(){var j=this.view.scale*this.zoomFactor;var g=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&g!=null){var d=new mxRectangle(g.x*this.zoomFactor,g.y*this.zoomFactor,g.width*this.zoomFactor,g.height*this.zoomFactor);this.view.scale=j;if(!this.scrollRectToVisible(d)){this.view.setScale(j)}}else{if(this.centerZoom&&!mxUtils.hasScrollbars(this.container)){var a=this.container.offsetWidth;var b=this.container.offsetHeight;var e=(this.zoomFactor-1)/(j*2);this.view.scaleAndTranslate(j,this.view.translate.x-a*e,this.view.translate.y-b*e)}else{this.view.setScale(j)}}};mxGraph.prototype.zoomOut=function(){var j=this.view.scale/this.zoomFactor;var g=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&g!=null){var d=new mxRectangle(g.x/this.zoomFactor,g.y/this.zoomFactor,g.width/this.zoomFactor,g.height/this.zoomFactor);this.view.scale=j;if(!this.scrollRectToVisible(d)){this.view.setScale(j)}}else{if(this.centerZoom&&!mxUtils.hasScrollbars(this.container)){var a=this.container.offsetWidth;var b=this.container.offsetHeight;var e=(this.zoomFactor-1)/(this.view.scale*2);this.view.scaleAndTranslate(j,this.view.translate.x+a*e,this.view.translate.y+b*e)}else{this.view.setScale(j)}}};mxGraph.prototype.zoomActual=function(){this.view.translate.x=0;this.view.translate.y=0;this.view.setScale(1)};mxGraph.prototype.fit=function(){var e=10;var b=this.container.offsetWidth-30-2*e;var f=this.container.offsetHeight-30-2*e;var h=this.view.bounds;var a=h.width/this.view.scale;var d=h.height/this.view.scale;var g=Math.min(b/a,f/d);if(g>0.1&&g<8){this.view.translate.x=(h.x!=null)?this.view.translate.x-h.x/this.view.scale+e:e;this.view.translate.y=(h.y!=null)?this.view.translate.y-h.y/this.view.scale+e:e;this.view.setScale(g)}};mxGraph.prototype.scrollCellToVisible=function(b){var a=-this.view.translate.x;var f=-this.view.translate.y;var e=this.view.getState(b);if(e!=null){var d=new mxRectangle(a+e.x,f+e.y,e.width,e.height);if(this.scrollRectToVisible(d)){this.view.setTranslate(this.view.translate.x,this.view.translate.y)}}};mxGraph.prototype.scrollRectToVisible=function(g){if(g!=null){var d=false;if(this.container.style.overflow=="auto"){}else{var a=-this.view.translate.x;var j=-this.view.translate.y;var b=this.container.offsetWidth;var f=this.container.offsetHeight;var e=this.view.scale;if(g.x+g.width>a+b){this.view.translate.x-=(g.x+g.width-b-a)/e;d=true}if(g.y+g.height>j+f){this.view.translate.y-=(g.y+g.height-f-j)/e;d=true}if(g.x<a){this.view.translate.x+=(a-g.x)/e;d=true}if(g.y<j){this.view.translate.y+=(j-g.y)/e;d=true}if(d){this.view.refresh()}}}return d};mxGraph.prototype.isCellVisible=function(a){return this.model.isVisible(a)};mxGraph.prototype.isCellCollapsed=function(a){return this.model.isCollapsed(a)};mxGraph.prototype.isOrthogonal=function(a,b){var d=a.style[mxConstants.STYLE_EDGE];return d==mxEdgeStyle.ElbowConnector||d==mxEdgeStyle.SideToSide||d==mxEdgeStyle.TopToBottom||d==mxEdgeStyle.EntityRelation};mxGraph.prototype.isLoop=function(b){var d=this.view.getVisibleTerminal(b.cell,true);var a=this.view.getVisibleTerminal(b.cell,false);return(d!=null&&d==a)};mxGraph.prototype.collapse=function(a,b){this.setCollapsedState(a,true,b)};mxGraph.prototype.expand=function(a,b){this.setCollapsedState(a,false,b)};mxGraph.prototype.setCollapsedState=function(a,g,e){a=a||this.getSelectionCells();e=(e!=null)?e:false;if(a!=null&&a.length>0){this.editor.stopEditing(false);var f=(g)?"Collapse":"Expand";this.dispatchEvent("before"+f,this,a);this.model.beginUpdate();try{for(var d=0;d<a.length;d++){if((g&&this.isCollapsable(a[d])&&!this.isCellCollapsed(a[d]))||(!g&&this.isExpandable(a[d])&&this.isCellCollapsed(a[d]))){this.model.setCollapsed(a[d],g);this.swapBounds(a[d],g);if(this.isExtendParentOnResize(a[d])){this.extendParent(a[d])}this.cascadeResize(a[d]);if(e){var b=this.model.getChildren(a[d]);this.setCollapsedState(b,g,true)}}}this.dispatchEvent(f.toLowerCase(),this,a);this.layoutAfterCollapsedState(a,g)}finally{this.model.endUpdate()}this.dispatchEvent("after"+f,this,a)}};mxGraph.prototype.layoutAfterCollapsedState=function(a,b){return this.layout(this.getParents(a))};mxGraph.prototype.swapBounds=function(a,d){if(a!=null){var b=this.model.getGeometry(a);if(b!=null){b=b.clone();this.updateAlternateBounds(a,b,d);b.swap();this.model.setGeometry(a,b)}}};mxGraph.prototype.updateAlternateBounds=function(a,h,k){if(a!=null&&h!=null){if(h.alternateBounds==null){var f=h;if(this.collapseToPreferredSize){var d=this.getPreferredSizeForCell(a);if(d!=null){f=d;var j=this.view.getState(a);var e=(j!=null)?j.style:this.getCellStyle(a);var b=mxUtils.getValue(e,mxConstants.STYLE_STARTSIZE);if(b>0){f.height=Math.max(f.height,b)}}}h.alternateBounds=new mxRectangle(h.x,h.y,f.width,f.height)}else{h.alternateBounds.x=h.x;h.alternateBounds.y=h.y}}};mxGraph.prototype.getCellGeometry=function(a){return this.model.getGeometry(a)};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot};mxGraph.prototype.getTranslateForRoot=function(a){return null};mxGraph.prototype.getChildOffsetForCell=function(a){return null};mxGraph.prototype.enterGroup=function(a){a=a||this.getSelectionCell();if(a!=null&&this.isValidRoot(a)){this.view.setCurrentRoot(a);this.clearSelection()}};mxGraph.prototype.exitGroup=function(){var a=this.model.getRoot();var e=this.getCurrentRoot();if(e!=null){var b=this.model.getParent(e);while(b!=a&&!this.isValidRoot(b)&&this.model.getParent(b)!=a){b=this.model.getParent(b)}if(b==a||this.model.getParent(b)==a){this.view.setCurrentRoot(null)}else{this.view.setCurrentRoot(b)}var d=this.view.getState(e);if(d!=null){this.setSelectionCell(e)}}};mxGraph.prototype.home=function(){var b=this.getCurrentRoot();if(b!=null){this.view.setCurrentRoot(null);var a=this.view.getState(b);if(a!=null){this.setSelectionCell(b)}}};mxGraph.prototype.isValidRoot=function(a){return(a!=null)};mxGraph.prototype.group=function(g,b,e){e=e||this.getSelectionCells();if(e!=null&&e.length>1){var f=this.model.getParent(e[0]);var a=new Array();a.push(e[0]);for(var d=1;d<e.length;d++){if(this.model.getParent(e[d])==f){a.push(e[d])}}if(a.length>1){g=g||this.createGroupCell(a);g=this.addGroup(g,a,b);if(g!=null){this.setSelectionCell(g)}}}return g};mxGraph.prototype.createGroupCell=function(a){var b=new mxCell("");b.setVertex(true);b.setConnectable(false);return b};mxGraph.prototype.ungroup=function(a){a=a||this.getSelectionCells();if(a!=null){this.clearSelection();this.model.beginUpdate();try{for(var d=0;d<a.length;d++){var b=this.model.getChildren(a[d]);if(b!=null&&b.length>0){b=b.slice();this.moveInto(b,this.model.getParent(a[d]));this.selection.addCells(b);this.remove([a[d]])}}}finally{this.model.endUpdate()}}};mxGraph.prototype.addGroup=function(m,o,f){f=(f!=null)?f:0;var l=this.model.getParent(o[0]);var h=this.view.getState(l);var a=this.view.getBounds(o);if(a!=null){var e=this.view.scale;var d=this.view.translate;var k=a.x-h.origin.x*e;var j=a.y-h.origin.y*e;var b=a.width;var n=a.height;if(this.isSwimlane(m)){var p=this.getStartSize(m);k-=p.width;b+=p.width;j-=p.height;n+=p.height}var g=new mxGeometry(k/e-f-d.x,j/e-f-d.y,b/e+2*f,n/e+2*f);this.model.beginUpdate();try{m=this.groupCells(l,m,o,-g.x,-g.y);if(m!=null){this.model.setGeometry(m,g)}}finally{this.model.endUpdate()}return m}return null};mxGraph.prototype.groupCells=function(g,h,e,b,a){this.model.beginUpdate();try{var d=this.model.getChildCount(g);h=this.model.add(g,h,d);if(h!=null){for(var f=0;f<e.length;f++){if(this.model.getParent(e[f])!=h){d=this.model.getChildCount(h);this.model.add(h,e[f],d)}var j=this.model.getGeometry(e[f]);if(j!=null){j=j.translate(b,a);this.model.setGeometry(e[f],j)}}}}finally{this.model.endUpdate()}return h};mxGraph.prototype.getLayout=function(a){return null};mxGraph.prototype.isBubbleLayout=function(){return this.bubbleLayout};mxGraph.prototype.setBubbleLayout=function(a){this.bubbleLayout=a};mxGraph.prototype.isAutoLayout=function(a){return this.autoLayout};mxGraph.prototype.getParents=function(b){var a=new Array();if(b!=null){var f=new Array();for(var d=0;d<b.length;d++){var e=this.model.getParent(b[d]);if(e!=null){var g=mxCellPath.create(e);if(f[g]==null){f[g]=e;a.push(e)}}}}return a};mxGraph.prototype.layout=function(e){var b=new Array();if(e!=null&&e.length>0){this.dispatchEvent("beforeLayout",this,e);if(this.isBubbleLayout()){var g=e;while(g.length>0){e=e.concat(g);g=this.getParents(g)}}var d=function(m,k){var n=mxCellPath.create(m);var l=mxCellPath.create(k);return(n==l)?0:((n<l)?1:-1)};e.sort(d);var j=null;this.model.beginUpdate();try{for(var f=0;f<e.length;f++){var a=e[f];if(a!=null&&a!=j&&this.isAutoLayout(a)){var h=this.getLayout(a);if(h!=null){h.execute(a);b.push(a)}}j=a}this.dispatchEvent("layout",this,b)}finally{this.model.endUpdate()}this.dispatchEvent("afterLayout",this,b)}return b};mxGraph.prototype.validationAlert=function(a){mxUtils.alert(a)};mxGraph.prototype.isEdgeValid=function(a,b,d){return this.getEdgeValidationError(a,b,d)==null};mxGraph.prototype.getEdgeValidationError=function(b,a,h){if(b!=null&&this.model.getTerminal(b,true)==null&&this.model.getTerminal(b,false)==null){return null}if(!this.allowLoops&&a==h&&a!=null){return""}if(!this.isValidConnection(a,h)){return""}if(a!=null&&h!=null){var j="";if(!this.multigraph){var e=this.model.getEdgesBetween(a,h,true);if(e.length>1||(e.length==1&&e[0]!=b)){j+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n"}}var k=this.model.getDirectedEdgeCount(a,true,b);var f=this.model.getDirectedEdgeCount(h,false,b);for(var g=0;g<this.multiplicities.length;g++){var d=this.multiplicities[g].check(this,b,a,h,k,f);if(d!=null){j+=d}}var d=this.validateEdge(b,a,h);if(d!=null){j+=d}return(j.length>0)?j:null}return(this.allowDanglingEdges)?null:""};mxGraph.prototype.validateEdge=function(a,b,d){return null};mxGraph.prototype.validate=function(l,a){l=(l!=null)?l:this.model.getRoot();a=(a!=null)?a:new Object();var m=true;var d=this.model.getChildCount(l);for(var e=0;e<d;e++){var f=this.model.getChildAt(l,e);var n=a;if(this.isValidRoot(f)){n=new Object()}var j=this.validate(f,n);if(j!=null){var g=j.replace(/\n/g,"<br>");var h=g.length;this.setWarning(f,g.substring(0,Math.max(0,h-4)))}else{this.setWarning(f,null)}m=m&&j==null}var k="";if(this.isCellCollapsed(l)&&!m){k+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"}if(this.model.isEdge(l)){k+=this.getEdgeValidationError(l,this.model.getTerminal(l,true),this.model.getTerminal(l,false))||""}else{k+=this.getCellValidationError(l)||""}var b=this.validateCell(l,a);if(b!=null){k+=b}if(this.model.getParent(l)==null){this.view.validate()}return(k.length>0||!m)?k:null};mxGraph.prototype.getCellValidationError=function(a){var b=this.model.getDirectedEdgeCount(a,true);var d=this.model.getDirectedEdgeCount(a,false);var g=this.model.getValue(a);var e="";for(var f=0;f<this.multiplicities.length;f++){var h=this.multiplicities[f];if(h.source&&mxUtils.isNode(g,h.type,h.attr,h.value)&&((h.max==0&&b>0)||(h.min==1&&b==0)||(h.max==1&&b>1))){e+=h.countError+"\n"}else{if(!h.source&&mxUtils.isNode(a,type,h.attr,h.value)&&((h.max==0&&d>0)||(h.min==1&&d==0)||(h.max==1&&d>1))){e+=h.countError+"\n"}}}return(e.length>0)?e:null};mxGraph.prototype.validateCell=function(a,b){return null};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage};mxGraph.prototype.setBackgroundImage=function(a){this.backgroundImage=a};mxGraph.prototype.getFoldingImage=function(b){if(b!=null){var a=this.isCellCollapsed(b.cell);if((a&&this.isExpandable(b.cell))||(!a&&this.isCollapsable(b.cell))){return(a)?this.collapsedImage:this.expandedImage}}return null};mxGraph.prototype.convertValueToString=function(a){var b=this.model.getValue(a);if(b!=null){if(mxUtils.isNode(b)){return b.nodeName}else{if(typeof(b.toString)=="function"){return b.toString()}}}return""};mxGraph.prototype.getLabel=function(b){var a="";var d=this.getCellStyle(b);if(b!=null&&this.labelsVisible&&!mxUtils.getValue(d,mxConstants.STYLE_NOLABEL,false)){a=this.convertValueToString(b)}return a};mxGraph.prototype.isHtmlLabel=function(a){return this.htmlLabels};mxGraph.prototype.isWrapping=function(a){return false};mxGraph.prototype.isClipping=function(a){return false};mxGraph.prototype.getTooltip=function(a,b){var d=null;if(b!=null){if(parseInt(b)!=b){d=b.toString()}}else{d=this.getTooltipForCell(a)}return d};mxGraph.prototype.getTooltipForCell=function(a){var b=null;if(a.getTooltip!=null){b=a.getTooltip()}else{b=this.convertValueToString(a)}return b};mxGraph.prototype.getCursorForCell=function(a){return null};mxGraph.prototype.getStartSize=function(e){var a=new mxRectangle();var d=this.getCellStyle(e);if(d!=null){var b=parseInt(d[mxConstants.STYLE_STARTSIZE])||0;if(mxUtils.getValue(d,mxConstants.STYLE_HORIZONTAL,true)){a.height=b}else{a.width=b}}return a};mxGraph.prototype.getImage=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_IMAGE]:null};mxGraph.prototype.getVerticalAlign=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_VERTICAL_ALIGN]:null};mxGraph.prototype.getIndicatorColor=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_COLOR]:null};mxGraph.prototype.getIndicatorGradientColor=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};mxGraph.prototype.getIndicatorShape=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};mxGraph.prototype.getIndicatorImage=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};mxGraph.prototype.getBorder=function(){return this.border};mxGraph.prototype.setBorder=function(a){this.border=a};mxGraph.prototype.isSwimlane=function(a){if(a!=null){if(this.model.getParent(a)!=this.model.getRoot()){var d=this.view.getState(a);var b=(d!=null)?d.style:this.getCellStyle(a);if(b!=null&&!this.model.isEdge(a)){return b[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}}}return false};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer};mxGraph.prototype.setResizeContainer=function(a){this.resizeContainer=a};mxGraph.prototype.isEnabled=function(){return this.enabled};mxGraph.prototype.setEnabled=function(a){this.enabled=a};mxGraph.prototype.isLocked=function(a){var b=this.model.getGeometry(a);return this.locked||(b!=null&&this.model.isVertex(a)&&b.relative)};mxGraph.prototype.setLocked=function(a){this.locked=a};mxGraph.prototype.isCellCloneable=function(a){return this.isCloneable()};mxGraph.prototype.isCloneable=function(){return this.cloneable};mxGraph.prototype.setCloneable=function(a){this.cloneable=a};mxGraph.prototype.canExport=function(a){return this.exportEnabled};mxGraph.prototype.canImport=function(a){return this.importEnabled};mxGraph.prototype.isSelectable=function(a){return(a!=null)?this.selectable:false};mxGraph.prototype.isDeletable=function(a){return this.deletable};mxGraph.prototype.setDeletable=function(a){this.deletable=a};mxGraph.prototype.isLabelMovable=function(a){return !this.isLocked(a)&&((this.model.isEdge(a)&&this.edgeLabelsMovable)||(this.model.isVertex(a)&&this.vertexLabelsMovable))};mxGraph.prototype.isMovable=function(a){return this.movable&&!this.isLocked(a)};mxGraph.prototype.setMovable=function(a){this.movable=a};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled};mxGraph.prototype.setGridEnabled=function(a){this.gridEnabled=a};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting};mxGraph.prototype.setSwimlaneNesting=function(a){this.swimlaneNesting=a};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};mxGraph.prototype.setSwimlaneSelectionEnabled=function(a){this.swimlaneSelectionEnabled=a};mxGraph.prototype.isMultigraph=function(){return this.multigraph};mxGraph.prototype.setMultigraph=function(a){this.multigraph=a};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops};mxGraph.prototype.setAllowDanglingEdges=function(a){this.allowDanglingEdges=a};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges};mxGraph.prototype.setConnectableEdges=function(a){this.connectableEdges=a};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges};mxGraph.prototype.setCloneInvalidEdges=function(a){this.cloneInvalidEdges=a};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};mxGraph.prototype.setAllowLoops=function(a){this.allowLoops=a};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove};mxGraph.prototype.setDisconnectOnMove=function(a){this.disconnectOnMove=a};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled};mxGraph.prototype.setDropEnabled=function(a){this.dropEnabled=a};mxGraph.prototype.isSizable=function(a){return this.sizable&&!this.isLocked(a)};mxGraph.prototype.setSizable=function(a){this.sizable=a};mxGraph.prototype.isBendable=function(a){return this.bendable&&!this.isLocked(a)};mxGraph.prototype.setBendable=function(a){this.bendable=a};mxGraph.prototype.isDisconnectable=function(a,b,d){return this.disconnectable&&!this.isLocked(a)};mxGraph.prototype.setDisconnectable=function(a){this.disconnectable=a};mxGraph.prototype.isEditable=function(a){return this.editable&&!this.isLocked(a)};mxGraph.prototype.setEditable=function(a){this.editable=a};mxGraph.prototype.isValidSource=function(a){return(a==null&&this.allowDanglingEdges)||(a!=null&&(!this.model.isEdge(a)||this.connectableEdges)&&this.model.isConnectable(a))};mxGraph.prototype.isValidTarget=function(a){return this.isValidSource(a)};mxGraph.prototype.isValidConnection=function(a,b){return this.isValidSource(a)&&this.isValidTarget(b)};mxGraph.prototype.setConnectable=function(a){this.connectionHandler.setEnabled(a)};mxGraph.prototype.isConnectable=function(a){return this.connectionHandler.isEnabled()};mxGraph.prototype.setTooltips=function(a){this.tooltipHandler.setEnabled(a)};mxGraph.prototype.setPanning=function(a){this.panningHandler.panningEnabled=a};mxGraph.prototype.isEditing=function(a){return this.editor!=null&&this.editor.isEditing(a)};mxGraph.prototype.setUpdateSize=function(a){this.autoSize=a};mxGraph.prototype.isUpdateSize=function(a){return this.autoSize};mxGraph.prototype.isKeepInsideParentOnMove=function(a){return this.keepInsideParentOnMove};mxGraph.prototype.getOverlap=function(a){return(this.isAllowOverlapParent(a))?this.defaultOverlap:0};mxGraph.prototype.isAllowOverlapParent=function(a){return false};mxGraph.prototype.isShiftable=function(a){return !this.model.isEdge(a)};mxGraph.prototype.isExpandable=function(a){return this.model.getChildCount(a)>0};mxGraph.prototype.isCollapsable=function(a){return this.isExpandable(a)};mxGraph.prototype.isValidDropTarget=function(a,d,b){if(this.model.isEdge(a)){return d!=null&&d.length==1&&this.isSplitDropTarget(a,d[0],b)}else{return this.isParentDropTarget(a,d,b)}};mxGraph.prototype.isSplitDropTarget=function(e,a,d){if(e!=null){var f=this.model.getTerminal(e,true);var b=this.model.getTerminal(e,false);return(!this.model.isAncestor(a,f)&&!this.model.isAncestor(a,b))}return false};mxGraph.prototype.isParentDropTarget=function(d,b,a){if(d!=null){return this.isSwimlane(d)||(this.model.getChildCount(d)>0&&!this.isCellCollapsed(d))}return false};mxGraph.prototype.getDropTarget=function(d,b,a){if(!this.swimlaneNesting){for(var f=0;f<d.length;f++){if(this.isSwimlane(d[f])){return null}}}var h=mxUtils.convertPoint(this.container,b.clientX,b.clientY);var g=this.getSwimlaneAt(h.x,h.y);if(a==null){a=g}else{if(g!=null){var e=this.model.getParent(g);while(e!=null&&this.isSwimlane(e)&&e!=a){e=this.model.getParent(e)}if(e==a){a=g}}}while(a!=null&&!this.isValidDropTarget(a,d,b)&&!this.model.isLayer(a)){a=this.model.getParent(a)}return(!this.model.isLayer(a))?a:null};mxGraph.prototype.getDefaultParent=function(){var b=this.defaultParent;if(b==null){b=this.getCurrentRoot();if(b==null){var a=this.model.getRoot();b=this.model.getChildAt(a,0)}}return b};mxGraph.prototype.getSwimlane=function(a){while(a!=null&&!this.isSwimlane(a)){a=this.model.getParent(a)}return a};mxGraph.prototype.getSwimlaneAt=function(b,j,f){f=f||this.getDefaultParent();if(f!=null){var d=this.model.getChildCount(f);for(var e=0;e<d;e++){var h=this.model.getChildAt(f,e);var a=this.getSwimlaneAt(b,j,h);if(a!=null){return a}else{if(this.isSwimlane(h)){var g=this.view.getState(h);if(this.isCellVisible(h)&&this.intersects(g,b,j)){return h}}}}}return null};mxGraph.prototype.getCellAt=function(h,g,j,f,b){f=f||true;b=b||true;j=j||this.getDefaultParent();if(j!=null){var d=this.model.getChildCount(j);for(var e=0;e<d;e++){var k=this.model.getChildAt(j,e);var l=this.getCellAt(h,g,k,f,b);if(l!=null){return l}else{if(this.isCellVisible(k)&&(b&&this.model.isEdge(k)||f&&this.model.isVertex(k))){var a=this.view.getState(k);if(this.intersects(a,h,g)){return k}}}}}return null};mxGraph.prototype.intersects=function(a,h,g){if(a!=null){var j=a.absolutePoints;if(j!=null){var d=this.tolerance*this.tolerance;var k=j[0];for(var b=1;b<j.length;b++){var e=j[b];var f=mxUtils.ptSegDistSq(k.x,k.y,e.x,e.y,h,g);if(f<=d){return true}k=e}}else{if(mxUtils.contains(a,h,g)){return true}}}return false};mxGraph.prototype.hitsSwimlaneContent=function(e,a,g){var d=this.getView().getState(e);var b=this.getStartSize(e);if(d!=null){var f=this.getView().getScale();a-=d.x;g-=d.y;if(b.width>0&&a>0&&a>b.width*f){return true}else{if(b.height>0&&g>0&&g>b.height*f){return true}}}return false};mxGraph.prototype.getChildVertices=function(a){return this.getChildCells(a,true,false)};mxGraph.prototype.getChildEdges=function(a){return this.getChildCells(a,false,true)};mxGraph.prototype.getChildCells=function(g,e,b){g=(g!=null)?g:this.getDefaultParent();e=(e!=null)?e:false;b=(b!=null)?b:false;var d=this.model.getChildCells(g,e,b);var a=new Array();for(var f=0;f<d.length;f++){if(this.isCellVisible(d[f])){a.push(d[f])}}return a};mxGraph.prototype.getConnections=function(a,b){return this.getEdges(a,b,true,true,false)};mxGraph.prototype.getIncomingEdges=function(a,b){return this.getEdges(a,b,true,false,false)};mxGraph.prototype.getOutgoingEdges=function(a,b){return this.getEdges(a,b,false,true,false)};mxGraph.prototype.getEdges=function(n,m,e,j,d){e=(e!=null)?e:true;j=(j!=null)?j:true;d=(d!=null)?d:true;var f=new Array();var k=this.isCellCollapsed(n);var g=this.model.getChildCount(n);for(var h=0;h<g;h++){var b=this.model.getChildAt(n,h);if(k||!this.isCellVisible(b)){f=f.concat(this.model.getEdges(b,e,j))}}f=f.concat(this.model.getEdges(n,e,j));var o=new Array();for(var h=0;h<f.length;h++){var a=this.view.getVisibleTerminal(f[h],true);var l=this.view.getVisibleTerminal(f[h],false);if(d||((a!=l)&&(e&&l==n&&(m==null||this.model.getParent(a)==m))||(j&&a==n&&(m==null||this.model.getParent(l)==m)))){o.push(f[h])}}return o};mxGraph.prototype.getOpposites=function(e,h,b,j){b=(b!=null)?b:true;j=(j!=null)?j:true;var l=new Array();var f=new Object();if(e!=null){for(var g=0;g<e.length;g++){var a=this.view.getVisibleTerminal(e[g],true);var k=this.view.getVisibleTerminal(e[g],false);if(a==h&&k!=null&&k!=h&&j){var d=mxCellPath.create(k);if(f[d]==null){f[d]=k;l.push(k)}}else{if(k==h&&a!=null&&a!=h&&b){var d=mxCellPath.create(a);if(f[d]==null){f[d]=a;l.push(a)}}}}}return l};mxGraph.prototype.getEdgesBetween=function(g,h,f){var d=this.getEdges(g);var a=new Array();for(var e=0;e<d.length;e++){var j=this.view.getVisibleTerminal(d[e],true);var b=this.view.getVisibleTerminal(d[e],false);if(b==h||(!f&&j==h)){a.push(d[e])}}return a};mxGraph.prototype.getPointForEvent=function(a){var e=mxUtils.convertPoint(this.container,a.clientX,a.clientY);var b=this.view.scale;var d=this.view.translate;e.x=this.snap(e.x/b-d.x-this.gridSize/2);e.y=this.snap(e.y/b-d.y-this.gridSize/2);return e};mxGraph.prototype.getCells=function(h,g,d,m,j,n){var n=n||new Array();if(d>0||m>0){var l=h+d;var a=g+m;j=j||this.getDefaultParent();if(j!=null){var e=this.model.getChildCount(j);for(var f=0;f<e;f++){var k=this.model.getChildAt(j,f);var b=this.view.getState(k);if(this.isCellVisible(k)&&b!=null){if(b.x>=h&&b.y>=g&&b.x+b.width<=l&&b.y+b.height<=a){n.push(k)}else{this.getCells(h,g,d,m,k,n)}}}}}return n};mxGraph.prototype.getCellsBeyond=function(d,h,j,g,k){var l=new Array();if(g||k){if(j==null){j=this.getDefaultParent()}if(j!=null){var e=this.model.getChildCount(j);for(var f=0;f<e;f++){var b=this.model.getChildAt(j,f);var a=this.view.getState(b);if(this.isCellVisible(b)&&a!=null){if((!g||a.x>=d)&&(!k||a.y>=h)){l.push(b)}}}}}return l};mxGraph.prototype.findTreeRoots=function(q,n,d){n=(n!=null)?n:false;d=(d!=null)?d:false;var s=new Array();if(q!=null){var k=this.getModel();var g=k.getChildCount(q);var e=null;var o=0;for(var h=0;h<g;h++){var r=k.getChildAt(q,h);if(this.model.isVertex(r)&&this.isCellVisible(r)){var b=this.getConnections(r,(n)?q:null);var m=0;var l=0;for(var f=0;f<b.length;f++){var a=this.view.getVisibleTerminal(b[f],true);if(a==r){m++}else{l++}}if((d&&m==0&&l>0)||(!d&&l==0&&m>0)){s.push(r)}var p=(d)?l-m:m-l;if(p>o){o=p;e=r}}}if(s.length==0&&e!=null){s.push(e)}}return s};mxGraph.prototype.traverse=function(k,f,g,d,n){if(g!=null&&k!=null){f=(f!=null)?f:true;n=n||new Array();var b=mxCellPath.create(k);if(n[b]==null){n[b]=k;var o=g(k,d);if(o==null||o){var a=this.model.getEdgeCount(k);if(a>0){for(var h=0;h<a;h++){var l=this.model.getEdgeAt(k,h);var m=this.model.getTerminal(l,true)==k;if(!f||m){var j=this.model.getTerminal(l,!m);this.traverse(j,f,g,l,n)}}}}}}};mxGraph.prototype.isCellSelected=function(a){return this.selection.isSelected(a)};mxGraph.prototype.isSelectionEmpty=function(){return this.selection.cells.length==0};mxGraph.prototype.clearSelection=function(){return this.selection.clear()};mxGraph.prototype.getSelectionCount=function(){return this.selection.cells.length};mxGraph.prototype.getSelectionCell=function(){return this.selection.cells[0]};mxGraph.prototype.getSelectionCells=function(){return this.selection.cells.slice()};mxGraph.prototype.setSelectionCell=function(a){this.selection.setCell(a)};mxGraph.prototype.setSelectionCells=function(a){this.selection.setCells(a)};mxGraph.prototype.selectRegion=function(d,a){var b=this.getCells(d.x,d.y,d.width,d.height);this.selectCellsForEvent(b,a);return b};mxGraph.prototype.selectNext=function(){this.select(true)};mxGraph.prototype.selectPrevious=function(){this.select()};mxGraph.prototype.selectParent=function(){this.select(false,true)};mxGraph.prototype.selectChild=function(){this.select(false,false,true)};mxGraph.prototype.select=function(a,j,b){var e=this.selection;var m=(e.cells.length>0)?e.cells[0]:null;if(e.cells.length>1){e.clear()}var l=(m!=null)?this.model.getParent(m):this.getDefaultParent();var f=this.model.getChildCount(l);if(m==null&&f>0){var d=this.model.getChildAt(l,0);this.setSelectionCell(d)}else{if((m==null||j)&&this.view.getState(l)!=null&&this.model.getGeometry(l)!=null){if(this.getCurrentRoot()!=l){this.setSelectionCell(l)}}else{if(m!=null&&b){var h=this.model.getChildCount(m);if(h>0){var d=this.model.getChildAt(m,0);this.setSelectionCell(d)}}else{if(f>0){var g=l.getIndex(m);if(a){g++;var d=this.model.getChildAt(l,g%f);this.setSelectionCell(d)}else{g--;var k=(g<0)?f-1:g;var d=this.model.getChildAt(l,k);this.setSelectionCell(d)}}}}}};mxGraph.prototype.selectAll=function(b){b=b||this.getDefaultParent();var a=this.model.getChildren(b);if(a!=null){this.setSelectionCells(a)}};mxGraph.prototype.selectVertices=function(a){this.selectCells(true,false,a)};mxGraph.prototype.selectEdges=function(a){this.selectCells(false,true,a)};mxGraph.prototype.selectCells=function(e,b,g){g=g||this.getDefaultParent();var a=this;var f=function(h){return a.view.getState(h)!=null&&a.model.getChildCount(h)==0&&((a.model.isVertex(h)&&e)||(a.model.isEdge(h)&&b))};var d=this.model.getCells(f,g);this.setSelectionCells(d)};mxGraph.prototype.selectCellForEvent=function(a,b){var d=this.isCellSelected(a);if(mxEvent.isToggleEvent(b)){if(d){this.selection.removeCell(a)}else{this.selection.addCell(a)}}else{if(!d||this.getSelectionCount()!=1){this.setSelectionCell(a)}}};mxGraph.prototype.selectCellsForEvent=function(b,a){if(mxEvent.isToggleEvent(a)){this.selection.addCells(b)}else{this.setSelectionCells(b)}};mxGraph.prototype.selectCellsForEdit=function(g){if(g!=null&&g.changes!=null){var f=g.changes;var b=new Array();for(var e=0;e<f.length;e++){var h=f[e];if(h.constructor!=mxRootChange){var a=null;if(h.constructor==mxChildChange&&h.isAdded){a=h.child}else{if(h.cell!=null&&h.cell.constructor==mxCell){a=h.cell}}if(a!=null&&mxUtils.indexOf(b,a)<0){b.push(a)}}}var d=this.getModel().getTopmostCells(b);this.setSelectionCells(d)}};mxGraph.prototype.createHandler=function(a){if(this.model.isEdge(a.cell)){if(this.isLoop(a)||a.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||a.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.SideToSide||a.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom){a.handler=new mxElbowEdgeHandler(a)}else{a.handler=new mxEdgeHandler(a)}}else{a.handler=new mxVertexHandler(a)}};mxGraph.prototype.redrawHandler=function(a){if(a!=null&&a.handler!=null){a.handler.redraw()}};mxGraph.prototype.hasHandler=function(a){return a!=null&&a.handler!=null};mxGraph.prototype.destroyHandler=function(a){if(a!=null&&a.handler!=null){a.handler.destroy();a.handler=null}};mxGraph.prototype.addGraphListener=function(a){if(this.graphListeners==null){this.graphListeners=new Array()}this.graphListeners.push(a)};mxGraph.prototype.removeGraphListener=function(b){if(this.graphListeners!=null){for(var a=0;a<this.graphListeners.length;a++){if(this.graphListeners[a]==b){this.graphListeners.splice(a,1);break}}}};mxGraph.prototype.dispatchGraphEvent=function(h,b,a,d){if(!mxClient.IS_IE&&h=="mousedown"&&this.activeElement!=null){this.activeElement.blur()}if(typeof(mxDatatransfer)!="undefined"){mxDatatransfer.consumeSourceFunction(this,b,a)}if(h=="mousedown"){this.isMouseDown=true}if((h!="mouseup"||this.isMouseDown)&&b.detail!=2){if(h=="mouseup"){this.isMouseDown=false}if(!this.isEditing()&&(mxClient.IS_OP||mxClient.IS_SF||mxClient.IS_GC||b.target!=this.container)){if(this.gestureHandler!=null){if(h=="mousedown"){this.gestureHandler.mouseDown(b,a,d)}else{if(h=="mousemove"){this.gestureHandler.mouseMove(b,a,d)}else{if(h=="mouseup"){this.gestureHandler.mouseUp(b,a,d);this.gestureHandler=null}}}if(mxClient.IS_IE&&document.selection.type!="None"&&h!="mousedown"){try{document.selection.empty()}catch(g){}}}else{if(this.graphListeners!=null){b.returnValue=true;for(var f=0;f<this.graphListeners.length&&!mxEvent.isConsumed(b);f++){if(h=="mousedown"){this.graphListeners[f].mouseDown(b,a,d);if(mxEvent.isConsumed(b)){this.gestureHandler=this.graphListeners[f];break}}else{if(h=="mousemove"){this.graphListeners[f].mouseMove(b,a,d)}else{if(h=="mouseup"){this.graphListeners[f].mouseUp(b,a,d)}}}}}}if(h=="mouseup"){this.click(b,a)}}}};mxGraph.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tooltipHandler!=null){this.tooltipHandler.destroy()}if(this.panningHandler!=null){this.panningHandler.destroy()}if(this.connectionHandler!=null){this.connectionHandler.destroy()}if(this.graphHandler!=null){this.graphHandler.destroy()}if(this.editor!=null){this.editor.destroy()}if(this.view!=null){this.view.destroy()}if(this.focusHandler!=null){mxEvent.removeListener(document.body,"focus",this.focusHandler);this.focusHandler=null}if(this.blurHandler!=null){mxEvent.removeListener(document.body,"blur",this.blurHandler);this.blurHandler=null}this.activeElement=null;this.container=null}};function mxOverlay(b,a,e,d){this.image=b;this.tooltip=a;this.align=e;this.verticalAlign=d}mxOverlay.prototype=new mxEventSource();mxOverlay.prototype.constructor=mxOverlay;mxOverlay.prototype.image=null;mxOverlay.prototype.tooltip=null;mxOverlay.prototype.align=null;mxOverlay.prototype.verticalAlign=null;mxOverlay.prototype.defaultOverlap=0.5;mxOverlay.prototype.getBounds=function(a){var d=a.view.graph.getModel().isEdge(a.cell);var m=a.view.scale;var l=null;var e=this.image.width;var b=this.image.height;if(d){var k=a.absolutePoints;if(k.length%2==1){l=k[k.length/2+1]}else{var f=k.length/2;var j=k[f-1];var g=k[f];l=new mxPoint(j.x+(g.x-j.x)/2,j.y+(g.y-j.y)/2)}}else{l=new mxPoint();if(this.align==mxConstants.ALIGN_LEFT){l.x=a.x}else{if(this.align==mxConstants.ALIGN_CENTER){l.x=a.x+a.width/2}else{l.x=a.x+a.width}}if(this.verticalAlign==mxConstants.ALIGN_TOP){l.y=a.y}else{if(this.verticalAlign==mxConstants.ALIGN_MIDDLE){l.y=a.y+a.height/2}else{l.y=a.y+a.height}}}return new mxRectangle(l.x-e*this.defaultOverlap*m,l.y-b*this.defaultOverlap*m,e*m,b*m)};mxOverlay.prototype.toString=function(){return this.tooltip};function mxOutline(h,d){this.source=h;this.graph=new mxGraph(d,h.getModel(),this.graphRenderHint);if(mxClient.IS_SVG){var g=this.graph.getView().getCanvas().parentNode;g.setAttribute("shape-rendering","optimizeSpeed");g.setAttribute("image-rendering","optimizeSpeed")}this.graph.setStylesheet(h.getStylesheet());this.graph.setEnabled(false);this.graph.labelsVisible=false;var e=this;h.getModel().addListener("change",function(j,k){e.update()});this.graph.addGraphListener(this);var e=this;var b=function(j){e.update()};this.source.getModel().addListener("change",b);var a=this.source.getView();a.addListener("scale",b);a.addListener("translate",b);a.addListener("scaleAndTranslate",b);a.addListener("scale",b);a.addListener("down",b);a.addListener("up",b);h.addListener("refresh",function(j){e.graph.setStylesheet(h.getStylesheet());e.graph.refresh()});this.bounds=new mxRectangle(0,0,0,0);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.graph.getView().getOverlayPane());var f=3;this.sizer=new mxRectangleShape(this.bounds,mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR);this.sizer.dialect=this.graph.dialect;this.sizer.init(this.graph.getView().getOverlayPane());if(this.enabled){this.sizer.node.style.cursor="pointer"}mxEvent.addListener(this.sizer.node,"mousedown",function(j){e.graph.dispatchGraphEvent("mousedown",j,null,0)});this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;this.refresh()}mxOutline.prototype.graphRenderHint="faster";mxOutline.prototype.enabled=true;mxOutline.prototype.showViewport=true;mxOutline.prototype.isEnabled=function(){return this.enabled};mxOutline.prototype.setEnabled=function(a){this.enabled=a};mxOutline.prototype.refresh=function(a){this.update();this.graph.refresh()};mxOutline.prototype.update=function(b){var d=this.source.getBounds();var m=parseInt(this.source.container.clientWidth);var u=parseInt(this.source.container.clientHeight);var r=this.graph.container;var a=parseInt(r.clientWidth);var g=parseInt(r.clientHeight);if(a>0||g>0){var f=Math.max(m,d.width+Math.abs(d.x))+a*0.1;var p=Math.max(u,d.height+Math.abs(d.y))+g*0.1;var y=Math.min(a/f,g/p);if(this.graph.getView().scale!=y){this.graph.getView().scale=y;b=true}}var q=this.graph.getView();if(q.currentRoot!=this.source.getView().currentRoot){q.setCurrentRoot(this.source.getView().currentRoot)}var k=this.source.view.translate;var x=Math.max(0,k.x);var v=Math.max(0,k.y);if(q.translate.x!=x||q.translate.y!=v){q.translate.x=x;q.translate.y=v;b=true}var e=q.translate;var y=this.source.getView().scale;var o=y/q.scale;var n=1/q.scale;var j=this.source.container;this.bounds=new mxRectangle((e.x-k.x)/n,(e.y-k.y)/n,(j.clientWidth/o),((j.clientHeight)/o));this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw();var l=3;this.sizer.bounds=new mxRectangle(this.bounds.x+this.bounds.width-l,this.bounds.y+this.bounds.height-l,2*l,2*l);this.sizer.redraw();if(b){this.graph.view.revalidate()}};mxOutline.prototype.mouseDown=function(b,a,d){if(this.enabled&&this.showViewport){this.index=d;this.startX=b.clientX;this.startY=b.clientY;this.active=true}mxEvent.consume(b)};mxOutline.prototype.mouseMove=function(e,f){if(this.active){this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;var k=e.clientX-this.startX;var g=e.clientY-this.startY;var a=null;if(this.index==null){var d=this.graph.getView().scale;a=new mxRectangle(this.bounds.x+k,this.bounds.y+g,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=a;this.selectionBorder.redraw();k/=d;k*=this.source.getView().scale;g/=d;g*=this.source.getView().scale;this.source.shift(-k,-g)}else{var b=this.source.container;var j=b.clientWidth/b.clientHeight;g=k/j;a=new mxRectangle(this.bounds.x,this.bounds.y,this.bounds.width+k,this.bounds.height+g);this.selectionBorder.bounds=a;this.selectionBorder.redraw()}var h=3;this.sizer.bounds=new mxRectangle(a.x+a.width-h,a.y+a.height-h,2*h,2*h);this.sizer.redraw();mxEvent.consume(e)}};mxOutline.prototype.mouseUp=function(e,a){if(this.active){var f=e.clientX-this.startX;var d=e.clientY-this.startY;if(Math.abs(f)>0||Math.abs(d)>0){if(this.index==null){this.source.shift(0,0);f/=this.graph.getView().scale;d/=this.graph.getView().scale;var g=this.source.getView().translate;this.source.getView().setTranslate(g.x-f,g.y-d)}else{var b=this.selectionBorder.bounds.width;var j=this.selectionBorder.bounds.height;var k=this.source.getView().scale;this.source.getView().setScale(k-(f*k)/b)}this.update();mxEvent.consume(e)}this.index=null;this.active=false}};function mxMultiplicity(a,h,f,l,d,k,b,e,j,g){this.source=a;this.type=h;this.attr=f;this.value=l;this.min=(d!=null)?d:0;this.max=(k!=null)?k:"n";this.validNeighbors=b;this.countError=mxResources.get(e)||e;this.typeError=mxResources.get(j)||j;this.validNeighborsAllowed=(g!=null)?g:true}mxMultiplicity.prototype.type=null;mxMultiplicity.prototype.attr=null;mxMultiplicity.prototype.value=null;mxMultiplicity.prototype.source=null;mxMultiplicity.prototype.min=null;mxMultiplicity.prototype.max=null;mxMultiplicity.prototype.validNeighbors=null;mxMultiplicity.prototype.validNeighborsAllowed=true;mxMultiplicity.prototype.countError=null;mxMultiplicity.prototype.typeError=null;mxMultiplicity.prototype.check=function(n,d,b,h,l,g){var k="";var m=n.model.getValue(b);var f=n.model.getTarget(b);if((m!=null&&f!=null)&&((this.source&&mxUtils.isNode(m,this.type,this.attr,this.value))||(!this.source&&mxUtils.isNode(f,this.type,this.attr,this.value)))){if((this.source&&(this.max==0||(l>=this.max)))||(!this.source&&(this.max==0||(g>=this.max)))){k+=this.countError+"\n"}var a=this.validNeighbors;var o=!this.validNeighborsAllowed;if(a!=null&&a.length>0){for(var e=0;e<a.length;e++){if(this.source&&mxUtils.isNode(f,a[e])){o=this.validNeighborsAllowed;break}else{if(!this.source&&mxUtils.isNode(m,a[e])){o=this.validNeighborsAllowed;break}}}if(!o){k+=this.typeError+"\n"}}}return(k.length>0)?k:null};function mxGraphHandler(a){this.graph=a;if(document.body!=null){this.graph.addGraphListener(this)}}mxGraphHandler.prototype.graph=null;mxGraphHandler.prototype.maxCells=(mxClient.IS_IE)?20:50;mxGraphHandler.prototype.enabled=true;mxGraphHandler.prototype.cloneEnabled=true;mxGraphHandler.prototype.minimumSize=6;mxGraphHandler.prototype.connectOnDrop=false;mxGraphHandler.prototype.scrollOnMove=true;mxGraphHandler.prototype.isEnabled=function(){return this.enabled};mxGraphHandler.prototype.setEnabled=function(a){this.enabled=a};mxGraphHandler.prototype.mouseDown=function(b,a,e){if(this.isEnabled()&&this.graph.isEnabled()&&!mxEvent.isForceMarqueeEvent(b)&&e==null&&a!=null){this.cell=null;this.delayedSelection=this.graph.isCellSelected(a);if(!this.delayedSelection){this.graph.selectCellForEvent(a,b)}var d=this.graph.model;var f=d.getGeometry(a);if(this.graph.isMovable(a)&&((!d.isEdge(a)||this.graph.getSelectionCount()>1||(f.points!=null&&f.points.length>0)||d.getTerminal(a,true)==null||d.getTerminal(a,false)==null)||this.graph.allowDanglingEdges||(mxEvent.isCloneEvent(b)&&this.graph.isCloneable()))){this.start(b,a,e)}this.cellWasClicked=true;mxEvent.consume(b)}};mxGraphHandler.prototype.start=function(d,a,g){this.startX=d.clientX;this.startY=d.clientY;var j=this.graph.getSelectionCells();this.cells=new Array();for(var h=0;h<j.length;h++){if(this.graph.isMovable(j[h])){this.cells.push(j[h])}}this.bounds=this.graph.getView().getBounds(this.cells);if(this.bounds!=null){if(this.bounds.width<this.minimumSize){var f=this.minimumSize-this.bounds.width;this.bounds.x-=f/2;this.bounds.width=this.minimumSize}if(this.bounds.height<this.minimumSize){var b=this.minimumSize-this.bounds.height;this.bounds.y-=b/2;this.bounds.height=this.minimumSize}this.shape=new mxRectangleShape(this.bounds,null,"black");this.shape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.isDashed=true;this.shape.init(this.graph.getView().getOverlayPane());if(this.graph.dialect!=mxConstants.DIALECT_SVG){var e=this;mxEvent.addListener(this.shape.node,"mousemove",function(k){e.graph.dispatchGraphEvent("mousemove",k,e.target||e.cell)})}else{this.shape.node.setAttribute("style","pointer-events:none;")}this.shape.node.style.visibility="hidden";this.highlight=new mxRectangleShape(new mxRectangle(0,0,0,0),null,mxConstants.DROP_TARGET_COLOR,"3");this.highlight.dialect=this.shape.dialect;this.highlight.init(this.graph.getView().getOverlayPane());if(this.graph.dialect!=mxConstants.DIALECT_SVG){var e=this;mxEvent.addListener(this.highlight.node,"mousemove",function(k){e.graph.dispatchGraphEvent("mousemove",k,e.target)})}else{this.highlight.node.setAttribute("style","pointer-events:none;")}this.cell=a;this.highlight.node.style.visibility="hidden"}};mxGraphHandler.prototype.mouseMove=function(o,p){var q=this.graph;if(this.cell!=null){if(this.shape!=null&&this.shape.node!=null){var s=o.clientX-this.startX;var r=o.clientY-this.startY;var f=q.getView().translate;var d=q.getView().scale;if(mxEvent.isGridEnabledEvent(o)){var h=this.bounds.x-(this.graph.snap(this.bounds.x/d-f.x)+f.x)*d;var g=this.bounds.y-(this.graph.snap(this.bounds.y/d-f.y)+f.y)*d;s=this.graph.snap(s/d)*d-h;r=this.graph.snap(r/d)*d-g}if(o.shiftKey){if(Math.abs(s)>Math.abs(r)){r=0}else{s=0}}var a=new mxRectangle(this.bounds.x+s,this.bounds.y+r,this.bounds.width,this.bounds.height);this.shape.bounds=a;this.shape.node.style.visibility="visible";this.shape.redraw();var k=(q.isDropEnabled())?q.getDropTarget(this.cells,o,p):null;var n=k;var j=q.getModel();while(n!=null&&n!=this.cell){n=j.getParent(n)}var m=mxEvent.isCloneEvent(o)&&q.isCloneable()&&this.cloneEnabled;var b=q.getView().getState(k);if(!q.isCellSelected(k)&&b!=null&&n==null&&(j.getParent(this.cell)!=k||m)){if(this.target!=k){this.target=k;this.setHighlightColor(mxConstants.DROP_TARGET_COLOR);this.highlight.bounds=b;this.highlight.node.style.visibility="visible";this.highlight.redraw()}}else{this.target=null;if(this.connectOnDrop&&p!=null&&this.cells.length==1&&q.getModel().isVertex(p)&&q.getModel().isConnectable(p)){var b=q.getView().getState(p);if(b!=null){var l=q.getEdgeValidationError(null,this.cell,p);var e=(l==null)?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR;this.setHighlightColor(e);this.highlight.bounds=b;this.highlight.node.style.visibility="visible";this.highlight.redraw()}else{this.highlight.node.style.visibility="hidden"}}else{this.highlight.node.style.visibility="hidden"}}}mxEvent.consume(o)}};mxGraphHandler.prototype.setHighlightColor=function(a){if(this.highlight.dialect==mxConstants.DIALECT_SVG){this.highlight.innerNode.setAttribute("stroke",a)}else{this.highlight.node.setAttribute("strokecolor",a)}};mxGraphHandler.prototype.mouseUp=function(g,h){var j=this.graph;if(this.cell!=null&&this.shape!=null&&(g.clientX!=this.startX||g.clientY!=this.startY)){var b=j.getView().translate;var a=j.getView().scale;var f=mxEvent.isCloneEvent(g)&&j.isCloneable()&&this.cloneEnabled;var l=(g.clientX-this.startX)/a;var k=(g.clientY-this.startY)/a;if(mxEvent.isGridEnabledEvent(g)){var e=this.bounds.x-(this.graph.snap(this.bounds.x/a-b.x)+b.x)*a;var d=this.bounds.y-(this.graph.snap(this.bounds.y/a-b.y)+b.y)*a;l=j.snap(l)-e/a;k=j.snap(k)-d/a}if(g.shiftKey){if(Math.abs(l)>Math.abs(k)){k=0}else{l=0}}if(this.connectOnDrop&&this.target==null&&h!=null&&j.getModel().isVertex(h)&&j.getModel().isConnectable(h)&&j.isEdgeValid(null,this.cell,h)){this.graph.connectionHandler.connect(this.cell,h,g)}else{this.move(this.graph.getSelectionCells(),l,k,f,this.target,g)}}else{if(this.delayedSelection&&this.cell!=null){this.graph.selectCellForEvent(this.cell,g)}}if(this.cellWasClicked){mxEvent.consume(g)}this.reset()};mxGraphHandler.prototype.reset=function(){if(this.shape!=null){this.shape.destroy();this.shape=null}if(this.highlight!=null){this.highlight.destroy();this.highlight=null}this.cellWasClicked=false;this.delayedSelection=false;this.cell=null;this.target=null};mxGraphHandler.prototype.move=function(e,d,b,g,f,a){var e=this.graph.move(e,d,b,g,f,a);if(this.scrollOnMove){this.graph.scrollCellToVisible(e[0])}if(g){this.graph.setSelectionCells(e)}};mxGraphHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);if(this.shape!=null){this.shape.destroy();this.shape=null}if(this.highlight!=null){this.highlight.destroy();this.highlight=null}};function mxPanningHandler(b,a){if(b!=null&&document.body!=null){this.graph=b;this.factoryMethod=a;this.graph.addGraphListener(this)}}mxPanningHandler.prototype=new mxPopupMenu();mxPanningHandler.prototype.constructor=mxPanningHandler;mxPanningHandler.prototype.graph=null;mxPanningHandler.prototype.usePopupTrigger=true;mxPanningHandler.prototype.useLeftButtonForPanning=false;mxPanningHandler.prototype.selectOnPopup=true;mxPanningHandler.prototype.clearSelectionOnBackground=true;mxPanningHandler.prototype.ignoreCell=false;mxPanningHandler.prototype.useGrid=false;mxPanningHandler.prototype.panningEnabled=true;mxPanningHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this);var a=this;mxEvent.addListener(this.div,"mousemove",function(b){a.graph.tooltipHandler.hide()})};mxPanningHandler.prototype.isPanningTrigger=function(b,a){return(this.useLeftButtonForPanning&&(this.ignoreCell||(a==null))&&mxEvent.isLeftMouseButton(b))||(this.useShiftKey&&b.shiftKey)||(this.usePopupTrigger&&mxEvent.isPopupTrigger(b))};mxPanningHandler.prototype.mouseDown=function(b,a){if(this.isEnabled()){this.hideMenu();this.dx0=-this.graph.container.scrollLeft;this.dy0=-this.graph.container.scrollTop;this.popupTrigger=this.isPopupTrigger(b,a);this.panningTrigger=this.panningEnabled&&this.isPanningTrigger(b,a);this.startX=b.clientX;this.startY=b.clientY;if((this.panningEnabled&&this.panningTrigger)||this.popupTrigger){mxEvent.consume(b)}}};mxPanningHandler.prototype.mouseMove=function(d,a){var e=d.clientX-this.startX;var b=d.clientY-this.startY;if(this.active){if(this.useGrid){e=this.graph.snap(e);b=this.graph.snap(b)}this.graph.shift(e+this.dx0,b+this.dy0);mxEvent.consume(d)}else{if(this.panningTrigger){this.active=Math.abs(e)>this.graph.tolerance||Math.abs(b)>this.graph.tolerance}}};mxPanningHandler.prototype.mouseUp=function(f,g){var k=Math.abs(f.clientX-this.startX);var j=Math.abs(f.clientY-this.startY);if(this.active){var a=mxUtils.getCurrentStyle(this.graph.container);if(!mxUtils.hasScrollbars(this.graph.container)){this.graph.shift(0,0);var k=f.clientX-this.startX;var j=f.clientY-this.startY;var b=this.graph.getView().scale;var h=this.graph.getView().translate;this.pan(h.x+k/b,h.y+j/b)}mxEvent.consume(f)}else{if(this.popupTrigger){if(k<this.graph.tolerance&&j<this.graph.tolerance){if(this.graph.isEnabled()&&this.selectOnPopup&&g!=null&&!this.graph.isCellSelected(g)){this.graph.setSelectionCell(g)}if(this.clearSelectionOnBackground&&!this.graph.isCellSelected(g)){this.graph.clearSelection()}this.graph.tooltipHandler.hide();var e=mxUtils.getScrollOrigin();var d=new mxPoint(f.clientX+e.x,f.clientY+e.y);this.popup(d.x,d.y,g,f)}mxEvent.consume(f)}}this.panningTrigger=false;this.popupTrigger=false;this.active=false};mxPanningHandler.prototype.pan=function(b,a){this.graph.getView().setTranslate(b,a)};mxPanningHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);mxPopupMenu.prototype.destroy.apply(this)};function mxCellMarker(e,f,b,d){if(e!=null){this.graph=e;this.validColor=(f!=null)?f:mxConstants.DEFAULT_VALID_COLOR;this.invalidColor=(f!=null)?b:mxConstants.DEFAULT_INVALID_COLOR;this.hotspot=(d!=null)?d:mxConstants.DEFAULT_HOTSPOT;var g=mxConstants.HIGHLIGHT_STROKEWIDTH;this.shape=new mxRectangleShape(new mxRectangle(),null,this.validColor,g);this.shape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.init(e.getView().getOverlayPane());this.shape.node.style.background="";this.shape.node.style.display="none";this.edgeShape=new mxPolyline([new mxPoint(),new mxPoint()],this.validColor,g);this.edgeShape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.edgeShape.init(e.getView().getOverlayPane());this.edgeShape.node.style.display="none";var a=this;mxEvent.addListener(this.shape.node,"mousedown",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mousedown",j,h)});mxEvent.addListener(this.shape.node,"mousemove",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mousemove",j,h)});mxEvent.addListener(this.shape.node,"mouseup",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mouseup",j,h)});mxEvent.addListener(this.edgeShape.node,"mousedown",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mousedown",j,h)});mxEvent.addListener(this.edgeShape.node,"mousemove",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mousemove",j,h)});mxEvent.addListener(this.edgeShape.node,"mouseup",function(j){var h=(a.markedState!=null)?a.markedState.cell:null;e.dispatchGraphEvent("mouseup",j,h)});this.resetHandler=function(h){a.reset()};this.graph.getView().addListener("scale",this.resetHandler);this.graph.getView().addListener("translate",this.resetHandler);this.graph.getView().addListener("scaleAndTranslate",this.resetHandler);this.graph.getView().addListener("down",this.resetHandler);this.graph.getView().addListener("up",this.resetHandler);this.graph.getModel().addListener("change",this.resetHandler)}}mxCellMarker.prototype=new mxEventSource();mxCellMarker.prototype.constructor=mxCellMarker;mxCellMarker.prototype.graph=null;mxCellMarker.prototype.enabled=true;mxCellMarker.prototype.hotspot=mxConstants.DEFAULT_HOTSPOT;mxCellMarker.prototype.hotspotEnabled=false;mxCellMarker.prototype.validColor=null;mxCellMarker.prototype.invalidColor=null;mxCellMarker.prototype.currentColor=null;mxCellMarker.prototype.validState=null;mxCellMarker.prototype.markedState=null;mxCellMarker.prototype.resetHandler=null;mxCellMarker.prototype.setEnabled=function(a){this.enabled=a};mxCellMarker.prototype.isEnabled=function(){return this.enabled};mxCellMarker.prototype.setHotspot=function(a){this.hotspot=a};mxCellMarker.prototype.getHotspot=function(){return this.hotspot};mxCellMarker.prototype.setHotspotEnabled=function(a){this.hotspotEnabled=a};mxCellMarker.prototype.isHotspotEnabled=function(){return this.hotspotEnabled};mxCellMarker.prototype.hasValidState=function(){return this.validState!=null};mxCellMarker.prototype.getValidState=function(){return this.validState};mxCellMarker.prototype.getMarkedState=function(){return this.markedState};mxCellMarker.prototype.reset=function(){this.validState=null;if(this.markedState!=null){this.markedState=null;this.unmark()}};mxCellMarker.prototype.process=function(b,a){var e=null;if(this.isEnabled()){e=this.getState(b,a);var f=(e!=null)?this.isValidState(e):false;var d=this.getMarkerColor(b,e,f);if(f){this.validState=e}else{this.validState=null}if(e!=this.markedState||d!=this.currentColor){this.currentColor=d;if(e!=null&&this.currentColor!=null){this.markedState=e;this.mark()}else{if(this.markedState!=null){this.markedState=null;this.unmark()}}}}return e};mxCellMarker.prototype.mark=function(){if(this.markedState!=null){var a=null;if(this.graph.model.isEdge(this.markedState.cell)){a=this.edgeShape;a.points=this.markedState.absolutePoints;this.shape.node.style.display="none"}else{a=this.shape;a.bounds=new mxRectangle(this.markedState.x-2,this.markedState.y-2,this.markedState.width+4,this.markedState.height+4);this.edgeShape.node.style.display="none"}a.node.style.display="inline";a.redraw();if(a.dialect==mxConstants.DIALECT_SVG){a.innerNode.setAttribute("stroke",this.currentColor)}else{a.node.setAttribute("strokecolor",this.currentColor)}this.dispatchEvent("mark",this,this.markedState)}};mxCellMarker.prototype.unmark=function(){this.edgeShape.node.style.display="none";this.shape.node.style.display="none";this.dispatchEvent("mark",this)};mxCellMarker.prototype.isValidState=function(a){return true};mxCellMarker.prototype.getMarkerColor=function(a,b,d){return(d)?this.validColor:this.invalidColor};mxCellMarker.prototype.getState=function(d,a){var b=this.graph.getView();a=this.getCell(d,a);var e=this.getStateToMark(b.getState(a));return(e!=null&&this.intersects(e,d))?e:null};mxCellMarker.prototype.getCell=function(b,a){return a};mxCellMarker.prototype.getStateToMark=function(a){return a};mxCellMarker.prototype.intersects=function(a,l){if(this.hotspotEnabled&&this.hotspot>0){var e=a.x+a.width/2;var d=a.y+a.height/2;var k=a.width;var f=a.height;var b=mxUtils.getValue(a.style,mxConstants.STYLE_STARTSIZE);if(b>0){if(mxUtils.getValue(a.style,mxConstants.STYLE_HORIZONTAL,true)){d=a.y+b/2;f=b}else{e=a.x+b/2;k=b}}var k=Math.max(mxConstants.MIN_HOTSPOT_SIZE,k*this.hotspot);var f=Math.max(mxConstants.MIN_HOTSPOT_SIZE,f*this.hotspot);if(mxConstants.MAX_HOTSPOT_SIZE>0){k=Math.min(k,mxConstants.MAX_HOTSPOT_SIZE);f=Math.min(f,mxConstants.MAX_HOTSPOT_SIZE)}var g=new mxRectangle(e-k/2,d-f/2,k,f);var j=mxUtils.convertPoint(this.graph.container,l.clientX,l.clientY);return mxUtils.contains(g,j.x,j.y)}return true};mxCellMarker.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);if(this.shape!=null){this.shape.destroy();this.shape=null}if(this.edgeShape!=null){this.edgeShape.destroy();this.edgeShape=null}};function mxConnectionHandler(b,a){if(b!=null){this.graph=b;this.factoryMethod=a;this.init();if(document.body!=null){this.graph.addGraphListener(this)}}}mxConnectionHandler.prototype.graph=null;mxConnectionHandler.prototype.factoryMethod=true;mxConnectionHandler.prototype.connectImage=null;mxConnectionHandler.prototype.enabled=true;mxConnectionHandler.prototype.select=true;mxConnectionHandler.prototype.createTarget=false;mxConnectionHandler.prototype.marker=null;mxConnectionHandler.prototype.error=null;mxConnectionHandler.prototype.isEnabled=function(){return this.enabled};mxConnectionHandler.prototype.setEnabled=function(a){this.enabled=a};mxConnectionHandler.prototype.init=function(){if(this.graph.container!=null){this.marker=this.createMarker();this.shape=new mxPolyline(new Array(),mxConstants.INVALID_COLOR);this.shape.isDashed=true;this.shape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.node.style.display="none";if(this.graph.dialect!=mxConstants.DIALECT_SVG){mxEvent.redirectMouseEvents(this.shape.node,this.graph,null,null,true)}else{this.shape.pipe.setAttribute("style","pointer-events:none;");this.shape.innerNode.setAttribute("style","pointer-events:none;")}var a=this;var b=function(e){if(a.iconState!=null){a.iconState=a.graph.getView().getState(a.iconState.cell)}if(a.iconState!=null){a.redrawIcons(a.icons)}else{a.destroyIcons(a.icons);a.previous=null}};this.graph.getModel().addListener("change",b);this.graph.getView().addListener("scale",b);this.graph.getView().addListener("translate",b);this.graph.getView().addListener("scaleAndTranslate",b);var d=function(e){a.destroyIcons(a.icons)};this.graph.addListener("startEditing",d);this.graph.getView().addListener("down",d);this.graph.getView().addListener("up",d)}};mxConnectionHandler.prototype.createMarker=function(){var a=new mxCellMarker(this.graph);a.hotspotEnabled=true;var b=this;a.getCell=function(e,d){var d=mxCellMarker.prototype.getCell.apply(this,arguments);b.error=null;if(d!=null){if(b.isConnecting()){if(b.previous!=null){b.error=b.validateConnection(b.previous.cell,d);if(b.error!=null&&b.error.length==0){d=null;if(b.createTarget){b.error=null}}}}else{if(!b.isValidSource(d)){d=null}}}else{if(b.isConnecting()&&!b.createTarget&&!b.graph.allowDanglingEdges){b.error=""}}return d};a.isValidState=function(d){if(b.isConnecting()){return b.error==null}else{return mxCellMarker.prototype.isValidState.apply(this,arguments)}};a.getMarkerColor=function(d,e,f){return(b.connectImage==null||b.isConnecting())?mxCellMarker.prototype.getMarkerColor.apply(this,arguments):null};a.intersects=function(e,d){if(b.connectImage!=null||b.isConnecting()){return true}return mxCellMarker.prototype.intersects.apply(this,arguments)};return a};mxConnectionHandler.prototype.isConnecting=function(){return this.start!=null&&this.shape.node.style.display=="inline"};mxConnectionHandler.prototype.isValidSource=function(a){return this.graph.isValidSource(a)};mxConnectionHandler.prototype.isValidTarget=function(a){return true};mxConnectionHandler.prototype.validateConnection=function(a,b){if(!this.isValidTarget(b)){return""}return this.graph.getEdgeValidationError(null,a,b)};mxConnectionHandler.prototype.getConnectImage=function(a){return this.connectImage};mxConnectionHandler.prototype.createIcons=function(f){var g=this.getConnectImage(f);if(g!=null&&f!=null){this.iconState=f;var b=new Array();var e=new mxRectangle(0,0,g.width,g.height);var d=new mxImageShape(e,g.src);d.dialect=(this.graph.dialect==mxConstants.DIALECT_SVG)?mxConstants.DIALECT_STRICTHTML:mxConstants.DIALECT_VML;d.init((this.graph.dialect==mxConstants.DIALECT_SVG)?this.graph.container:this.graph.getView().getOverlayPane());d.node.style.cursor=(mxClient.IS_IE)?"all-scroll":"pointer";var a=this;mxEvent.addListener(d.node,"dblclick",function(h){a.graph.dblClick(h,f.cell);mxEvent.consume(h)});mxEvent.addListener(d.node,"mousedown",function(h){a.icon=d;a.graph.dispatchGraphEvent("mousedown",h,f.cell)});mxEvent.addListener(d.node,"mousemove",function(h){a.graph.dispatchGraphEvent("mousemove",h,f.cell)});mxEvent.addListener(d.node,"mouseup",function(h){a.graph.dispatchGraphEvent("mouseup",h,f.cell)});b.push(d);this.redrawIcons(b);return b}return null};mxConnectionHandler.prototype.redrawIcons=function(d){if(d!=null&&this.iconState!=null){var f=this.getConnectImage(this.iconState);if(f!=null){var g=this.graph.getView().scale;var a=this.iconState.getCenterX();var h=this.iconState.getCenterY();if(this.graph.isSwimlane(this.iconState.cell)){var b=this.graph.getStartSize(this.iconState.cell);a=(b.width!=0)?this.iconState.x+b.width*g/2:a;h=(b.height!=0)?this.iconState.y+b.height*g/2:h}var e=d[0];e.bounds.x=a-e.bounds.width/2;e.bounds.y=h-e.bounds.height/2;e.redraw()}}};mxConnectionHandler.prototype.destroyIcons=function(b){if(b!=null){this.iconState=null;for(var a=0;a<b.length;a++){b[a].destroy()}}};mxConnectionHandler.prototype.mouseDown=function(b,a,d){if(this.isEnabled()&&this.graph.isEnabled()&&!mxEvent.isForceMarqueeEvent(b)&&this.previous!=null&&this.error==null&&((this.icons==null)||(this.icons!=null&&this.icon!=null))&&d==null){this.start=mxUtils.convertPoint(this.graph.container,b.clientX,b.clientY);mxEvent.consume(b)}this.selectedIcon=this.icon;this.icon=null};mxConnectionHandler.prototype.mouseMove=function(m,a,d){if(this.graph.isEnabled()&&this.isEnabled()&&d==null){var b=this.marker.process(m,a);if(this.previous!=null&&this.start!=null){if(this.selectedIcon!=null){var g=this.selectedIcon.bounds.width;var t=this.selectedIcon.bounds.height;var p=mxUtils.convertPoint(this.graph.container,m.clientX,m.clientY);var e=new mxRectangle(p.x,p.y+mxConstants.TOOLTIP_VERTICAL_OFFSET,g,t);this.selectedIcon.bounds=e;this.selectedIcon.redraw()}var l=this.graph.getView();var r=mxUtils.convertPoint(this.graph.container,m.clientX,m.clientY);var v=l.scale;r.x=this.graph.snap(r.x/v)*v;r.y=this.graph.snap(r.y/v)*v;var q=r;if(b!=null){var o=l.getPerimeterFunction(b);if(o!=null){var n=new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());var u=o(l.getPerimeterBounds(b,null,false),null,b,false,n);if(u!=null){q=u}}else{q=new mxPoint(b.getCenterX(),b.getCenterY())}}var p=this.start;var k=l.getPerimeterFunction(this.previous);if(k!=null){var u=k(l.getPerimeterBounds(this.previous,null,true),null,this.previous,true,q);if(u!=null){p=u}}else{p=new mxPoint(this.previous.getCenterX(),this.previous.getCenterY())}if(b==null){var j=q.x-p.x;var f=q.y-p.y;var s=Math.sqrt(j*j+f*f);q.x-=j*4/s;q.y-=f*4/s}this.shape.points=[p,q];if(this.shape.node.style.display!="inline"){var j=Math.abs(r.x-this.start.x);var f=Math.abs(r.y-this.start.y);if(j>this.graph.tolerance||f>this.graph.tolerance){this.shape.node.style.display="inline"}}this.drawPreview();mxEvent.consume(m)}else{if(this.previous!=b){if(this.previous!=null&&this.previous.shape!=null){this.previous.shape.node.style.cursor=this.previousCursor}this.destroyIcons(this.icons);this.icons=null;if(b!=null&&this.error==null){this.previousCursor=b.shape.node.style.cursor;b.shape.node.style.cursor=(mxClient.IS_IE)?"all-scroll":"default";this.icons=this.createIcons(b)}this.previous=b}}}};mxConnectionHandler.prototype.mouseUp=function(b,a){if(this.isConnecting()){if(this.error==null){var d=this.previous.cell;var e=this.marker.hasValidState()?this.marker.validState.cell:null;this.connect(d,e,b,a)}else{if(this.previous!=null&&this.marker.validState!=null&&this.previous.cell==this.marker.validState.cell){this.graph.selectCellForEvent(this.marker.source,b)}if(this.error.length>0){this.graph.validationAlert(this.error)}}this.destroyIcons(this.icons);mxEvent.consume(b)}else{if(this.isEnabled()&&this.graph.isEnabled()){this.graph.selectCellForEvent(a,b)}}this.reset()};mxConnectionHandler.prototype.reset=function(){this.shape.node.style.display="none";this.marker.reset();this.selectedIcon=null;this.previous=null;this.error=null;this.start=null;this.icon=null};mxConnectionHandler.prototype.drawPreview=function(){var b=this.error==null;var a=this.getEdgeColor(b);if(this.shape.dialect==mxConstants.DIALECT_SVG){this.shape.innerNode.setAttribute("stroke",a)}else{this.shape.node.setAttribute("strokecolor",a)}this.shape.strokewidth=this.getEdgeWidth(b);this.shape.redraw()};mxConnectionHandler.prototype.getEdgeColor=function(a){return(a)?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR};mxConnectionHandler.prototype.getEdgeWidth=function(a){return(a)?3:1};mxConnectionHandler.prototype.connect=function(b,j,l,a){if(b!=null&&(j!=null||this.createTarget||this.graph.allowDanglingEdges)){var h=this.graph.getModel();var d=null;h.beginUpdate();try{if(j==null&&this.createTarget){j=this.createTargetVertex(l,b);if(j!=null){a=this.graph.getDropTarget([j],l,a);if(a==null||!this.graph.getModel().isEdge(a)){var f=this.graph.getView().getState(a);if(f!=null){var g=h.getGeometry(j);g.x-=f.origin.x;g.y-=f.origin.y}}else{a=this.graph.getDefaultParent()}this.graph.addCell(j,a)}}var k=this.graph.getDefaultParent();if(h.getParent(b)==h.getParent(j)){k=h.getParent(b)}d=this.insertEdge(k,null,null,b,j);var e=h.getGeometry(d);if(e==null){e=new mxGeometry();e.relative=true;h.setGeometry(d,e)}if(j==null){var m=this.graph.getPointForEvent(l);e.setTerminalPoint(m,false)}}finally{h.endUpdate()}if(this.select){this.graph.setSelectionCell(d)}}};mxConnectionHandler.prototype.insertEdge=function(a,g,e,d,f){if(this.factoryMethod==null){return this.graph.insertEdge(a,g,e,d,f)}else{var b=this.createEdge(d,f);b=this.graph.addEdge(b,a,d,f);return b}};mxConnectionHandler.prototype.createTargetVertex=function(b,e){var g=this.graph.cloneCells([e])[0];var d=this.graph.getModel();var f=d.getGeometry(g);if(f!=null){var a=this.graph.getPointForEvent(b);f.x=this.graph.snap(a.x-f.width/2);f.y=this.graph.snap(a.y-f.height/2)}return g};mxConnectionHandler.prototype.createEdge=function(b,d){var a=null;if(this.factoryMethod!=null){a=this.factoryMethod(b,d)}else{a=new mxCell("");a.setEdge(true)}return a};mxConnectionHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);this.shape.destroy();this.shape=null;this.marker.destroy();this.marker=null};function mxRubberband(b){if(b!=null){this.graph=b;this.graph.addGraphListener(this);this.div=document.createElement("div");this.div.className="mxRubberband";mxUtils.setOpacity(this.div,this.defaultOpacity);mxEvent.redirectMouseEvents(this.div,this.graph);if(mxClient.IS_IE){var a=this;mxEvent.addListener(window,"unload",function(){a.destroy()})}}}mxRubberband.prototype.defaultOpacity=20;mxRubberband.prototype.enabled=true;mxRubberband.prototype.isEnabled=function(){return this.enabled};mxRubberband.prototype.setEnabled=function(a){this.enabled=a};mxRubberband.prototype.mouseDown=function(b,a,e){if(this.graph.isEnabled()&&this.isEnabled()&&a==null&&e==null){var f=mxUtils.getOffset(this.graph.container);var d=mxUtils.getScrollOrigin(this.graph.container);d.x-=f.x;d.y-=f.y;this.startX=b.clientX+d.x;this.startY=b.clientY+d.y;this.redraw(b);this.div.style.visibility="visible";this.graph.container.appendChild(this.div);this.active=true;mxEvent.consume(b)}else{this.active=false}};mxRubberband.prototype.mouseMove=function(a){if(this.active){this.redraw(a);mxEvent.consume(a)}};mxRubberband.prototype.mouseUp=function(a){if(this.active){this.reset();var b=new mxRectangle(this.x,this.y,this.width,this.height);if(b.width>this.graph.tolerance||b.height>this.graph.tolerance){this.graph.selectRegion(b,a);mxEvent.consume(a)}}};mxRubberband.prototype.reset=function(a){if(mxClient.FADE_RUBBERBAND){mxUtils.fadeOut(this.div,30,true,10,null,mxClient.FADE_RUBBERBAND)}else{this.div.parentNode.removeChild(this.div)}this.active=false};mxRubberband.prototype.redraw=function(b){var d=mxUtils.getScrollOrigin(this.graph.container);var e=mxUtils.getOffset(this.graph.container);d.x-=e.x;d.y-=e.y;var a=b.clientX+d.x;var f=b.clientY+d.y;this.x=Math.min(this.startX,a);this.y=Math.min(this.startY,f);this.width=Math.max(this.startX,a)-this.x;this.height=Math.max(this.startY,f)-this.y;this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";this.div.style.width=Math.max(1,this.width)+"px";this.div.style.height=Math.max(1,this.height)+"px"};mxRubberband.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;this.graph.removeGraphListener(this);mxUtils.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}this.div=null}};function mxVertexHandler(a){if(a!=null){this.state=a;this.graph=a.view.graph;this.graph.addGraphListener(this);this.init();this.redraw()}}mxVertexHandler.prototype.graph=null;mxVertexHandler.prototype.state=null;mxVertexHandler.prototype.LABEL_INDEX=-1;mxVertexHandler.prototype.singleSizer=false;mxVertexHandler.prototype.init=function(){this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.SELECTION_COLOR);this.selectionBorder.strokewidth=mxConstants.SELECTION_STROKEWIDTH;this.selectionBorder.isDashed=mxConstants.SELECTION_DASHED;this.selectionBorder.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.graph.getView().getOverlayPane());if(this.graph.dialect!=mxConstants.DIALECT_SVG){if(this.graph.isMovable(this.state.cell)){this.selectionBorder.node.style.cursor="move"}mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state.cell,null,true)}else{this.selectionBorder.node.setAttribute("style","pointer-events:none;")}if(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells){this.sizers=new Array();if(this.graph.isSizable(this.state.cell)){var a=0;if(!this.singleSizer){this.sizers.push(this.createSizer("nw-resize",a++));this.sizers.push(this.createSizer("n-resize",a++));this.sizers.push(this.createSizer("ne-resize",a++));this.sizers.push(this.createSizer("w-resize",a++));this.sizers.push(this.createSizer("e-resize",a++));this.sizers.push(this.createSizer("sw-resize",a++));this.sizers.push(this.createSizer("s-resize",a++))}this.sizers.push(this.createSizer("se-resize",a++));var b=this.graph.model.getGeometry(this.state.cell);if(!b.relative&&!this.graph.isSwimlane(this.state.cell)&&this.graph.isLabelMovable(this.state.cell)){this.sizers.push(this.createSizer("default",this.LABEL_INDEX,(this.graph.dialect==mxConstants.DIALECT_SVG)?4:6,mxConstants.LABEL_HANDLE_FILLCOLOR))}}else{if(this.graph.isMovable(this.state.cell)&&!this.graph.isSizable(this.state.cell)&&this.state.width<2&&this.state.height<2){this.sizers.push(this.createSizer("move",null,null,mxConstants.LABEL_HANDLE_FILLCOLOR))}}}};mxVertexHandler.prototype.createSizer=function(h,d,e,b){e=e||((this.graph.dialect==mxConstants.DIALECT_SVG)?5:7);var f=new mxRectangle(0,0,e,e);var g=new mxRectangleShape(f,b||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);if(this.graph.dialect==mxConstants.DIALECT_SVG){g.dialect=mxConstants.DIALECT_PREFERHTML;g.init(this.graph.container)}else{g.dialect=this.graph.dialect;g.init(this.graph.getView().getOverlayPane())}g.node.style.cursor=h;mxEvent.redirectMouseEvents(g.node,this.graph,this.state.cell,d);var a=this;mxEvent.addListener(g.node,"dblclick",function(j){a.graph.dblClick(j,a.state.cell);mxEvent.consume(j)});return g};mxVertexHandler.prototype.moveSizerTo=function(b,a,d){if(b!=null){b.bounds.x=a-b.bounds.width/2;b.bounds.y=d-b.bounds.height/2;b.redraw()}};mxVertexHandler.prototype.mouseDown=function(b,a,d){if(this.graph.isEnabled()&&this.state.cell==a&&d!=null){this.start(b,a,d);mxEvent.consume(b)}};mxVertexHandler.prototype.start=function(b,a,d){this.index=d;this.startX=b.clientX;this.startY=b.clientY};mxVertexHandler.prototype.mouseMove=function(d){if(this.index==this.LABEL_INDEX){var h=mxUtils.getOffset(this.graph.container);var f=mxUtils.getScrollOrigin(this.graph.container);f.x-=h.x;f.y-=h.y;var a=d.clientX+f.x;var j=d.clientY+f.y;if(mxEvent.isGridEnabledEvent(d)){a=this.graph.snap(a);j=this.graph.snap(j)}this.moveSizerTo(this.sizers[8],a,j);mxEvent.consume(d)}else{if(this.index!=null){var g=this.graph.getView().scale;var e=d.clientX-this.startX;var b=d.clientY-this.startY;if(mxEvent.isGridEnabledEvent(d)){e=this.graph.snap(e/g)*g;b=this.graph.snap(b/g)*g}this.bounds=this.union(this.state,e,b,this.index);this.drawPreview();mxEvent.consume(d)}}};mxVertexHandler.prototype.mouseUp=function(b){if(this.index!=null&&this.state!=null){var e=this.graph.getView().scale;var d=(b.clientX-this.startX)/e;var a=(b.clientY-this.startY)/e;if(mxEvent.isGridEnabledEvent(b)){d=this.graph.snap(d);a=this.graph.snap(a)}this.resize(this.state.cell,d,a,this.index);this.reset();mxEvent.consume(b)}};mxVertexHandler.prototype.reset=function(){this.index=null;this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);this.drawPreview()};mxVertexHandler.prototype.resize=function(a,d,b,e){var g=this.graph.model.getGeometry(a);if(e==this.LABEL_INDEX){g=g.clone();if(g.offset==null){g.offset=new mxPoint(d,b)}else{g.offset.x+=d;g.offset.y+=b}this.graph.model.setGeometry(a,g)}else{var f=this.union(g,d,b,e);this.graph.resize(a,f)}};mxVertexHandler.prototype.union=function(a,l,k,f){if(this.singleSizer){return new mxRectangle(a.x,a.y,Math.max(0,a.width+l),Math.max(0,a.height+k))}else{var e=a.x;var h=e+a.width;var g=a.y;var b=g+a.height;if(f>4){b=b+k}else{if(f<3){g=g+k}}if(f==0||f==3||f==5){e+=l}else{if(f==2||f==4||f==7){h+=l}}var d=h-e;var j=b-g;if(d<0){e+=d;d=Math.abs(d)}if(j<0){g+=j;j=Math.abs(j)}return new mxRectangle(e,g,d,j)}};mxVertexHandler.prototype.redraw=function(){this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.sizers!=null){var e=this.state;var f=e.x+e.width;var d=e.y+e.height;if(this.singleSizer){this.moveSizerTo(this.sizers[0],f,d)}else{var a=e.x+e.width/2;var g=e.y+e.height/2;this.moveSizerTo(this.sizers[0],e.x,e.y);if(this.sizers.length>1){this.moveSizerTo(this.sizers[1],a,e.y);this.moveSizerTo(this.sizers[2],f,e.y);this.moveSizerTo(this.sizers[3],e.x,g);this.moveSizerTo(this.sizers[4],f,g);this.moveSizerTo(this.sizers[5],e.x,d);this.moveSizerTo(this.sizers[6],a,d);this.moveSizerTo(this.sizers[7],f,d);this.moveSizerTo(this.sizers[8],a+e.absoluteOffset.x,g+e.absoluteOffset.y)}}}this.drawPreview()};mxVertexHandler.prototype.drawPreview=function(){this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw()};mxVertexHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);this.selectionBorder.destroy();this.selectionBorder=null;if(this.sizers!=null){for(var a=0;a<this.sizers.length;a++){this.sizers[a].destroy();this.sizers[a]=null}}};function mxEdgeHandler(a){if(a!=null){this.state=a;this.graph=this.state.view.graph;this.graph.addGraphListener(this);this.marker=this.createMarker();this.init()}}mxEdgeHandler.prototype.LABEL_INDEX=-1;mxEdgeHandler.prototype.graph=null;mxEdgeHandler.prototype.state=null;mxEdgeHandler.prototype.marker=null;mxEdgeHandler.prototype.error=null;mxEdgeHandler.prototype.shape=null;mxEdgeHandler.prototype.bends=null;mxEdgeHandler.prototype.labelShape=null;mxEdgeHandler.prototype.cloneEnabled=true;mxEdgeHandler.prototype.init=function(){this.points=new Array();this.abspoints=this.state.absolutePoints;this.shape=new mxPolyline(this.abspoints,mxConstants.SELECTION_COLOR);this.shape.strokewidth=mxConstants.SELECTION_STROKEWIDTH;this.shape.isDashed=mxConstants.SELECTION_DASHED;this.shape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.node.style.cursor="pointer";var b=this;mxEvent.addListener(this.shape.node,"dblclick",function(d){b.graph.dblClick(d,b.state.cell);mxEvent.consume(d)});mxEvent.addListener(this.shape.node,"mousedown",function(d){b.graph.dispatchGraphEvent("mousedown",d,b.state.cell)});mxEvent.addListener(this.shape.node,"mousemove",function(e){var d=b.state.cell;if(b.index!=null){var f=mxUtils.convertPoint(b.graph.container,e.clientX,e.clientY);d=b.graph.getCellAt(f.x,f.y);if(b.graph.isSwimlane(d)&&b.graph.hitsSwimlaneContent(d,f.x,f.y)){d=null}}b.graph.dispatchGraphEvent("mousemove",e,d)});mxEvent.addListener(this.shape.node,"mouseup",function(d){b.graph.dispatchGraphEvent("mouseup",d,b.state.cell)});if(this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells||mxGraphHandler.prototype.maxCells<=0){this.bends=this.createBends()}this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape=new mxRectangleShape(new mxRectangle(),mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(this.labelShape);this.labelShape.node.style.cursor="move";var a=this.state.cell;mxEvent.addListener(this.labelShape.node,"dblclick",function(d){b.graph.dblClick(d,a);mxEvent.consume(d)});mxEvent.addListener(this.labelShape.node,"mousedown",function(d){b.graph.dispatchGraphEvent("mousedown",d,a,mxEdgeHandler.prototype.LABEL_INDEX)});this.redraw()};mxEdgeHandler.prototype.createMarker=function(){var a=new mxCellMarker(this.graph);var b=this;a.getCell=function(e,d){var d=mxCellMarker.prototype.getCell.apply(this,arguments);var f=b.graph.getModel();if(d==b.state.cell||(d!=null&&!b.graph.connectableEdges&&f.isEdge(d))){d=null}return d};a.isValidState=function(g){var e=b.graph.getModel();var d=e.getTerminal(b.state.cell,!b.isSource);var f=(b.isSource)?g.cell:d;var h=(b.isSource)?d:g.cell;b.error=b.validateConnection(f,h);return b.error==null};return a};mxEdgeHandler.prototype.validateConnection=function(a,b){return this.graph.getEdgeValidationError(this.state.cell,a,b)};mxEdgeHandler.prototype.createBends=function(){var a=this.state.cell;var f=new Array();for(var e=0;e<this.abspoints.length;e++){if(!this.abspoints[e].isRouted){var g=e==0;var h=e==this.abspoints.length-1;var d=g||h;if(d||this.graph.isBendable(a)){var b=new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(b);b.node.style.cursor="all-scroll";this.installListeners(b.node,f.length);f.push(b);if(!d){this.points.push(new mxPoint(0,0))}}}}return f};mxEdgeHandler.prototype.initBend=function(a){if(this.graph.dialect==mxConstants.DIALECT_SVG){a.dialect=mxConstants.DIALECT_PREFERHTML;a.init(this.graph.container)}else{a.dialect=this.graph.dialect;a.init(this.graph.getView().getOverlayPane())}};mxEdgeHandler.prototype.mouseDown=function(b,a,d){if(d==this.LABEL_INDEX&&!this.graph.isLabelMovable(a)){mxEvent.consume(b)}else{if(this.graph.isEnabled()&&this.state.cell==a&&this.marker!=null&&d!=null){this.start(b,a,d);mxEvent.consume(b)}}};mxEdgeHandler.prototype.start=function(d,a,e){this.isSource=e==0;this.isTarget=e==this.bends.length-1;this.isLabel=e==this.LABEL_INDEX;this.startX=d.clientX;this.startY=d.clientY;if(this.isSource||this.isTarget){var f=this.graph.model.getTerminal(a,this.isSource);if(f==null||this.graph.isDisconnectable(a,f,this.isSource)){var g=this.abspoints[0];var b=this.abspoints[this.abspoints.length-1];this.abspoints=new Array();this.abspoints.push(g);this.abspoints.push(b);this.index=e}}else{this.index=e}};mxEdgeHandler.prototype.mouseMove=function(n,o){if(this.index!=null&&this.marker!=null){var k=this.graph.getView();var l=mxUtils.convertPoint(this.graph.container,n.clientX,n.clientY);var d=k.scale;if(mxEvent.isGridEnabledEvent(n)){l.x=this.graph.snap(l.x/d)*d;l.y=this.graph.snap(l.y/d)*d}if(this.isLabel){this.label.x=l.x;this.label.y=l.y}else{var h=this.state.clone();var j=this.graph.getCellGeometry(this.state.cell);var m=j.points;var a=null;var g=null;if(this.isSource||this.isTarget){this.marker.process(n,o);var b=this.marker.getValidState();g=this.graph.getView().getVisibleTerminal(this.state.cell,!this.isSource);if(b!=null){a=b.cell}else{h.setAbsoluteTerminalPoint(l,this.isSource);if(this.marker.getMarkedState()==null){this.error=(this.graph.allowDanglingEdges)?null:""}}if(!this.isSource){var f=a;a=g;g=f}}else{this.convertPoint(l);if(m==null){m=[l]}else{m[this.index-1]=l}this.points=m;this.active=true;a=h.view.getVisibleTerminal(this.state.cell,true);g=h.view.getVisibleTerminal(this.state.cell,false)}h.view.updatePoints(h,m,a,g);h.view.updateTerminalPoints(h,a,g);var e=(this.error==null)?this.marker.validColor:this.marker.invalidColor;this.setPreviewColor(e);this.abspoints=h.absolutePoints}this.drawPreview();mxEvent.consume(n)}};mxEdgeHandler.prototype.mouseUp=function(a){if(this.index!=null&&this.marker!=null){var b=this.state.cell;if(a.clientX!=this.startX||a.clientY!=this.startY){if(this.error!=null){if(this.error.length>0){this.graph.validationAlert(this.error)}}else{if(this.isLabel){this.moveLabel(this.state,this.label.x,this.label.y)}else{if(this.isSource||this.isTarget){if(this.marker.hasValidState()){var b=this.connect(b,this.marker.getValidState().cell,this.isSource,mxEvent.isCloneEvent(a)&&this.cloneEnabled&&this.graph.isCloneable())}else{if(this.graph.allowDanglingEdges){var e=this.graph.getPointForEvent(a);var d=this.graph.getView().getState(this.graph.getModel().getParent(b));if(d!=null){e.x-=d.origin.x;e.y-=d.origin.y}this.changeTerminalPoint(b,e,this.isSource)}}}else{if(this.active){this.changePoints(b,this.points)}else{this.graph.getView().invalidate(this.state.cell);this.graph.getView().revalidate(this.state.cell)}}}}this.abspoints=this.state.absolutePoints}if(this.marker!=null){this.reset();if(b!=this.state.cell){this.graph.setSelectionCell(b)}}mxEvent.consume(a)}};mxEdgeHandler.prototype.reset=function(){this.error=null;this.index=null;this.label=null;this.active=false;this.isLabel=false;this.isSource=false;this.isTarget=false;this.marker.reset();this.setPreviewColor(mxConstants.SELECTION_COLOR);this.redraw()};mxEdgeHandler.prototype.setPreviewColor=function(a){if(this.shape!=null&&this.shape.node!=null){if(this.shape.dialect==mxConstants.DIALECT_SVG){this.shape.innerNode.setAttribute("stroke",a)}else{this.shape.node.setAttribute("strokecolor",a)}}};mxEdgeHandler.prototype.convertPoint=function(a){var b=this.graph.getView().scale;a.x=this.graph.snap(a.x)/b-this.graph.getView().translate.x;a.y=this.graph.snap(a.y)/b-this.graph.getView().translate.y;return a};mxEdgeHandler.prototype.moveLabel=function(b,a,h){var d=this.graph.getModel();var g=d.getGeometry(b.cell);if(g!=null){g=g.clone();var e=this.graph.getView().getRelativePoint(b,a,h);g.x=e.x;g.y=e.y;var f=this.graph.getView().scale;g.offset=new mxPoint(0,0);var e=this.graph.view.getPoint(b,g);g.offset=new mxPoint((a-e.x)/f,(h-e.y)/f);d.setGeometry(b.cell,g)}};mxEdgeHandler.prototype.connect=function(a,g,l,j){var f=this.graph.getModel();var o=f.getParent(a);f.beginUpdate();try{if(j){var n=a.clone();f.add(o,n,f.getChildCount(o));var k=f.getTerminal(a,!l);f.setTerminal(n,k,!l);a=n}if(g==null){var b=this.graph.getView().scale;var m=this.graph.getView().translate;var e=this.graph.getView().getState(o);var q=(e!=null)?e.origin.x:0;var p=(e!=null)?e.origin.y:0;var h=this.abspoints[(l)?0:this.abspoints.length-1];var d=f.getGeometry(a).clone();d.setTerminalPoint(new mxPoint((h.x-q)/b-m.x,(h.y-p)/b-m.y),l);f.setGeometry(a,d);f.setTerminal(a,null,l)}else{this.graph.connect(a,g,l)}}finally{f.endUpdate()}return a};mxEdgeHandler.prototype.changeTerminalPoint=function(e,a,d){var b=this.graph.getModel();var f=b.getGeometry(e);if(f!=null){b.beginUpdate();try{f=f.clone();f.setTerminalPoint(a,d);b.setGeometry(e,f);b.setTerminal(e,null,d)}finally{b.endUpdate()}}};mxEdgeHandler.prototype.changePoints=function(d,b){var a=this.graph.getModel();var e=a.getGeometry(d);if(e!=null){e=e.clone();e.points=b;a.setGeometry(d,e)}};mxEdgeHandler.prototype.redraw=function(){this.abspoints=this.state.absolutePoints;var q=this.state.cell;if(this.bends!=null&&this.bends.length>0){var l=this.graph.getModel();var u=(this.graph.dialect==mxConstants.DIALECT_SVG)?3:4;var f=this.abspoints.length-1;var t=this.abspoints[0];var e=this.abspoints[0].x;var p=this.abspoints[0].y;this.bends[0].bounds=new mxRectangle(e-u,p-u,2*u,2*u);var m=l.getTerminal(q,true);var h=m!=null;var r=!h||this.graph.isDisconnectable(q,m,true);var g=(r)?((h)?mxConstants.CONNECT_HANDLE_FILLCOLOR:mxConstants.HANDLE_FILLCOLOR):mxConstants.LOCKED_HANDLE_FILLCOLOR;this.bends[0].fill=g;this.bends[0].reconfigure();this.bends[0].redraw();var o=this.abspoints[f];var k=this.abspoints[f].x;var d=this.abspoints[f].y;var b=this.bends.length-1;this.bends[b].bounds=new mxRectangle(k-u,d-u,2*u,2*u);m=l.getTerminal(q,false);h=m!=null;r=!h||this.graph.isDisconnectable(q,m,false);g=(r)?((h)?mxConstants.CONNECT_HANDLE_FILLCOLOR:mxConstants.HANDLE_FILLCOLOR):mxConstants.LOCKED_HANDLE_FILLCOLOR;this.bends[b].fill=g;this.bends[b].reconfigure();this.bends[b].redraw();this.redrawInnerBends(t,o)}var u=(this.graph.dialect==mxConstants.DIALECT_SVG)?2:3;this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);var a=new mxRectangle(this.label.x-u,this.label.y-u,2*u,2*u);this.labelShape.bounds=a;this.labelShape.redraw();var j=this.graph.getLabel(q);if(j!=null&&j.length>0&&this.graph.isLabelMovable(q)){this.labelShape.node.style.visibility="visible"}else{this.labelShape.node.style.visibility="hidden"}this.drawPreview()};mxEdgeHandler.prototype.redrawInnerBends=function(k,b){var e=4;var f=this.graph.getModel().getGeometry(this.state.cell);var h=f.points;if(h!=null){for(var d=1;d<this.bends.length-1;d++){if(this.abspoints[d]!=null){var a=this.abspoints[d].x;var j=this.abspoints[d].y;this.bends[d].bounds=new mxRectangle(a-e,j-e,2*e,2*e);this.bends[d].redraw();this.points[d-1]=h[d-1]}else{if(this.bends[d]!=null){this.bends[d].destroy();this.bends[d]=null}}}}};mxEdgeHandler.prototype.drawPreview=function(){if(this.isLabel){var a=(this.graph.dialect==mxConstants.DIALECT_SVG)?2:3;var b=new mxRectangle(this.label.x-a,this.label.y-a,2*a,2*a);this.labelShape.bounds=b;this.labelShape.redraw()}else{this.shape.points=this.abspoints;this.shape.redraw()}};mxEdgeHandler.prototype.installListeners=function(d,b){var a=this;mxEvent.addListener(d,"mousedown",function(e){a.graph.dispatchGraphEvent("mousedown",e,a.state.cell,b)});mxEvent.addListener(d,"mouseup",function(e){a.graph.dispatchGraphEvent("mouseup",e,a.state.cell,b)})};mxEdgeHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);this.marker.destroy();this.marker=null;this.shape.destroy();this.shape=null;this.labelShape.destroy();this.labelShape=null;if(this.bends!=null){for(var a=0;a<this.bends.length;a++){if(this.bends[a]!=null){this.bends[a].destroy();this.bends[a]=null}}}};function mxElbowEdgeHandler(a){if(a!=null){this.state=a;this.graph=this.state.view.graph;this.graph.addGraphListener(this);this.marker=this.createMarker();this.init()}}mxElbowEdgeHandler.prototype=new mxEdgeHandler();mxElbowEdgeHandler.prototype.constructor=mxElbowEdgeHandler;mxElbowEdgeHandler.prototype.doubleClickOrientationResource=(mxClient.language!="none")?"doubleClickOrientation":"";mxElbowEdgeHandler.prototype.createBends=function(){var b=new Array();var a=new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(a);a.node.style.cursor="all-scroll";this.installListeners(a.node,b.length);b.push(a);b.push(this.createVirtualBend());this.points.push(new mxPoint(0,0));a=new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(a);a.node.style.cursor="all-scroll";this.installListeners(a.node,b.length);b.push(a);return b};mxElbowEdgeHandler.prototype.createVirtualBend=function(){var d=new mxRectangleShape(new mxRectangle(0,0,1,1),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(d);var b=this.getCursorForBend();d.node.style.cursor=b;if(this.graph.isBendable(this.state.cell)){this.installListeners(d.node,1)}else{d.node.style.visibility="hidden"}var a=this;mxEvent.addListener(d.node,"dblclick",function(e){a.graph.flip(a.state.cell,e);mxEvent.consume(e)});mxEvent.addListener(d.node,"mousemove",function(e){a.graph.dispatchGraphEvent("mousemove",e,a.state.cell,mxResources.get(a.doubleClickOrientationResource)||a.doubleClickOrientationResource)});return d};mxElbowEdgeHandler.prototype.getCursorForBend=function(){return(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL))?"row-resize":"col-resize"};mxElbowEdgeHandler.prototype.convertPoint=function(a){var b=this.graph.view.scale;a.x=this.graph.snap(a.x)/b-this.graph.getView().translate.x-this.state.origin.x;a.y=this.graph.snap(a.y)/b-this.graph.getView().translate.y-this.state.origin.y};mxElbowEdgeHandler.prototype.redrawInnerBends=function(h,a){var b=(this.graph.dialect==mxConstants.DIALECT_SVG)?3:4;var d=this.graph.getModel().getGeometry(this.state.cell);var f=d.points;var e=(f!=null)?f[0]:null;if(e==null){e=new mxPoint(h.x+(a.x-h.x)/2,h.y+(a.y-h.y)/2)}else{e=new mxPoint(this.graph.getView().scale*(e.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(e.y+this.graph.getView().translate.y+this.state.origin.y))}this.bends[1].bounds=new mxRectangle(e.x-b,e.y-b,2*b,2*b);this.bends[1].reconfigure();this.bends[1].redraw()};function mxKeyHandler(b,d){if(b!=null){this.graph=b;this.target=d||document.documentElement;this.normalKeys=new Array();this.controlKeys=new Array();var a=this;mxEvent.addListener(this.target,"keydown",function(e){a.keyDown(e)});if(mxClient.IS_IE){mxEvent.addListener(window,"unload",function(){a.destroy()})}}}mxKeyHandler.prototype.graph=null;mxKeyHandler.prototype.target=null;mxKeyHandler.prototype.normalKeys=null;mxKeyHandler.prototype.controlKeys=null;mxKeyHandler.prototype.enabled=true;mxKeyHandler.prototype.isEnabled=function(){return this.enabled};mxKeyHandler.prototype.setEnabled=function(a){this.enabled=a};mxKeyHandler.prototype.bindKey=function(b,a){this.normalKeys[b]=a};mxKeyHandler.prototype.bindControlKey=function(b,a){this.controlKeys[b]=a};mxKeyHandler.prototype.getFunction=function(a){if(a!=null){return(a.ctrlKey)?this.controlKeys[a.keyCode]:this.normalKeys[a.keyCode]}return null};mxKeyHandler.prototype.isGraphEvent=function(a){var d=mxEvent.getSource(a);if((d==this.target||d.parentNode==this.target)||(this.graph.editor!=null&&d==this.graph.editor.textarea)){return true}var b=d;while(b!=null){if(b==this.graph.container){return true}b=b.parentNode}return false};mxKeyHandler.prototype.keyDown=function(a){if(this.graph.isEnabled()&&this.isGraphEvent(a)&&this.isEnabled()){if(this.graph.isEditing()&&((a.keyCode==13&&!a.ctrlKey&&!a.shiftKey)||(a.keyCode==113))){this.enter(a)}else{if(a.keyCode==27){this.escape(a)}else{if(!this.graph.isEditing()){var b=this.getFunction(a);if(b!=null){b(a);mxEvent.consume(a)}}}}}};mxKeyHandler.prototype.enter=function(a){this.graph.editor.stopEditing(false)};mxKeyHandler.prototype.escape=function(a){this.graph.escape(a)};mxKeyHandler.prototype.destroy=function(){this.target=null};function mxTooltipHandler(b,a){if(b!=null){this.graph=b;this.delay=a||500;if(document.body!=null){this.graph.addGraphListener(this)}}}mxTooltipHandler.prototype.zIndex=10005;mxTooltipHandler.prototype.graph=null;mxTooltipHandler.prototype.delay=null;mxTooltipHandler.prototype.hideOnHover=false;mxTooltipHandler.prototype.enabled=true;mxTooltipHandler.prototype.init=function(){if(document.body!=null){this.div=document.createElement("div");this.div.className="mxTooltip";this.div.style.position="absolute";this.div.style.visibility="hidden";this.div.style.zIndex=this.zIndex;if(!mxClient.IS_IE&&mxClient.TOOLTIP_SHADOWS){this.shadow=document.createElement("div");this.shadow.style.position="absolute";this.shadow.style.visibility="hidden";this.shadow.style.background=mxConstants.SVG_SHADOWCOLOR;this.shadow.style.zIndex=this.zIndex;mxUtils.setOpacity(this.shadow,70);document.body.appendChild(this.shadow)}else{if(mxClient.IS_IE&&!mxClient.TOOLTIP_SHADOWS){this.div.style.filter=""}}document.body.appendChild(this.div);var a=this;mxEvent.addListener(this.div,"mousedown",function(b){a.hide()})}};mxTooltipHandler.prototype.isEnabled=function(){return this.enabled};mxTooltipHandler.prototype.setEnabled=function(a){this.enabled=a};mxTooltipHandler.prototype.mouseDown=function(b,a,d){this.reset(b,a,d,false);this.hide()};mxTooltipHandler.prototype.mouseMove=function(b,a,d){if(b.clientX!=this.lastX||b.clientY!=this.lastY){this.reset(b,a,d,true);if(this.hideOnHover||a!=this.cell||d!=this.index){this.hide()}}this.lastX=b.clientX;this.lastY=b.clientY};mxTooltipHandler.prototype.mouseUp=function(b,a,d){this.reset(b,a,d,true);this.hide()};mxTooltipHandler.prototype.reset=function(d,b,g,f){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}if(f&&this.isEnabled()&&b!=null&&this.div.style.visibility=="hidden"){var a=d.clientX;var h=d.clientY;var e=this;this.thread=window.setTimeout(function(){if(!e.graph.isEditing()&&!e.graph.panningHandler.isMenuShowing()){var j=e.graph.getTooltip(b,g);e.show(j,a,h);e.cell=b;e.index=g}},this.delay)}};mxTooltipHandler.prototype.hide=function(){if(this.shadow!=null){this.shadow.style.visibility="hidden"}if(this.div!=null){this.div.style.visibility="hidden"}};mxTooltipHandler.prototype.show=function(d,a,e){if(d!=null&&d.length>0){var b=mxUtils.getScrollOrigin();this.div.style.left=(a+b.x)+"px";this.div.style.top=(e+mxConstants.TOOLTIP_VERTICAL_OFFSET+b.y)+"px";if(!mxUtils.isNode(d)){this.div.innerHTML=d.replace(/\n/g,"<br>")}else{this.div.innerHTML="";this.div.appendChild(d)}this.div.style.visibility="";mxUtils.fit(this.div);if(this.shadow!=null){this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.visibility=""}}};mxTooltipHandler.prototype.destroy=function(){this.graph.removeGraphListener(this);mxUtils.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}this.div=null;if(this.shadow!=null){mxUtils.release(this.shadow);if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow)}this.shadow=null}};function mxHighlight(e,d,a){mxCellMarker.call(this,e,d);this.graph.addGraphListener(this);if(a!=null){this.getCell=a}if(mxClient.IS_IE){var b=this;mxEvent.addListener(window,"unload",function(){b.destroy()})}}mxHighlight.prototype=new mxCellMarker();mxHighlight.prototype.constructor=mxHighlight;mxHighlight.prototype.mouseDown=function(b,a){};mxHighlight.prototype.mouseMove=function(b,a){if(this.isEnabled()){this.process(b,a)}};mxHighlight.prototype.mouseUp=function(b,a){this.reset()};mxHighlight.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;this.graph.removeGraphListener(this);mxCellMarker.prototype.destroy.apply(this)}};function mxDefaultKeyHandler(b){if(b!=null){this.editor=b;this.handler=new mxKeyHandler(b.graph);var a=this.handler.escape;this.handler.escape=function(d){a.apply(this,arguments);b.hideProperties();b.dispatchEvent("escape",b,d)}}}mxDefaultKeyHandler.prototype.editor=null;mxDefaultKeyHandler.prototype.handler=null;mxDefaultKeyHandler.prototype.bindAction=function(b,d,f){var a=this;var e=function(){a.editor.execute(d)};if(f){this.handler.bindControlKey(b,e)}else{this.handler.bindKey(b,e)}};mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy();this.handler=null};function mxDefaultPopupMenu(a){this.config=a}mxDefaultPopupMenu.prototype.config=null;mxDefaultPopupMenu.prototype.createMenu=function(d,g,a,b){if(this.config!=null){var f=this.createConditions(d,a,b);var e=this.config.firstChild;this.addItems(d,g,a,b,f,e,null)}};mxDefaultPopupMenu.prototype.addItems=function(editor,menu,cell,evt,conditions,item,parent){var addSeparator=false;while(item!=null){if(item.nodeName=="add"){var condition=item.getAttribute("if");if(condition==null||conditions[condition]){var as=item.getAttribute("as");as=mxResources.get(as)||as;var funct=mxUtils.eval(mxUtils.getTextContent(item));var action=item.getAttribute("action");var icon=item.getAttribute("icon");if(addSeparator){menu.addSeparator(parent);addSeparator=false}var row=this.addAction(menu,editor,as,icon,funct,action,cell,parent);this.addItems(editor,menu,cell,evt,conditions,item.firstChild,row)}}else{if(item.nodeName=="separator"){addSeparator=true}}item=item.nextSibling}};mxDefaultPopupMenu.prototype.addAction=function(b,f,e,h,a,d,k,j){var g=function(){if(typeof(a)=="function"){a.call(f,f,k)}if(d!=null){f.execute(d,k)}};return b.addItem(e,h,g,j)};mxDefaultPopupMenu.prototype.createConditions=function(editor,cell,evt){var model=editor.graph.getModel();var childCount=model.getChildCount(cell);var conditions=new Array();conditions.nocell=cell==null;conditions.ncells=editor.graph.getSelectionCount()>1;conditions.notRoot=model.getRoot()!=model.getParent(editor.graph.getDefaultParent());conditions.cell=cell!=null;var isCell=cell!=null&&editor.graph.getSelectionCount()==1;conditions.nonEmpty=isCell&&childCount>0;conditions.expandable=isCell&&editor.graph.isExpandable(cell);conditions.collapsable=isCell&&editor.graph.isCollapsable(cell);conditions.validRoot=isCell&&editor.graph.isValidRoot(cell);conditions.emptyValidRoot=conditions.validRoot&&childCount==0;conditions.swimlane=isCell&&editor.graph.isSwimlane(cell);var condNodes=this.config.getElementsByTagName("condition");for(var i=0;i<condNodes.length;i++){var funct=mxUtils.eval(mxUtils.getTextContent(condNodes[i]));var name=condNodes[i].getAttribute("name");if(name!=null&&typeof(funct)=="function"){conditions[name]=funct(editor,cell,evt)}}return conditions};function mxDefaultToolbar(a,b){this.editor=b;if(a!=null&&b!=null){this.init(a)}}mxDefaultToolbar.prototype.editor=null;mxDefaultToolbar.prototype.toolbar=null;mxDefaultToolbar.prototype.resetHandler=null;mxDefaultToolbar.prototype.spacing=4;mxDefaultToolbar.prototype.connectOnDrop=false;mxDefaultToolbar.prototype.init=function(a){if(a!=null){this.toolbar=new mxToolbar(a);var b=this;this.toolbar.addListener("select",function(e,d){if(d!=null){b.editor.insertFunction=function(){d.apply(b,arguments);b.toolbar.resetMode()}}else{b.editor.insertFunction=null}});this.resetHandler=function(){if(b.toolbar!=null){b.toolbar.resetMode(true)}};this.editor.graph.addListener("dblclick",this.resetHandler);this.editor.addListener("escape",this.resetHandler)}};mxDefaultToolbar.prototype.addItem=function(f,b,e,d){var a=this;var g=function(){a.editor.execute(e)};this.toolbar.addItem(f,b,g,d)};mxDefaultToolbar.prototype.addSeparator=function(a){a=a||mxClient.imageBasePath+"separator.gif";this.toolbar.addSeparator(a)};mxDefaultToolbar.prototype.addCombo=function(){return this.toolbar.addCombo()};mxDefaultToolbar.prototype.addActionCombo=function(a){return this.toolbar.addActionCombo(a)};mxDefaultToolbar.prototype.addActionOption=function(d,e,b){var a=this;var f=function(){a.editor.execute(b)};this.addOption(d,e,f)};mxDefaultToolbar.prototype.addOption=function(b,d,a){return this.toolbar.addOption(b,d,a)};mxDefaultToolbar.prototype.addMode=function(g,d,f,e,a){var b=this;var h=function(){b.editor.setMode(f);if(a!=null){a(b.editor)}};this.toolbar.addSwitchMode(g,d,h,e)};mxDefaultToolbar.prototype.addPrototype=function(h,g,k,b,j){var d=null;if(k==null){d=this.toolbar.addMode(h,g,null,b)}else{var e=function(){if(typeof(k)=="function"){return k()}else{return k.clone()}};var l=this;var f=function(n,m){if(typeof(j)=="function"){j(l.editor,e(),n,m)}else{l.drop(e(),n,m)}l.toolbar.resetMode();mxEvent.consume(n)};d=this.toolbar.addMode(h,g,f,b);var a=function(o,n,m){f(n,m)};this.installDropHandler(d,a)}return d};mxDefaultToolbar.prototype.drop=function(e,a,f){var d=this.editor.graph;var b=d.getModel();if(f==null||b.isEdge(f)||!this.connectOnDrop||!b.isConnectable(f)){while(f!=null&&!d.isValidDropTarget(f)){f=b.getParent(f)}this.insert(e,a,f)}else{this.connect(e,a,f)}};mxDefaultToolbar.prototype.insert=function(e,a,b){var d=this.editor.graph;var f=mxUtils.convertPoint(d.container,a.clientX,a.clientY);return this.editor.addVertex(b,e,f.x,f.y)};mxDefaultToolbar.prototype.connect=function(h,n,a){var o=this.editor.graph;var f=o.getModel();if(a!=null&&f.isConnectable(h)&&o.isEdgeValid(null,a,h)){var b=null;f.beginUpdate();try{var e=f.getGeometry(a);var j=f.getGeometry(h).clone();j.x=e.x+(e.width-j.width)/2;j.y=e.y+(e.height-j.height)/2;var d=this.spacing*o.gridSize;var k=f.getDirectedEdgeCount(a,true)*20;if(this.editor.horizontalFlow){j.x+=(j.width+e.width)/2+d+k}else{j.y+=(j.height+e.height)/2+d+k}h.setGeometry(j);var m=f.getParent(a);o.addCell(h,m);o.keepInside([h]);b=this.editor.createEdge(a,h);if(f.getGeometry(b)==null){var l=new mxGeometry();l.relative=true;f.setGeometry(b,l)}o.addEdge(b,m,a,h)}finally{f.endUpdate()}o.setSelectionCells([h,b]);o.scrollCellToVisible(h)}};mxDefaultToolbar.prototype.installDropHandler=function(e,d){var f=document.createElement("img");f.setAttribute("src",e.getAttribute("src"));var b=this;var a=function(g){f.style.width=(2*e.offsetWidth)+"px";f.style.height=(2*e.offsetHeight)+"px";mxUtils.makeDraggable(e,b.editor.graph,d,f);mxEvent.removeListener(f,"load",a)};if(mxClient.IS_IE){a()}else{mxEvent.addListener(f,"load",a)}};mxDefaultToolbar.prototype.destroy=function(){if(this.resetHandler!=null){this.editor.graph.removeListener("dblclick",this.resetHandler);this.editor.removeListener("escape",this.resetHandler);this.resetHandler=null}if(this.toolbar!=null){this.toolbar.destroy();this.toolbar=null}};function mxEditor(d){this.actions=new Array();this.addActions();if(document.body!=null){this.cycleAttributeValues=new Array();this.popupHandler=new mxDefaultPopupMenu();this.undoManager=new mxUndoManager();this.graph=this.createGraph();this.toolbar=this.createToolbar();this.keyHandler=new mxDefaultKeyHandler(this);this.configure(d);this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName;if(!mxClient.IS_LOCAL&&this.urlInit!=null){this.createSession()}if(this.onInit!=null){var e=document.cookie;var a=e.indexOf("mxgraph=seen")<0;if(a){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2199 02:47:11 UTC; path=/"}this.onInit(a)}if(mxClient.IS_IE){var b=this;mxEvent.addListener(window,"unload",function(){b.destroy()})}}}mxResources.add(mxClient.basePath+"js/resources/editor");mxEditor.prototype=new mxEventSource();mxEditor.prototype.constructor=mxEditor;mxEditor.prototype.askZoomResource=(mxClient.language!="none")?"askZoom":"";mxEditor.prototype.lastSavedResource=(mxClient.language!="none")?"lastSaved":"";mxEditor.prototype.currentFileResource=(mxClient.language!="none")?"currentFile":"";mxEditor.prototype.propertiesResource=(mxClient.language!="none")?"properties":"";mxEditor.prototype.tasksResource=(mxClient.language!="none")?"tasks":"";mxEditor.prototype.helpResource=(mxClient.language!="none")?"help":"";mxEditor.prototype.outlineResource=(mxClient.language!="none")?"outline":"";mxEditor.prototype.outline=null;mxEditor.prototype.graph=null;mxEditor.prototype.graphRenderHint=null;mxEditor.prototype.toolbar=null;mxEditor.prototype.status=null;mxEditor.prototype.popupHandler=null;mxEditor.prototype.undoManager=null;mxEditor.prototype.keyHandler=null;mxEditor.prototype.actions=null;mxEditor.prototype.dblClickAction="edit";mxEditor.prototype.swimlaneRequired=false;mxEditor.prototype.disableContextMenu=true;mxEditor.prototype.extendParentOnAddVertex=true;mxEditor.prototype.insertFunction=null;mxEditor.prototype.forcedInserting=false;mxEditor.prototype.templates=null;mxEditor.prototype.defaultEdge=null;mxEditor.prototype.defaultEdgeStyle=null;mxEditor.prototype.defaultGroup=null;mxEditor.prototype.groupBorderSize=null;mxEditor.prototype.filename=null;mxEditor.prototype.linefeed="&#xa;";mxEditor.prototype.postParameterName="xml";mxEditor.prototype.escapePostData=false;mxEditor.prototype.urlPost=null;mxEditor.prototype.urlImage=null;mxEditor.prototype.urlInit=null;mxEditor.prototype.urlNotify=null;mxEditor.prototype.urlPoll=null;mxEditor.prototype.horizontalFlow=false;mxEditor.prototype.layoutDiagram=false;mxEditor.prototype.swimlaneSpacing=0;mxEditor.prototype.maintainSwimlanes=false;mxEditor.prototype.layoutSwimlanes=false;mxEditor.prototype.cycleAttributeValues=null;mxEditor.prototype.cycleAttributeIndex=0;mxEditor.prototype.cycleAttributeName="fillColor";mxEditor.prototype.helpWindowImage=null;mxEditor.prototype.urlHelp=null;mxEditor.prototype.tasksWindowImage=null;mxEditor.prototype.tasksTop=20;mxEditor.prototype.helpWidth=300;mxEditor.prototype.helpHeight=260;mxEditor.prototype.propertiesWidth=240;mxEditor.prototype.propertiesHeight=null;mxEditor.prototype.movePropertiesDialog=false;mxEditor.prototype.autoSaving=false;mxEditor.prototype.validating=false;mxEditor.prototype.modified=false;mxEditor.prototype.autoSaveDelay=10;mxEditor.prototype.autoSaveThrottle=2;mxEditor.prototype.autoSaveThreshold=5;mxEditor.prototype.ignoredChanges=0;mxEditor.prototype.lastSnapshot=0;mxEditor.prototype.addActions=function(){this.addAction("save",function(a){a.save()});this.addAction("print",function(a){mxUtils.print(a.graph)});this.addAction("preview",function(a){mxUtils.show(a.graph)});this.addAction("exportImage",function(e){if(mxClient.IS_LOCAL){e.execute("preview")}else{var d=e.getUrlImage();if(d!=null){var a=new mxCodec();var f=a.encode(e.graph.getView());var b=mxUtils.getXml(f,"\n");mxUtils.submit(d,e.postParameterName+"="+b)}else{mxUtils.alert(mxResources.get("notAvailable"))}}});this.addAction("refresh",function(a){a.graph.refresh()});this.addAction("cut",function(a){mxClipboard.cut(a.graph)});this.addAction("copy",function(a){mxClipboard.copy(a.graph)});this.addAction("paste",function(a){mxClipboard.paste(a.graph)});this.addAction("delete",function(a){if(a.graph.isEnabled()){a.graph.remove()}});this.addAction("group",function(a){if(a.graph.isEnabled()){a.group()}});this.addAction("ungroup",function(a){if(a.graph.isEnabled()){a.graph.ungroup()}});this.addAction("removeFromParent",function(a){if(a.graph.isEnabled()){a.graph.removeFromParent()}});this.addAction("undo",function(a){if(a.graph.isEnabled()){a.undo()}});this.addAction("redo",function(a){if(a.graph.isEnabled()){a.redo()}});this.addAction("zoomIn",function(a){a.graph.zoomIn()});this.addAction("zoomOut",function(a){a.graph.zoomOut()});this.addAction("actualSize",function(a){a.graph.zoomActual()});this.addAction("fit",function(a){a.graph.fit()});this.addAction("showProperties",function(b,a){b.showProperties(a)});this.addAction("selectAll",function(a){if(a.graph.isEnabled()){a.graph.selectAll()}});this.addAction("selectNone",function(a){if(a.graph.isEnabled()){a.graph.clearSelection()}});this.addAction("selectVertices",function(a){if(a.graph.isEnabled()){a.graph.selectVertices()}});this.addAction("selectEdges",function(a){if(a.graph.isEnabled()){a.graph.selectEdges()}});this.addAction("edit",function(b,a){if(b.graph.isEnabled()){b.graph.edit(a)}});this.addAction("toBack",function(b,a){b.graph.toBack()});this.addAction("toFront",function(b,a){b.graph.toFront()});this.addAction("enterGroup",function(b,a){b.graph.enterGroup(a)});this.addAction("exitGroup",function(a){a.graph.exitGroup()});this.addAction("home",function(a){a.graph.home()});this.addAction("selectPrevious",function(a){if(a.graph.isEnabled()){a.graph.selectPrevious()}});this.addAction("selectNext",function(a){if(a.graph.isEnabled()){a.graph.selectNext()}});this.addAction("selectParent",function(a){if(a.graph.isEnabled()){a.graph.selectParent()}});this.addAction("selectChild",function(a){if(a.graph.isEnabled()){a.graph.selectChild()}});this.addAction("collapse",function(a){if(a.graph.isEnabled()){a.graph.collapse()}});this.addAction("collapseAll",function(b){if(b.graph.isEnabled()){var a=b.graph.getChildVertices();b.graph.collapse(a)}});this.addAction("expand",function(a){if(a.graph.isEnabled()){a.graph.expand()}});this.addAction("expandAll",function(b){if(b.graph.isEnabled()){var a=b.graph.getChildVertices();b.graph.expand(a)}});this.addAction("bold",function(a){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)});this.addAction("italic",function(a){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)});this.addAction("underline",function(a){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)});this.addAction("shadow",function(a){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_SHADOW)});this.addAction("alignCellsLeft",function(a){a.graph.alignCells(mxConstants.ALIGN_LEFT)});this.addAction("alignCellsCenter",function(a){a.graph.alignCells(mxConstants.ALIGN_CENTER)});this.addAction("alignCellsRight",function(a){a.graph.alignCells(mxConstants.ALIGN_RIGHT)});this.addAction("alignCellsTop",function(a){a.graph.alignCells(mxConstants.ALIGN_TOP)});this.addAction("alignCellsMiddle",function(a){a.graph.alignCells(mxConstants.ALIGN_MIDDLE)});this.addAction("alignCellsBottom",function(a){a.graph.alignCells(mxConstants.ALIGN_BOTTOM)});this.addAction("alignFontLeft",function(a){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)});this.addAction("alignFontCenter",function(a){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)});this.addAction("alignFontRight",function(a){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)});this.addAction("alignFontTop",function(a){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)});this.addAction("alignFontMiddle",function(a){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)});this.addAction("alignFontBottom",function(a){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM)});this.addAction("zoom",function(a){var b=a.graph.getView().scale*100;var d=parseFloat(mxUtils.prompt(mxResources.get(a.askZoomResource)||a.askZoomResource,b))/100;if(!isNaN(d)){a.graph.getView().setScale(d)}});this.addAction("toggleTasks",function(a){if(a.tasks!=null){a.tasks.setVisible(!a.tasks.isVisible())}else{a.showTasks()}});this.addAction("toggleHelp",function(a){if(a.help!=null){a.help.setVisible(!a.help.isVisible())}else{a.showHelp()}});this.addAction("toggleOutline",function(a){if(a.outline==null){a.showOutline()}else{a.outline.setVisible(!a.outline.isVisible())}});this.addAction("toggleConsole",function(a){mxLog.setVisible(!mxLog.isVisible())})};mxEditor.prototype.createSession=function(){var d=null;var a=this;var b=function(e){a.dispatchEvent("session",a,e)};d=this.connect(this.urlInit,this.urlPoll,this.urlNotify,b);d.addListener("dispatched",function(e,f){if(f.length<10){mxUtils.animateChanges(a.graph,f)}});d.addListener("connect",function(e,f){a.resetHistory()})};mxEditor.prototype.configure=function(a){if(a!=null){var b=new mxCodec(a.ownerDocument);try{this.isConfiguring=true;b.decode(a,this)}finally{this.isConfiguring=null}this.resetHistory()}};mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"};mxEditor.prototype.resetHistory=function(){this.lastSnapshot=new Date().getTime();this.undoManager.reset();this.ignoredChanges=0;this.modified=false};mxEditor.prototype.addAction=function(b,a){this.actions[b]=a};mxEditor.prototype.execute=function(d,a){var f=this.actions[d];if(f!=null){try{var b=arguments;b[0]=this;f.apply(this,b)}catch(e){mxUtils.error("Cannot execute "+d+": "+e.message,280,true);throw e}}else{mxUtils.error("Cannot find action "+d,280,true)}};mxEditor.prototype.createGraph=function(){var b=new mxGraph(null,null,this.graphRenderHint);b.setTooltips(true);b.setPanning(true);this.installDblClickHandler(b);this.installResizeHandler(b);this.installUndoHandler(b);this.installDrillHandler(b);this.installChangeHandler(b);this.installAddHandler(b);this.installLayoutHandler(b);this.installInsertHandler(b);var a=this;b.panningHandler.factoryMethod=function(f,d,e){return a.createPopupMenu(f,d,e)};b.connectionHandler.factoryMethod=function(d,e){return a.createEdge(d,e)};return b};mxEditor.prototype.setGraphContainer=function(a){if(this.graph.container==null){this.graph.init(a);this.rubberband=new mxRubberband(this.graph);if(this.disableContextMenu){mxEvent.disableContextMenu(a)}if(mxClient.IS_IE){new mxDivResizer(a)}}};mxEditor.prototype.installAddHandler=function(d){var a=this;var e=50;var b=function(k,p){for(var l=0;l<p.length;l++){var o=p[l];if(a.maintainSwimlanes&&d.isSwimlane(o)){var m=d.getModel();var j=m.getGeometry(o);var g=(a.horizontalFlow)?j.width:j.height;if(g==null||g==0){g=(a.horizontalFlow)?d.container.offsetWidth-10:d.container.offsetHeight;g-=e}var n=d.getDefaultParent();var h=m.getChildCount(n);for(var l=0;l<h;l++){var f=m.getChildAt(n,l);j=m.getGeometry(f);if(o!=f&&d.isSwimlane(f)){g=(a.horizontalFlow)?j.width:j.height;break}}j=m.getGeometry(o);if(j!=null){if(a.horizontalFlow){j.width=g}else{j.height=g}}}}};d.addListener("add",b)};mxEditor.prototype.installDblClickHandler=function(b){var a=this;b.dblClick=function(e,d){b.dispatchEvent("dblclick",b,e,d);if(d!=null&&b.isEnabled()){a.execute(a.dblClickAction,d)}}};mxEditor.prototype.installUndoHandler=function(d){var a=this;var b=function(e,f){a.undoManager.undoableEditHappened(f)};d.getModel().addListener("undo",b);d.getView().addListener("undo",b);b=function(e,f){d.selectCellsForEdit(f)};this.undoManager.addListener("undo",b);this.undoManager.addListener("redo",b)};mxEditor.prototype.installDrillHandler=function(d){var a=this;var b=function(e){a.dispatchEvent("root",a)};d.getView().addListener("down",b);d.getView().addListener("up",b)};mxEditor.prototype.installResizeHandler=function(d){var a=d.resizeCells;var b=this;d.resizeCells=function(s,q){if(b.maintainSwimlanes){var n=d.getModel();var o=new Array();var p=s.length;for(var l=0;l<p;l++){if(d.isSwimlane(s[l])){var r=n.getParent(s[l]);var m=mxCellPath.create(r);if(r!=null&&o[m]==null){o[m]=r;var k=n.getGeometry(s[l]);var f=(b.horizontalFlow)?q[l].width:q[l].height;var h=n.getChildCount(r);for(var g=0;g<h;g++){var e=n.getChildAt(r,g);if(d.isSwimlane(e)&&e!=s[l]){k=n.getGeometry(e);if(k!=null){k=k.clone();if(b.horizontalFlow){k.width=f}else{k.height=f}s.push(e);q.push(k)}}}}}}}a.apply(this,arguments)}};mxEditor.prototype.installChangeHandler=function(d){var a=this;var b=function(f,g){a.modified=true;if(a.validating==true){d.validate()}if(!this.isConfiguring){if(a.autoSaving){a.autosave(g)}}for(var e=0;e<g.length;e++){var h=g[e];if(h.constructor==mxRootChange||(h.constructor==mxValueChange&&h.cell==a.graph.model.root)||(h.constructor==mxCellAttributeChange&&h.cell==a.graph.model.root)){a.dispatchEvent("root",a);break}}};d.getModel().addListener("change",b)};mxEditor.prototype.installLayoutHandler=function(d){var a=d.getLayout;var b=this;d.getLayout=function(e){var g=a.apply(this,arguments);var f=this.getModel();if(g==null&&f.getParent(e)!=null){if(b.layoutSwimlanes&&d.isSwimlane(e)){if(b.swimlaneLayout==null){b.swimlaneLayout=b.createSwimlaneLayout()}g=b.swimlaneLayout}else{if(b.layoutDiagram&&(d.isValidRoot(e)||f.getParent(f.getParent(e))==null)){if(b.diagramLayout==null){b.diagramLayout=b.createDiagramLayout()}g=b.diagramLayout}}}return g}};mxEditor.prototype.installInsertHandler=function(b){var a=this;var d={mouseDown:function(f,e,g){if(a.insertFunction!=null&&!mxEvent.isPopupTrigger(f)&&(a.forcedInserting||(e==null&&g==null))){a.graph.clearSelection();a.insertFunction(f,e);this.isActive=true;mxEvent.consume(f)}},mouseMove:function(f,e){if(this.isActive){mxEvent.consume(f)}},mouseUp:function(f,e){if(this.isActive){this.isActive=false;mxEvent.consume(f)}}};b.addGraphListener(d)};mxEditor.prototype.createDiagramLayout=function(){var a=this.graph.gridSize;var b=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*a,2*a);b.isVertexIgnored=function(d){return !b.graph.isSwimlane(d)};return b};mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)};mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this)};mxEditor.prototype.setToolbarContainer=function(a){this.toolbar.init(a);if(mxClient.IS_IE){new mxDivResizer(a)}};mxEditor.prototype.setStatusContainer=function(a){if(this.status==null){this.status=a;var b=this;this.addListener("save",function(e){var d=new Date().toLocaleString();b.setStatus((mxResources.get(b.lastSavedResource)||b.lastSavedResource)+": "+d)});this.addListener("open",function(d){b.setStatus((mxResources.get(b.currentFileResource)||b.currentFileResource)+": "+b.filename)});if(mxClient.IS_IE){new mxDivResizer(a)}}};mxEditor.prototype.setStatus=function(a){if(this.status!=null&&a!=null){this.status.innerHTML=a}};mxEditor.prototype.setTitleContainer=function(a){var b=this;this.addListener("root",function(d){a.innerHTML=b.getTitle()});if(mxClient.IS_IE){new mxDivResizer(a)}};mxEditor.prototype.treeLayout=function(a,b){if(a!=null){var d=new mxCompactTreeLayout(this.graph,b);d.execute(a)}};mxEditor.prototype.getTitle=function(){var e="";var d=this.graph;var a=d.getCurrentRoot();while(a!=null&&d.getModel().getParent(d.getModel().getParent(a))!=null){if(d.isValidRoot(a)){e=" > "+d.convertValueToString(a)+e}a=d.getModel().getParent(a)}var b=this.getRootTitle();return b+e};mxEditor.prototype.getRootTitle=function(){var a=this.graph.getModel().getRoot();return this.graph.convertValueToString(a)};mxEditor.prototype.undo=function(){this.undoManager.undo()};mxEditor.prototype.redo=function(){this.undoManager.redo()};mxEditor.prototype.group=function(){var a=(this.groupBorderSize!=null)?this.groupBorderSize:this.graph.gridSize;this.graph.group(this.createGroup(),a)};mxEditor.prototype.createGroup=function(){var a=this.graph.getModel();return a.cloneCell(this.defaultGroup)};mxEditor.prototype.open=function(a){if(a!=null){this.dispatchEvent("beforeOpen",this,a);var f=null;try{var b=mxUtils.load(a).getXml();this.readGraphModel(b.documentElement);this.filename=a;this.dispatchEvent("open",this,a)}catch(d){mxUtils.error("Cannot open "+a+": "+d.message,280,true);f=d}this.dispatchEvent("afterOpen",this,a,f)}};mxEditor.prototype.readGraphModel=function(a){var b=new mxCodec(a.ownerDocument);b.decode(a,this.graph.getModel());this.resetHistory()};mxEditor.prototype.save=function(j,d,a){if(j==null||j==this.autoSaving){this.dispatchEvent("beforeSave",this,j);this.lastSnapshot=new Date().getTime();this.ignoredChanges=0;this.modified=false;var k=null;try{a=a||this.getUrlPost(j);if(a!=null&&a.length>0){var g=this.writeGraphModel();this.postDiagram(a,g)}else{if(!j){var f=new mxCodec();var b=f.encode(this.graph.getModel());var h=mxUtils.getPrettyXml(b);mxUtils.popup(h)}}this.dispatchEvent("save",this,j,a)}catch(l){k=l}this.dispatchEvent("afterSave",this,j,k)}};mxEditor.prototype.postDiagram=function(b,d){if(this.escapePostData){d=encodeURIComponent(d)}var a=this;mxUtils.post(b,this.postParameterName+"="+d,function(e){a.dispatchEvent("post",a,e,b,d)})};mxEditor.prototype.writeGraphModel=function(){var a=new mxCodec();var b=a.encode(this.graph.getModel());return mxUtils.getXml(b,this.linefeed)};mxEditor.prototype.getUrlPost=function(a){var b=this.urlPost;if(b!=null&&b.length>0){if(a){b+="?draft=true"}}return b};mxEditor.prototype.getUrlImage=function(){return this.urlImage};mxEditor.prototype.autosave=function(b){var a=new Date().getTime();var d=(a-this.lastSnapshot)/1000;if(d>this.autoSaveDelay||(this.ignoredChanges>=this.autoSaveThreshold&&d>this.autoSaveThrottle)){this.lastSnapshot=a;this.ignoredChanges=1;this.save(true)}else{this.ignoredChanges++}};mxEditor.prototype.connect=function(e,d,g,b){var f=null;if(!mxClient.IS_LOCAL){var f=new mxSession(this.graph.getModel(),e,d,g);var a=this;f.addListener("receive",function(h,j){if(j.nodeName=="mxGraphModel"){a.readGraphModel(j)}});f.addListener("disconnect",b);f.addListener("connect",b);f.addListener("notify",b);f.addListener("get",b);f.start()}return f};mxEditor.prototype.swapStyles=function(d,a){var b=this.graph.getStylesheet().styles[a];this.graph.getView().getStylesheet().putCellStyle(a,this.graph.getStylesheet().styles[d]);this.graph.getStylesheet().putCellStyle(d,b);this.graph.refresh()};mxEditor.prototype.showProperties=function(b){b=b||this.graph.getSelectionCell();if(b==null){b=this.graph.getCurrentRoot();if(b==null){b=this.graph.getModel().getRoot()}}if(b!=null){this.graph.editor.stopEditing(true);var f=mxUtils.getOffset(this.graph.container);var a=f.x+10;var g=f.y;if(this.properties!=null&&!this.movePropertiesDialog){a=this.properties.getX();g=this.properties.getY()}else{var e=this.graph.getCellBounds(b);if(e!=null){a+=e.x+Math.min(200,e.width);g+=e.y}}this.hideProperties();var d=this.createProperties(b);if(d!=null){this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,d,a,g,this.propertiesWidth,this.propertiesHeight,false);this.properties.setVisible(true)}}};mxEditor.prototype.isPropertiesVisible=function(){return this.properties!=null};mxEditor.prototype.createProperties=function(b){var h=this.graph.getModel();var o=h.getValue(b);if(mxUtils.isNode(o)){var d=new mxForm("properties");var l=d.addText("ID",b.getId());l.setAttribute("readonly","true");var t=null;var j=null;var e=null;var g=null;var f=null;if(h.isVertex(b)){t=h.getGeometry(b);if(t!=null){j=d.addText("top",t.y);e=d.addText("left",t.x);g=d.addText("width",t.width);f=d.addText("height",t.height)}}var r=h.getStyle(b);var q=d.addText("Style",r||"");var n=o.attributes;var a=new Array();for(var p=0;p<n.length;p++){var u=n[p].nodeValue;a[p]=d.addTextarea(n[p].nodeName,u,(n[p].nodeName=="label")?4:2)}var k=this;var m=function(){k.hideProperties();h.beginUpdate();try{if(t!=null){t=t.clone();t.x=parseFloat(e.value);t.y=parseFloat(j.value);t.width=parseFloat(g.value);t.height=parseFloat(f.value);h.setGeometry(b,t)}if(q.value.length>0){h.setStyle(b,q.value)}else{h.setStyle(b,null)}for(var v=0;v<n.length;v++){var w=new mxCellAttributeChange(b,n[v].nodeName,a[v].value);h.execute(w)}if(k.graph.isUpdateSize(b)){k.graph.updateSize(b)}}finally{h.endUpdate()}};var s=function(){k.hideProperties()};d.addButtons(m,s);return d.table}return null};mxEditor.prototype.hideProperties=function(){if(this.properties!=null){this.properties.destroy();this.properties=null}};mxEditor.prototype.showTasks=function(g){if(this.tasks==null){var f=document.createElement("div");f.style.padding="4px";f.style.paddingLeft="20px";var b=document.body.clientWidth;var e=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,f,b-220,this.tasksTop,200);e.setClosable(true);e.destroyOnClose=false;var d=this;var a=function(h){mxUtils.release(f);f.innerHTML="";d.createTasks(f)};this.graph.getModel().addListener("change",a);this.graph.selection.addListener("change",a);this.graph.addListener("root",a);if(this.tasksWindowImage!=null){e.setImage(this.tasksWindowImage)}this.tasks=e;this.createTasks(f)}this.tasks.setVisible(true)};mxEditor.prototype.refreshTasks=function(a){if(this.tasks!=null){var a=this.tasks.content;mxUtils.release(a);a.innerHTML="";this.createTasks(a)}};mxEditor.prototype.createTasks=function(a){};mxEditor.prototype.showHelp=function(g){if(this.help==null){var f=document.createElement("iframe");f.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);f.setAttribute("height","100%");f.setAttribute("width","100%");f.setAttribute("frameborder","0");f.style.backgroundColor="white";var a=document.body.clientWidth;var d=(document.body.clientHeight||document.documentElement.clientHeight);var e=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,f,(a-this.helpWidth)/2,(d-this.helpHeight)/3,this.helpWidth,this.helpHeight);e.setMaximizable(true);e.setClosable(true);e.destroyOnClose=false;e.setSizable(true);if(this.helpWindowImage!=null){e.setImage(this.helpWindowImage)}if(mxClient.IS_NS){var b=function(j){var k=e.div.offsetHeight;f.setAttribute("height",(k-26)+"px")};e.addListener("resize",b);e.addListener("maximize",b);e.addListener("normalize",b);e.addListener("show",b)}this.help=e}this.help.setVisible(true)};mxEditor.prototype.showOutline=function(){var a=this.outline==null;if(a){var e=document.createElement("div");e.style.width="100%";e.style.height="100%";e.style.background="white";var d=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,e,600,480,200,200,false);var b=new mxOutline(this.graph,e);d.setClosable(true);d.setSizable(true);d.destroyOnClose=false;d.addListener("resizeend",function(){b.update()});this.outline=d;this.outline.outline=b}this.outline.setVisible(true);this.outline.outline.refresh()};mxEditor.prototype.setMode=function(a){if(a=="select"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.connectionHandler.setEnabled(false)}else{if(a=="connect"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.connectionHandler.setEnabled(true)}else{if(a=="pan"){this.graph.panningHandler.useLeftButtonForPanning=true;this.graph.connectionHandler.setEnabled(false)}}}};mxEditor.prototype.createPopupMenu=function(d,a,b){this.popupHandler.createMenu(this,d,a,b)};mxEditor.prototype.createEdge=function(d,g){var f=null;if(this.defaultEdge!=null){var a=this.graph.getModel();f=a.cloneCell(this.defaultEdge)}else{f=new mxCell("");f.setEdge(true)}var b=this.getEdgeStyle();if(b!=null){f.setStyle(b)}return f};mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle};mxEditor.prototype.consumeCycleAttribute=function(a){return(this.cycleAttributeValues!=null&&this.cycleAttributeValues.length>0&&this.graph.isSwimlane(a))?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null};mxEditor.prototype.cycleAttribute=function(a){if(this.cycleAttributeName!=null){var b=this.consumeCycleAttribute(a);if(b!=null){a.setStyle(a.getStyle()+";"+this.cycleAttributeName+"="+b)}}};mxEditor.prototype.addVertex=function(m,j,l,k){var h=this.graph.getModel();while(m!=null&&!this.graph.isValidDropTarget(m)){m=h.getParent(m)}m=(m!=null)?m:this.graph.getSwimlaneAt(l,k);var e=this.graph.getView().scale;var g=h.getGeometry(j);var d=h.getGeometry(m);if(this.graph.isSwimlane(j)&&!this.graph.swimlaneNesting){m=null}else{if(m==null&&this.swimlaneRequired){return null}else{if(m!=null&&d!=null){var a=this.graph.getView().getState(m);if(a!=null){l-=a.origin.x*e;k-=a.origin.y*e;if(this.graph.isConstrainedMoving){var b=g.width;var n=g.height;var f=a.x+a.width;if(l+b>f){l-=l+b-f}f=a.y+a.height;if(k+n>f){k-=k+n-f}}}else{if(d!=null){l-=d.x*e;k-=d.y*e}}}}}g=g.clone();g.x=this.graph.snap(l/e-this.graph.getView().translate.x-this.graph.gridSize/2);g.y=this.graph.snap(k/e-this.graph.getView().translate.y-this.graph.gridSize/2);j.setGeometry(g);if(m==null){m=this.graph.getDefaultParent()}this.cycleAttribute(j);this.dispatchEvent("beforeAddVertex",this,j,m);h.beginUpdate();try{j=this.graph.addCell(j,m);if(j!=null){this.graph.keepInside([j]);if(this.extendParentOnAddVertex){this.graph.extendParent(j)}this.dispatchEvent("addVertex",this,j)}}finally{h.endUpdate()}if(j!=null){this.graph.setSelectionCell(j);this.graph.scrollCellToVisible(j);this.dispatchEvent("afterAddVertex",this,j)}return j};mxEditor.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tasks!=null){this.tasks.destroy()}if(this.outline!=null){this.outline.destroy()}if(this.properties!=null){this.properties.destroy()}if(this.keyHandler!=null){this.keyHandler.destroy()}if(this.rubberband!=null){this.rubberband.destroy()}if(this.toolbar!=null){this.toolbar.destroy()}if(this.graph!=null){this.graph.destroy()}this.status=null;this.templates=null}};var mxCodecRegistry={codecs:new Array(),register:function(b){var a=mxUtils.getFunctionName(b.template.constructor);mxCodecRegistry.codecs[a]=b},getCodec:function(b){var d=null;if(b!=null){var a=mxUtils.getFunctionName(b);d=mxCodecRegistry.codecs[a];if(d==null){try{d=new mxObjectCodec(new b());mxCodecRegistry.register(d)}catch(f){}}}return d}};function mxCodec(a){this.document=a||mxUtils.createXmlDocument();this.objects=new Array()}mxCodec.prototype.document=null;mxCodec.prototype.objects=null;mxCodec.prototype.encodeDefaults=false;mxCodec.prototype.putObject=function(b,a){this.objects[b]=a;return a};mxCodec.prototype.getObject=function(d){var b=null;if(d!=null){b=this.objects[d];if(b==null){b=this.lookup(d);if(b==null){var a=this.getElementById(d);if(a!=null){b=this.decode(a)}}}}return b};mxCodec.prototype.lookup=function(a){return null};mxCodec.prototype.getElementById=function(d,a){a=a||"id";var b="//*[@"+a+"='"+d+"']";return mxUtils.selectSingleNode(this.document,b)};mxCodec.prototype.getId=function(a){var b=null;if(a!=null){b=this.reference(a);if(b==null&&a.constructor==mxCell){b=a.getId();if(b==null){b=mxCellPath.create(a);if(b.length==0){b="root"}}}}return b};mxCodec.prototype.reference=function(a){return null};mxCodec.prototype.encode=function(d){var b=null;if(d!=null&&d.constructor!=null){var a=mxCodecRegistry.getCodec(d.constructor);if(a!=null){b=a.encode(this,d)}else{if(isNode(d)){b=(mxClient.IS_IE)?d.value.cloneNode(true):this.document.importNode(d.value,true)}else{mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(d.constructor))}}}return b};mxCodec.prototype.decode=function(node,into){var obj=null;if(node!=null&&node.nodeType==mxConstants.NODETYPE_ELEMENT){var ctor=null;try{var ctor=eval(node.nodeName)}catch(err){}try{var dec=mxCodecRegistry.getCodec(ctor);if(dec!=null){obj=dec.decode(this,node,into)}else{obj=node.cloneNode(true);obj.removeAttribute("as")}}catch(err){mxLog.debug("Cannot decode "+node.nodeName+": "+err.message);throw err}}return obj};mxCodec.prototype.encodeCell=function(a,f,e){f.appendChild(this.encode(a));if(e==null||e){var b=a.getChildCount();for(var d=0;d<b;d++){this.encodeCell(a.getChildAt(d),f)}}};mxCodec.prototype.decodeCell=function(e,b){var a=null;if(e!=null&&e.nodeType==mxConstants.NODETYPE_ELEMENT){var h=mxCodecRegistry.getCodec(mxCell);a=h.decode(this,e);if(b==null||b){var d=a.getParent();if(d!=null){d.insert(a)}var f=a.getTerminal(true);if(f!=null){f.insertEdge(a,true)}var g=a.getTerminal(false);if(g!=null){g.insertEdge(a,false)}}}return a};mxCodec.prototype.setAttribute=function(b,a,d){if(a!=null&&d!=null){b.setAttribute(a,d)}};function mxObjectCodec(f,a,e,b){this.template=f;this.exclude=a||new Array();this.idrefs=e||new Array();this.mapping=b||new Object();this.reverse=new Object();for(var d in this.mapping){this.reverse[this.mapping[d]]=d}}mxObjectCodec.prototype.template=null;mxObjectCodec.prototype.exclude=null;mxObjectCodec.prototype.idrefs=null;mxObjectCodec.prototype.mapping=null;mxObjectCodec.prototype.reverse=null;mxObjectCodec.prototype.getFieldName=function(b){if(b!=null){var a=this.reverse[b];if(a!=null){b=a}}return b};mxObjectCodec.prototype.getAttributeName=function(b){if(b!=null){var a=this.mapping[b];if(a!=null){b=a}}return b};mxObjectCodec.prototype.isExcluded=function(e,a,d,b){return a==mxObjectIdentity.FIELD_NAME||mxUtils.indexOf(this.exclude,a)>=0};mxObjectCodec.prototype.isReference=function(e,a,d,b){return mxUtils.indexOf(this.idrefs,a)>=0};mxObjectCodec.prototype.encode=function(a,e){var b=mxUtils.getFunctionName(e.constructor);var d=a.document.createElement(b);e=this.beforeEncode(a,e,d);this.encodeObject(a,e,d);return this.afterEncode(a,e,d)};mxObjectCodec.prototype.encodeObject=function(a,g,e){a.setAttribute(e,"id",a.getId(g));for(var d in g){var b=d;var f=g[b];if(f!=null&&!this.isExcluded(g,b,f,true)){if(mxUtils.isNumeric(b)){b=null}this.encodeValue(a,g,b,f,e)}}};mxObjectCodec.prototype.encodeValue=function(b,h,d,g,f){if(g!=null){if(this.isReference(h,d,g,true)){var e=b.getId(g);if(e==null){mxLog.warn("mxObjectCodec.encode: No ID for "+mxUtils.getFunctionName(h.constructor)+"."+d+"="+g);return}g=e}var a=this.template[d];if(d==null||b.encodeDefaults||a!=g){d=this.getAttributeName(d);this.writeAttribute(b,h,d,g,f)}}};mxObjectCodec.prototype.writeAttribute=function(b,f,a,e,d){if(typeof(e)!="object"){this.writePrimitiveAttribute(b,f,a,e,d)}else{this.writeComplexAttribute(b,f,a,e,d)}};mxObjectCodec.prototype.writePrimitiveAttribute=function(b,f,a,e,d){e=this.convertValueToXml(e);if(a==null){var g=b.document.createElement("add");if(typeof(e)=="function"){g.appendChild(b.document.createTextNode(e))}else{b.setAttribute(g,"value",e)}d.appendChild(g)}else{if(typeof(e)!="function"){b.setAttribute(d,a,e)}}};mxObjectCodec.prototype.writeComplexAttribute=function(b,f,a,e,d){var g=b.encode(e);if(g!=null){if(a!=null){g.setAttribute("as",a)}d.appendChild(g)}else{mxLog.warn("mxObjectCodec.encode: No node for "+mxUtils.getFunctionName(f.constructor)+"."+a+": "+e)}};mxObjectCodec.prototype.convertValueToXml=function(a){if(typeof(a.length)=="undefined"&&(a==true||a==false)){a=(a==true)?"1":"0"}return a};mxObjectCodec.prototype.convertValueFromXml=function(a){if(mxUtils.isNumeric(a)){a=parseFloat(a)}return a};mxObjectCodec.prototype.beforeEncode=function(a,d,b){return d};mxObjectCodec.prototype.afterEncode=function(a,d,b){return b};mxObjectCodec.prototype.decode=function(f,b,a){var e=b.getAttribute("id");var d=f.objects[e];if(d==null){d=a||new this.template.constructor();if(e!=null){f.putObject(e,d)}}b=this.beforeDecode(f,b,d);this.decodeNode(f,b,d);return this.afterDecode(f,b,d)};mxObjectCodec.prototype.decodeNode=function(d,a,b){if(a!=null){this.decodeAttributes(d,a,b);this.decodeChildren(d,a,b)}};mxObjectCodec.prototype.decodeAttributes=function(h,f,g){var e=mxUtils.getFunctionName(g.constructor);var a=e=="Array";var b=f.attributes;if(b!=null){for(var d=0;d<b.length;d++){this.decodeAttribute(h,b[d],g)}}};mxObjectCodec.prototype.decodeAttribute=function(h,a,g){var d=a.nodeName;if(d!="as"&&d!="id"){var f=this.convertValueFromXml(a.nodeValue);var b=this.getFieldName(d);if(this.isReference(g,b,f,false)){var e=h.getObject(f);if(e==null){mxLog.warn("mxObjectCodec.decode: No object for "+mxUtils.getFunctionName(g.constructor)+"."+d+"="+f);return}f=e}if(!this.isExcluded(g,d,f,false)){g[d]=f}}};mxObjectCodec.prototype.decodeChildren=function(h,e,f){var d=mxUtils.getFunctionName(f.constructor);var a=d=="Array";var g=e.firstChild;while(g!=null){var b=g.nextSibling;if(g.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(h,g,f)){this.decodeChild(h,g,f)}g=b}};mxObjectCodec.prototype.decodeChild=function(dec,child,obj){var fieldname=this.getFieldName(child.getAttribute("as"));if(fieldname==null||!this.isExcluded(obj,fieldname,child,false)){var value=null;var template=obj[fieldname];if(child.nodeName=="add"){value=child.getAttribute("value");if(value==null){value=mxUtils.eval(mxUtils.getTextContent(child))}}else{value=dec.decode(child,template)}if(value!=null&&value!=template){if(fieldname!=null&&fieldname.length>0){obj[fieldname]=value}else{obj.push(value)}}}};mxObjectCodec.prototype.processInclude=function(h,f,d){if(f.nodeName=="include"){var b=f.getAttribute("name");if(b!=null){try{var a=mxUtils.load(b).getDocumentElement();if(a!=null){h.decode(a,d)}}catch(g){}}return true}return false};mxObjectCodec.prototype.beforeDecode=function(d,a,b){return a};mxObjectCodec.prototype.afterDecode=function(d,a,b){return b};mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxCell(),["children","edges","states","overlays","mxTransient"],["parent","source","target"]);a.isExcluded=function(f,b,e,d){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||(d&&b=="value"&&e.nodeType==mxConstants.NODETYPE_ELEMENT)};a.afterEncode=function(b,f,e){if(f.value!=null&&f.value.nodeType==mxConstants.NODETYPE_ELEMENT){var d=e;e=(mxClient.IS_IE)?f.value.cloneNode(true):b.document.importNode(f.value,true);e.appendChild(d);var g=d.getAttribute("id");e.setAttribute("id",g);d.removeAttribute("id")}return e};a.beforeDecode=function(g,f,k){var o=f;if(f.nodeName!="mxCell"){var l=f.getElementsByTagName("mxCell")[0];if(l!=null&&l.parentNode==f){mxUtils.removeWhitespace(l,true);mxUtils.removeWhitespace(l,false);l.parentNode.removeChild(l);o=l}else{o=null}k.value=f.cloneNode(true);var b=k.value.getAttribute("id");if(b!=null){k.setId(b);k.value.removeAttribute("id")}}else{k.setId(f.getAttribute("id"))}if(o!=null){for(var m=0;m<this.idrefs.length;m++){var n=this.idrefs[m];var d=o.getAttribute(n);if(d!=null){o.removeAttribute(n);var h=g.objects[d]||g.lookup(d);if(h==null){var j=g.getElementById(d);if(j!=null){var e=mxCodecRegistry.codecs[j.nodeName]||this;h=e.decode(g,j)}}k[n]=h}}}return o};return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxGraphModel());a.encode=function(d,g){var e=mxUtils.getFunctionName(g.constructor);var f=d.document.createElement(e);var b=d.document.createElement("root");d.encodeCell(g.getRoot(),b);f.appendChild(b);return f};a.decodeChild=function(e,d,b){if(d.nodeName=="root"){this.decodeRoot(e,d,b)}else{mxObjectCodec.prototype.decodeChild.apply(this,arguments)}};a.decodeRoot=function(h,d,e){var g=null;var f=d.firstChild;while(f!=null){var b=h.decodeCell(f);if(b!=null&&b.getParent()==null){g=b}f=f.nextSibling}if(g!=null){e.setRoot(g)}};return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxRootChange(),["model","previous","root"]);a.afterEncode=function(b,e,d){b.encodeCell(e.root,d);return d};a.beforeDecode=function(g,e,f){if(e.firstChild!=null&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var b=e.firstChild;f.root=g.decodeCell(b,false);var d=b.nextSibling;b.parentNode.removeChild(b);b=d;while(b!=null){var d=b.nextSibling;g.decodeCell(b);b.parentNode.removeChild(b);b=d}}return e};a.afterDecode=function(e,b,d){d.previous=d.root;return d};return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxChildChange(),["model","previous","previousIndex","child"],["parent"]);a.isReference=function(f,b,e,d){if(b=="child"&&(f.previous!=null||!d)){return true}return mxUtils.indexOf(this.idrefs,b)>=0};a.afterEncode=function(b,e,d){if(this.isReference(e,"child",e.child,true)){d.setAttribute("child",b.getId(e.child))}else{b.encodeCell(e.child,d)}return d};a.beforeDecode=function(j,e,g){if(e.firstChild!=null&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var b=e.firstChild;g.child=j.decodeCell(b,false);g.child.setParent(null);var d=b.nextSibling;b.parentNode.removeChild(b);b=d;while(b!=null){var d=b.nextSibling;if(b.nodeType==mxConstants.NODETYPE_ELEMENT){var h=b.getAttribute("id");if(j.lookup(h)==null){j.decodeCell(b)}}b.parentNode.removeChild(b);b=d}}else{var f=e.getAttribute("child");g.child=j.getObject(f)}return e};a.afterDecode=function(e,b,d){d.previous=d.parent;d.previousIndex=d.index;return d};return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxTerminalChange(),["model","previous"],["cell","terminal"]);a.afterDecode=function(e,b,d){d.previous=d.terminal;return d};return a}());var mxGenericChangeCodec=function(d,a){var b=new mxObjectCodec(d,["model","previous"],["cell"]);b.afterDecode=function(g,e,f){if(f.previous==null){f.previous=f[a]}return f};return b};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange(),"value"));mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange(),"style"));mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange(),"geometry"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange(),"collapsed"));mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange(),"visible"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange(),"value"));mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph(),["graphListeners","eventListeners","view","container","cellRenderer","editor","selection","gestureHandler","selection","activeElement","focusHandler","blurHandler"])}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxGraphView());a.encode=function(d,b){return this.encodeCell(d,b,b.graph.getModel().getRoot())};a.encodeCell=function(h,o,r){var n=o.graph.getModel();var e=o.getState(r);var j=n.getChildCount(r);var q=n.getParent(r);var l=o.graph.getCellGeometry(r);var d="layer";if(q==null){d="graph"}else{if(n.isEdge(r)){d="edge"}else{if(j>0&&l!=null){d="group"}else{if(n.isVertex(r)){d="vertex"}}}}var f=h.document.createElement(d);var m=o.graph.getLabel(r);if(m!=null){f.setAttribute("label",o.graph.getLabel(r))}if(q==null){var b=o.bounds;if(b!=null){f.setAttribute("x",Math.round(b.x));f.setAttribute("y",Math.round(b.y));f.setAttribute("width",Math.round(b.width));f.setAttribute("height",Math.round(b.height))}f.setAttribute("scale",o.scale)}else{if(e!=null&&l!=null){for(var k in e.style){var p=e.style[k];if(p!=null&&typeof(p)!="function"&&typeof(p)!="object"){f.setAttribute(k,p)}}var t=e.absolutePoints;if(t!=null&&t.length>0){var s=Math.round(t[0].x)+","+Math.round(t[0].y);for(var k=1;k<t.length;k++){s+=" "+Math.round(t[k].x)+","+Math.round(t[k].y)}f.setAttribute("points",s)}else{f.setAttribute("x",Math.round(e.x));f.setAttribute("y",Math.round(e.y));f.setAttribute("width",Math.round(e.width));f.setAttribute("height",Math.round(e.height))}var g=e.absoluteOffset;if(g!=null){if(g.x!=0){f.setAttribute("offsetX",Math.round(g.x))}if(g.y!=0){f.setAttribute("offsetY",Math.round(g.y))}}}}for(var k=0;k<j;k++){f.appendChild(this.encodeCell(h,o,n.getChildAt(r,k)))}return f};return a}());mxCodecRegistry.register(function(){var codec=new mxObjectCodec(new mxStylesheet());codec.encode=function(enc,obj){var node=enc.document.createElement(mxUtils.getFunctionName(obj.constructor));for(var i in obj.styles){var style=obj.styles[i];var styleNode=enc.document.createElement("add");if(i!=null){styleNode.setAttribute("as",i);for(var j in style){var entry=enc.document.createElement("add");entry.setAttribute("as",j);var type=typeof(style[j]);if(type=="function"){var name=null;for(var k in mxPerimeter){if(mxPerimeter[k]==style[j]){name="mxPerimeter."+k}}if(name==null){for(var k in mxEdgeStyle){if(mxEdgeStyle[k]==style[j]){name="mxEdgeStyle."+k}}}if(name!=null){var tmp=enc.document.createTextNode(name);entry.appendChild(tmp)}}else{if(type!="object"){entry.setAttribute("value",style[j])}}styleNode.appendChild(entry)}if(styleNode.childNodes.length>0){node.appendChild(styleNode)}}}return node};codec.decode=function(dec,node,into){var obj=into||new this.template.constructor();var id=node.getAttribute("id");if(id!=null){dec.objects[id]=obj}node=node.firstChild;while(node!=null){if(!this.processInclude(dec,node,obj)&&node.nodeName=="add"){var as=node.getAttribute("as");if(as!=null){var extend=node.getAttribute("extend");var style=(extend!=null)?mxUtils.clone(obj.styles[extend]):null;if(style==null){if(extend!=null){mxLog.warn("mxStylesheetCodec.decode: stylesheet "+extend+" not found to extend")}style=new Object()}var entry=node.firstChild;while(entry!=null){if(entry.nodeType==mxConstants.NODETYPE_ELEMENT){var key=entry.getAttribute("as");if(entry.nodeName=="add"){var value=entry.getAttribute("value");if(mxUtils.isNumeric(value)){style[key]=parseFloat(value)}else{style[key]=value}var text=mxUtils.getTextContent(entry);if(text!=null&&text.length>0){try{style[key]=eval(text)}catch(e){}}}else{if(entry.nodeName=="remove"){delete style[key]}}}entry=entry.nextSibling}obj.putCellStyle(as,style)}}node=node.nextSibling}return obj};return codec}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxDefaultKeyHandler());a.encode=function(b,d){return null};a.decode=function(j,f,d){if(d!=null){var e=d.editor;f=f.firstChild;while(f!=null){if(!this.processInclude(j,f,d)&&f.nodeName=="add"){var b=f.getAttribute("as");var g=f.getAttribute("action");var h=f.getAttribute("control");d.bindAction(b,g,h)}f=f.nextSibling}}return d};return a}());mxCodecRegistry.register(function(){var codec=new mxObjectCodec(new mxDefaultToolbar());codec.encode=function(enc,obj){return null};codec.decode=function(dec,node,into){if(into!=null){var editor=into.editor;var model=editor.graph.getModel();node=node.firstChild;while(node!=null){if(node.nodeType==mxConstants.NODETYPE_ELEMENT){if(!this.processInclude(dec,node,into)){if(node.nodeName=="separator"){into.addSeparator()}else{if(node.nodeName=="br"){into.toolbar.addBreak()}else{if(node.nodeName=="hr"){into.toolbar.addLine()}else{if(node.nodeName=="add"){var as=node.getAttribute("as");as=mxResources.get(as)||as;var icon=node.getAttribute("icon");var pressedIcon=node.getAttribute("pressedIcon");var action=node.getAttribute("action");var mode=node.getAttribute("mode");var template=node.getAttribute("template");if(action!=null){into.addItem(as,icon,action,pressedIcon)}else{if(mode!=null){var funct=mxUtils.eval(mxUtils.getTextContent(node));into.addMode(as,icon,mode,pressedIcon,funct)}else{if(template!=null){var cell=editor.templates[template];var style=node.getAttribute("style");if(style!=null){cell=cell.clone();cell.setStyle(style)}var insertFunction=null;var text=mxUtils.getTextContent(node);if(text!=null){insertFunction=mxUtils.eval(text)}into.addPrototype(as,icon,cell,pressedIcon,insertFunction)}else{var children=mxUtils.getChildNodes(node);if(children.length>0){if(icon==null){var combo=into.addActionCombo(as);for(var i=0;i<children.length;i++){var child=children[i];if(child.nodeName=="separator"){into.addOption(combo,"---")}else{if(child.nodeName=="add"){var lab=child.getAttribute("as");var act=child.getAttribute("action");into.addActionOption(combo,lab,act)}}}}else{var select=null;var create=function(){var template=editor.templates[select.value];if(template!=null){var clone=template.clone();var style=select.options[select.selectedIndex].cellStyle;if(style!=null){clone.setStyle(style)}return clone}else{mxLog.warn("Template "+template+" not found")}return null};var img=into.addPrototype(as,icon,create);select=into.addCombo();mxEvent.addListener(select,"change",function(){into.toolbar.selectMode(img,function(evt){var pt=mxUtils.convertPoint(editor.graph.container,evt.clientX,evt.clientY);return editor.addVertex(null,funct(),pt.x,pt.y)});into.toolbar.noReset=false});for(var i=0;i<children.length;i++){var child=children[i];if(child.nodeName=="separator"){into.addOption(select,"---")}else{if(child.nodeName=="add"){var lab=child.getAttribute("as");var tmp=child.getAttribute("template");var option=into.addOption(select,lab,tmp||template);option.cellStyle=child.getAttribute("style")}}}}}}}}}}}}}}node=node.nextSibling}}return into};return codec}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxDefaultPopupMenu());a.encode=function(b,d){return null};a.decode=function(f,d,b){var e=d.getElementsByTagName("include")[0];if(e!=null){this.processInclude(f,e,b)}else{if(b!=null){b.config=d}}return b};return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxEditor(),["modified","lastSnapshot","ignoredChanges","undoManager","graphContainer","toolbarContainer"]);a.afterDecode=function(g,e,f){var b=e.getAttribute("defaultEdge");if(b!=null){e.removeAttribute("defaultEdge");f.defaultEdge=f.templates[b]}var d=e.getAttribute("defaultGroup");if(d!=null){e.removeAttribute("defaultGroup");f.defaultGroup=f.templates[d]}return f};a.decodeChild=function(f,e,b){if(e.nodeName=="Array"){var d=e.getAttribute("as");if(d=="templates"){this.decodeTemplates(f,e,b);return}}else{if(e.nodeName=="ui"){this.decodeUi(f,e,b);return}}mxObjectCodec.prototype.decodeChild.apply(this,arguments)};a.decodeUi=function(h,f,m){var k=f.firstChild;while(k!=null){if(k.nodeName=="add"){var g=k.getAttribute("as");var j=k.getAttribute("element");var b=k.getAttribute("style");var l=null;if(j!=null){l=document.getElementById(j);if(l!=null&&b!=null){l.style.cssText+=";"+b}}else{var o=parseInt(k.getAttribute("x"));var n=parseInt(k.getAttribute("y"));var d=k.getAttribute("width");var p=k.getAttribute("height");l=document.createElement("div");l.style.cssText=b;var e=new mxWindow(mxResources.get(g)||g,l,o,n,d,p,false,true);e.setVisible(true)}if(g=="graph"){m.setGraphContainer(l)}else{if(g=="toolbar"){m.setToolbarContainer(l)}else{if(g=="title"){m.setTitleContainer(l)}else{if(g=="status"){m.setStatusContainer(l)}else{if(g=="map"){m.setMapContainer(l)}}}}}}else{if(k.nodeName=="resource"){mxResources.add(k.getAttribute("basename"))}else{if(k.nodeName=="stylesheet"){mxClient.link("stylesheet",k.getAttribute("name"))}}}k=k.nextSibling}};a.decodeTemplates=function(k,g,f){if(f.templates==null){f.templates=new Array()}var e=mxUtils.getChildNodes(g);for(var d=0;d<e.length;d++){var b=e[d].getAttribute("as");var h=e[d].firstChild;while(h!=null&&h.nodeType!=1){h=h.nextSibling}if(h!=null){f.templates[b]=k.decodeCell(h)}}};return a}());if(mxClient.IS_NS){mxClient.include("chrome://global/content/contentAreaUtils.js")}if(mxClient.loading==null){mxClient.onload()};